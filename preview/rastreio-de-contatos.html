<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>1 Rastreio de contatos | Manual de R para Epidemiologistas</title>
<meta name="author" content="the handbook team">
<meta name="description" content="Esta página demonstra uma análise descritiva dos dados de rastreio de contatos, acrescentando algumas considerações-chave e abordagens únicas a este tipo de dados. Esta página faz referência a...">
<meta name="generator" content="bookdown 0.26 with bs4_book()">
<meta property="og:title" content="1 Rastreio de contatos | Manual de R para Epidemiologistas">
<meta property="og:type" content="book">
<meta property="og:description" content="Esta página demonstra uma análise descritiva dos dados de rastreio de contatos, acrescentando algumas considerações-chave e abordagens únicas a este tipo de dados. Esta página faz referência a...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="1 Rastreio de contatos | Manual de R para Epidemiologistas">
<meta name="twitter:description" content="Esta página demonstra uma análise descritiva dos dados de rastreio de contatos, acrescentando algumas considerações-chave e abordagens únicas a este tipo de dados. Esta página faz referência a...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.17/datatables.js"></script><link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script><link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style_bs4.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Manual de R para Epidemiologistas</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"></a></li>
<li class="book-part">Preview pages</li>
<li><a class="active" href="rastreio-de-contatos.html"><span class="header-section-number">1</span> Rastreio de contatos</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="rastreio-de-contatos" class="section level1" number="1">
<h1>
<span class="header-section-number">1</span> Rastreio de contatos<a class="anchor" aria-label="anchor" href="#rastreio-de-contatos"><i class="fas fa-link"></i></a>
</h1>
<p>Esta página demonstra uma análise descritiva dos dados de rastreio de contatos, acrescentando algumas considerações-chave e abordagens únicas a este tipo de dados.</p>
<p>Esta página faz referência a muitas das competências centrais de gestão e visualização de dados em R, cobertas em outras páginas (por exemplo, limpeza de dados, pivoteamento, tabelas, análises de séries temporais). Contudo, destacaremos exemplos específicos de rastreio de contatos que têm sido úteis para a tomada de decisões operacionais. Por exemplo, está inclusa a visualização de dados de seguimento de rastreio de contatos ao longo do tempo ou através de áreas geográficas, ou a produção de tabelas de Indicadores de Desempenho Chave (KPI, do inglês <em>Key Performance Indicator</em>) limpas para supervisores de rastreio de contatos.</p>
<p>Para fins de demonstração, utilizaremos amostras de dados de rastreio de contatos da plataforma <a href="https://www.who.int/tools/godata">Go.Data</a>. Os princípios aqui abordados serão aplicados aos dados de rastreio de contatos de outras plataformas - você poderá apenas precisar passar por diferentes etapas de pré-processamento de dados, dependendo da estrutura da base.</p>
<p>Leia mais sobre o projeto Go.Data no site <a href="https://worldhealthorganization.github.io/godata/">Github Documentation site</a> ou <a href="https://community-godata.who.int/">Community of Practice</a>.</p>
<div id="preparação" class="section level2" number="1.1">
<h2>
<span class="header-section-number">1.1</span> Preparação<a class="anchor" aria-label="anchor" href="#prepara%C3%A7%C3%A3o"><i class="fas fa-link"></i></a>
</h2>
<div id="carregar-pacotes" class="section level3 unnumbered">
<h3>Carregar pacotes<a class="anchor" aria-label="anchor" href="#carregar-pacotes"><i class="fas fa-link"></i></a>
</h3>
<p>Esta chunck mostra o carregamento dos pacotes necessários para as análises. Neste manual damos ênfase a função <code>p_load()</code> do <strong>pacman</strong>,
que instala o pacote se necessário <em>e</em> carrega-o para utilização. Também se pode carregar pacotes instalados com <code><a href="https://rdrr.io/r/base/library.html">library()</a></code> a partir do <strong>R base</strong>. Veja a página [R basics] para mais informações sobre pacotes R.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span>
  <span class="va">rio</span>,          <span class="co"># importar dados  </span>
  <span class="va">here</span>,         <span class="co"># caminhos relativos de arquivos </span>
  <span class="va">janitor</span>,      <span class="co"># limpeza dos dados e tabelas</span>
  <span class="va">lubridate</span>,    <span class="co"># trabalhar com datas</span>
  <span class="va">epikit</span>,       <span class="co"># função age_categories()</span>
  <span class="va">apyramid</span>,     <span class="co"># piramides etárias</span>
  <span class="va">tidyverse</span>,    <span class="co"># manipulação e visualização de dados</span>
  <span class="va">RColorBrewer</span>, <span class="co"># paletas de cores</span>
  <span class="va">formattable</span>,  <span class="co"># formatação de tabelas</span>
  <span class="va">kableExtra</span>    <span class="co"># formatação de tabelas</span>
<span class="op">)</span></code></pre></div>
</div>
<div id="importação-de-dados" class="section level3 unnumbered">
<h3>Importação de dados<a class="anchor" aria-label="anchor" href="#importa%C3%A7%C3%A3o-de-dados"><i class="fas fa-link"></i></a>
</h3>
<p>Importaremos amostras de conjuntos de dados de contatos e de seus “acompanhamentos”. Estes dados foram recuperados e separados da API Go.Data e armazenados como arquivos “.rds”.</p>
<p>Você pode fazer o download de todos os dados de exemplo para este manual a partir da página [Download do manual e dados].</p>
<p>Se desejar fazer o download do exemplo de dados de rastreio de contatos específicos para esta página, utilize os três links de download abaixo:</p>
<p><a href="https://github.com/WorldHealthOrganization/godata/blob/master/analytics/r-reporting/data/cases_clean.rds?raw=true" class="download-button">
Clique para fazer o download dos dados da investigação do caso (arquivo
.rds) </a></p>
<p><a href="https://github.com/WorldHealthOrganization/godata/blob/master/analytics/r-reporting/data/contacts_clean.rds?raw=true" class="download-button">
Clique para fazer o download dos dados de registo de contato (arquivo
.rds) </a></p>
<p><a href="https://github.com/WorldHealthOrganization/godata/blob/master/analytics/r-reporting/data/followups_clean.rds?raw=true" class="download-button">
Clique para fazer o download dos dados de acompanhamento dos contatos
(arquivo .rds) </a></p>
<!-- ```{r out.width = "100%", fig.align = "center", echo=F} -->
<!-- knitr::include_graphics(here::here("images", "godata_api_github.png")) -->
<!-- ``` -->
<p>Na sua forma original nos arquivos passíveis de download, os dados são exibidos como fornecidos pela API do Go.Data (saiba mais sobre <a href="#import_api">APIs aqui</a>). Para fins de exemplo, aqui vamos limpar os dados para facilitar a leitura nesta página. Se estiver usando uma extensão Go.Data, pode ver instruções completas sobre como recuperar os seus dados <a href="https://github.com/WorldHealthOrganization/godata/tree/master/analytics/r-reporting">aqui</a>.</p>
<p>Abaixo, os conjuntos de dados são importados utilizando a função <code>import()</code> do pacote <strong>rio</strong>. Veja a página [Importar e exportar] para várias formas de importação de dados. Utilizamos <code>here()</code> para especificar o caminho do arquivo - forneça o caminho específico do arquivo para o seu computador. Em seguida, utilizamos <code>select()</code> para selecionar apenas certas colunas dos dados, simplificando para efeitos de demonstração.</p>
<div id="dados-do-caso" class="section level4 unnumbered">
<h4>Dados do caso<a class="anchor" aria-label="anchor" href="#dados-do-caso"><i class="fas fa-link"></i></a>
</h4>
<p>Estes dados são uma tabela com informações sobre os casos.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cases</span> <span class="op">&lt;-</span> <span class="fu">import</span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"godata"</span>, <span class="st">"cases_clean.rds"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">select</span><span class="op">(</span><span class="va">case_id</span>, <span class="va">firstName</span>, <span class="va">lastName</span>, <span class="va">gender</span>, <span class="va">age</span>, <span class="va">age_class</span>,
         <span class="va">occupation</span>, <span class="va">classification</span>, <span class="va">was_contact</span>, <span class="va">hospitalization_typeid</span><span class="op">)</span></code></pre></div>
<p>Aqui estão os casos <code>nrow(cases)</code>:</p>
<div id="htmlwidget-6a0b0dbfecb75dde5e0f" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-6a0b0dbfecb75dde5e0f">{"x":{"filter":"none","data":[["CASE-2020-0029","CASE-2020-0026","CASE-2020-0017","CASE-2020-0043","CASE-2020-0044","CASE-2020-0036","CASE-2020-0037","CASE-2020-0006","CASE-2020-0045","CASE-2020-0046","CASE-2020-0034","CASE-2020-0031","CASE-2020-0028","CASE-2020-0010","CASE-2020-0018","CASE-2020-0038","CASE-2020-0007","CASE-2020-0023","CONTACT-2020-0024","CASE-2020-0002","CASE-2020-0002","CASE-2020-0020","CASE-2020-0027","CASE-2020-0015","CASE-2020-0035","CASE-2020-0019","CASE-2020-0019",null,"CASE-2020-0040","CASE-2020-0004","CASE-2020-0014","CASE-2020-0009","CASE-2020-0009","CONTACT-2020-0002","CASE-2020-0039","CASE-2020-0025","CASE-2020-0022","CASE-2020-0008",null,"CASE-2020-0011","CASE-2020-0012","CASE-2020-0016","CASE-2020-0013","CASE-2020-0033","CASE-2020-0030","CASE-2020-0032","CASE-2020-0003",null,"CASE-2020-0024","CASE-2020-0005","CASE-2020-0021",null,null,null,"CASE-2020-0001",null],["Abdoulaye","Adama","Adama","Adama","Adji","Aida","Aissatou","Alassane","Alfa","Alfa","Alioune","Alioune","Amadou","Amy","Assane","Awa","Bassirou","Bineta","Birima","Charles","Charles","Demba","Edouard","Fatima","Fatou","Fatoumata","Fatoumata","Giovanna ","Ibrahima","Jean-Paul","Joseph","Khady","Khady","Malang","Mamadou","Mamoudou","Mariama","Mhustapha","Modified Case","Moussa","Odette","Odette","Omar","Ousmane","Ousseynou","Pape","Samba","Samba","Seynabou","Souleymane","Boubacar","Sara","Larry","Elisabeth","Elisabeth","Charles"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"Diallo","Garcia","Hinkle","Hopkins","Hopkins","Williams"],["MALE","FEMALE","MALE","MALE","FEMALE","FEMALE","FEMALE","MALE","FEMALE","FEMALE","MALE","MALE","MALE","FEMALE","MALE","FEMALE","MALE","FEMALE","MALE",null,"MALE","MALE","MALE","FEMALE","FEMALE","FEMALE",null,null,"MALE","MALE","MALE","FEMALE",null,"FEMALE","MALE","MALE","FEMALE","MALE","MALE","MALE","FEMALE","FEMALE","MALE","MALE","MALE","MALE","MALE","FEMALE","FEMALE","MALE","MALE","FEMALE","MALE","FEMALE","FEMALE","MALE"],[46,61,8,null,25,40,80,47,34,34,20,20,45,37,25,57,75,43,3,43,52,43,38,38,35,45,61,null,23,43,54,57,52,54,0.916666666666667,63,51,7,null,31,80,80,52,5,52,31,58,45,56,23,46,55,34,43,49,43],["40-49","60-64","5-9","unknown","20-29","40-49","80+","40-49","30-39","30-39","20-29","20-29","40-49","30-39","20-29","50-59","75-79","40-49","0-4","40-49","50-59","40-49","30-39","30-39","30-39","40-49","60-64","unknown","20-29","40-49","50-59","50-59","50-59","50-59","0-4","60-64","50-59","5-9","unknown","30-39","80+","80+","50-59","5-9","50-59","30-39","50-59","40-49","50-59","20-29","40-49","50-59","30-39","40-49","40-49","40-49"],["WORKING_WITH_ANIMALS","FARMER","CHILD","HEALTH_CARE_WORKER",null,"WORKING_WITH_ANIMALS","FARMER","HEALTH_CARE_WORKER","BUTCHER","BUTCHER","STUDENT","STUDENT","HEALTH_CARE_WORKER","TEACHER","STUDENT","OTHER","OTHER","HEALTH_CARE_WORKER",null,"HEALTH_CARE_WORKER","FARMER","HEALTH_CARE_WORKER","OTHER","WORKING_WITH_ANIMALS","HEALTH_CARE_WORKER","TRADITIONAL_HEALER","FARMER",null,"STUDENT","HEALTH_CARE_WORKER","FARMER","OTHER","FARMER","FARMER","CHILD","FARMER","OTHER","CHILD",null,"OTHER","FARMER","FARMER","FARMER","CHILD","FARMER","OTHER","TRADITIONAL_HEALER","WORKING_WITH_ANIMALS","WORKING_WITH_ANIMALS","STUDENT","WORKING_WITH_ANIMALS","FARMER","HEALTH_CARE_WORKER","HEALTH_CARE_WORKER","FARMER","HEALTH_CARE_WORKER"],["CONFIRMED","PROBABLE","CONFIRMED","SUSPECT","CONFIRMED","CONFIRMED","PROBABLE","CONFIRMED","SUSPECT","SUSPECT","CONFIRMED","CONFIRMED","CONFIRMED","CONFIRMED","PROBABLE","CONFIRMED","CONFIRMED","CONFIRMED","SUSPECT","PROBABLE","CONFIRMED","PROBABLE","CONFIRMED","CONFIRMED","PROBABLE","CONFIRMED","PROBABLE","CONFIRMED","CONFIRMED","CONFIRMED","PROBABLE","CONFIRMED","SUSPECT","SUSPECT","SUSPECT","NOT_A_CASE_DISCARDED","SUSPECT","PROBABLE","CONFIRMED","PROBABLE","PROBABLE","PROBABLE","CONFIRMED","PROBABLE","SUSPECT","CONFIRMED","CONFIRMED","CONFIRMED","CONFIRMED","CONFIRMED","CONFIRMED","PROBABLE","CONFIRMED","CONFIRMED","CONFIRMED","PROBABLE"],[false,false,false,true,true,false,false,false,true,true,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false],["HOSPITALIZATION","HOSPITALIZATION","HOSPITALIZATION","HOSPITALIZATION","HOSPITALIZATION","HOSPITALIZATION","HOSPITALIZATION","HOSPITALIZATION","HOSPITALIZATION","HOSPITALIZATION","HOSPITALIZATION","HOSPITALIZATION","HOSPITALIZATION","HOSPITALIZATION","HOSPITALIZATION","HOSPITALIZATION","HOSPITALIZATION","HOSPITALIZATION",null,null,"HOSPITALIZATION","HOSPITALIZATION","HOSPITALIZATION","HOSPITALIZATION","HOSPITALIZATION","HOSPITALIZATION",null,null,"HOSPITALIZATION","HOSPITALIZATION","HOSPITALIZATION","HOSPITALIZATION",null,null,"HOSPITALIZATION","HOSPITALIZATION","HOSPITALIZATION","HOSPITALIZATION",null,"HOSPITALIZATION","HOSPITALIZATION","HOSPITALIZATION","HOSPITALIZATION","HOSPITALIZATION","HOSPITALIZATION","HOSPITALIZATION","HOSPITALIZATION",null,"HOSPITALIZATION","HOSPITALIZATION",null,null,null,null,"HOSPITALIZATION",null]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>case_id<\/th>\n      <th>firstName<\/th>\n      <th>lastName<\/th>\n      <th>gender<\/th>\n      <th>age<\/th>\n      <th>age_class<\/th>\n      <th>occupation<\/th>\n      <th>classification<\/th>\n      <th>was_contact<\/th>\n      <th>hospitalization_typeid<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":4}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="dados-de-contatos" class="section level4 unnumbered">
<h4>Dados de contatos<a class="anchor" aria-label="anchor" href="#dados-de-contatos"><i class="fas fa-link"></i></a>
</h4>
<p>Estes dados são uma tabela de todos os contatos e suas informações. Mais uma vez, forneça o seu próprio caminho para o arquivo. Após a importação, realizamos alguns passos preliminares de limpeza de dados, incluindo:</p>
<ul>
<li>Definir a age_class (faixa-etária) como fator e inverter a ordem desses níveis, de modo que as idades menores sejam as primeiras a aparecer;</li>
<li>Selecionar apenas algumas colunas específicas, ao mesmo tempo que se
renomeia uma delas;</li>
<li>Atribuir artificialmente às linhas cuja coluna <code>admin_2_name</code> estiver o nome “Djembe”, melhorando a clareza da visualização de alguns exemplos;</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">contacts</span> <span class="op">&lt;-</span> <span class="fu">import</span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"godata"</span>, <span class="st">"contacts_clean.rds"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>age_class <span class="op">=</span> <span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_rev.html">fct_rev</a></span><span class="op">(</span><span class="va">age_class</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">select</span><span class="op">(</span><span class="va">contact_id</span>, <span class="va">contact_status</span>, <span class="va">firstName</span>, <span class="va">lastName</span>, <span class="va">gender</span>, <span class="va">age</span>,
         <span class="va">age_class</span>, <span class="va">occupation</span>, <span class="va">date_of_reporting</span>, <span class="va">date_of_data_entry</span>,
         date_of_last_exposure <span class="op">=</span> <span class="va">date_of_last_contact</span>,
         <span class="va">date_of_followup_start</span>, <span class="va">date_of_followup_end</span>, <span class="va">risk_level</span>, <span class="va">was_case</span>, <span class="va">admin_2_name</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>admin_2_name <span class="op">=</span> <span class="fu">replace_na</span><span class="op">(</span><span class="va">admin_2_name</span>, <span class="st">"Djembe"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Aqui estão as linhas <code>nrow(contacts)</code> da base de dados <code>contacts</code>:</p>
<div id="htmlwidget-75deefde96003bacf1ad" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-75deefde96003bacf1ad">{"x":{"filter":"none","data":[["CONTACT-2020-0046","CONTACT-2020-0015","CONTACT-2020-0043","CONTACT-2020-0012","CONTACT-2020-0054","CONTACT-2020-0056","CONTACT-2020-0030","CONTACT-2020-0060","CONTACT-2020-0021","CONTACT-2020-0059","CONTACT-2020-0005","CONTACT-2020-0053","CONTACT-2020-0058","CONTACT-2020-0011","CONTACT-2020-0001","CONTACT-2020-0003","CONTACT-2020-0029","CONTACT-2020-0042","CONTACT-2020-0055","CONTACT-2020-0036","CONTACT-2020-0032","CONTACT-2020-0019","CONTACT-2020-0025","CONTACT-2020-0040","CONTACT-2020-0045","CONTACT-2020-0004","CONTACT-2020-0020","CONTACT-2020-0016","CONTACT-2020-0031","CONTACT-2020-0014","CONTACT-2020-0037","CONTACT-2020-0007","CONTACT-2020-0051","CONTACT-2020-0008","CONTACT-2020-0048","CONTACT-2020-0038","CONTACT-2020-0010","CONTACT-2020-0006","CONTACT-2020-0034","CONTACT-2020-0052","CONTACT-2020-0044","CONTACT-2020-0009","CONTACT-2020-0047","CONTACT-2020-0022","CONTACT-2020-0013","CONTACT-2020-0023","CONTACT-2020-0041","CONTACT-2020-0028","CONTACT-2020-0017","CONTACT-2020-0027","CONTACT-2020-0035","CONTACT-2020-0026","CONTACT-2020-0033","CONTACT-2020-0050","CONTACT-2020-0057","CONTACT-2020-0018","CONTACT-2020-0049","CONTACT-2020-0039",null,null,"CASE-2020-0043","CASE-2020-0044","CASE-2020-0045","CASE-2020-0046","CONTACT-2020-0024","CONTACT-2020-0002"],["UNDER_FOLLOW_UP","LOST_TO_FOLLOW_UP","UNDER_FOLLOW_UP","LOST_TO_FOLLOW_UP","UNDER_FOLLOW_UP","FOLLOW_UP_COMPLETED","FOLLOW_UP_COMPLETED","LOST_TO_FOLLOW_UP","UNDER_FOLLOW_UP","UNDER_FOLLOW_UP","UNDER_FOLLOW_UP","UNDER_FOLLOW_UP","UNDER_FOLLOW_UP","UNDER_FOLLOW_UP","FOLLOW_UP_COMPLETED","FOLLOW_UP_COMPLETED","DIED","FOLLOW_UP_COMPLETED","DIED","UNDER_FOLLOW_UP","FOLLOW_UP_COMPLETED","UNDER_FOLLOW_UP","UNDER_FOLLOW_UP","FOLLOW_UP_COMPLETED","FOLLOW_UP_COMPLETED","FOLLOW_UP_COMPLETED","FOLLOW_UP_COMPLETED","UNDER_FOLLOW_UP","FOLLOW_UP_COMPLETED","UNDER_FOLLOW_UP","FOLLOW_UP_COMPLETED","FOLLOW_UP_COMPLETED","FOLLOW_UP_COMPLETED","FOLLOW_UP_COMPLETED","FOLLOW_UP_COMPLETED","FOLLOW_UP_COMPLETED","UNDER_FOLLOW_UP","FOLLOW_UP_COMPLETED","FOLLOW_UP_COMPLETED","UNDER_FOLLOW_UP","LOST_TO_FOLLOW_UP","UNDER_FOLLOW_UP","UNDER_FOLLOW_UP","UNDER_FOLLOW_UP","UNDER_FOLLOW_UP","UNDER_FOLLOW_UP","UNDER_FOLLOW_UP","UNDER_FOLLOW_UP","FOLLOW_UP_COMPLETED","UNDER_FOLLOW_UP","UNDER_FOLLOW_UP","UNDER_FOLLOW_UP","UNDER_FOLLOW_UP","UNDER_FOLLOW_UP","LOST_TO_FOLLOW_UP","FOLLOW_UP_COMPLETED","UNDER_FOLLOW_UP","LOST_TO_FOLLOW_UP","UNDER_FOLLOW_UP","UNDER_FOLLOW_UP","BECAME_CASE","BECAME_CASE","BECAME_CASE","BECAME_CASE","BECAME_CASE","BECAME_CASE"],["Abou","Adama","Adja","Alfa","Alimatou","Amath","Aminata","Binette","Binta","Bintou","Birima","Birima","Bransan  ","Cheik","Cheik","Cheik","Coura","Dicory","Djeynaba","Djiby","El Hadj","Kalidou","Khadija","Khary","Khary","Khary","Khary","Lamine","Lat","Madia","Maguette","Maguette","Maguette","Malamine","Malamine","Malamine","Malang","Malang","Malang","Mayatta","Mbagnick","Modou","Ndiankou","Ndiaya","Ndiogou","Oulimata","Oumou","Papis","Racine","Sadibou","Sofiatou","Thione","Thiony","Waly","Wasis","Yacouba","Youssouf","Abba","Mayatta","Jelani","Adama","Adji","Alfa","Alfa","Birima","Malang"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"Abebe","Obi","Onai",null,null,null,null,null,null],["MALE","MALE","MALE","FEMALE","MALE","MALE","FEMALE","FEMALE","FEMALE","FEMALE","MALE","MALE","FEMALE","MALE","MALE","MALE","MALE","MALE","FEMALE","FEMALE","MALE","MALE","MALE","MALE","FEMALE","FEMALE","FEMALE","FEMALE","FEMALE","MALE","FEMALE","FEMALE","FEMALE","MALE","MALE","MALE","FEMALE","FEMALE","FEMALE","MALE","MALE","MALE","MALE","FEMALE","FEMALE","MALE","MALE","FEMALE","FEMALE","MALE","FEMALE","MALE","FEMALE","MALE","FEMALE","MALE","FEMALE","FEMALE","MALE","MALE","MALE","FEMALE","FEMALE","FEMALE","MALE","FEMALE"],[81,56,47,34,8,54,36,34,32,97,3,3,23,12,12,12,null,15,54,45,21,20,4,21,32,32,32,12,23,34,9,29,9,63,7,7,54,54,54,null,null,18,67,32,56,23,34,null,35,15,null,45,5,56,2,78,null,17,null,24,null,25,34,34,3,54],["80+","50-59","40-49","30-39","5-9","50-59","30-39","30-39","30-39","80+","0-4","0-4","20-29","10-14","10-14","10-14","unknown","15-19","50-59","40-49","20-29","20-29","0-4","20-29","30-39","30-39","30-39","10-14","20-29","30-39","5-9","20-29","5-9","60-64","5-9","5-9","50-59","50-59","50-59","unknown","unknown","15-19","65-69","30-39","50-59","20-29","30-39","unknown","30-39","15-19","unknown","40-49","5-9","50-59","0-4","75-79","unknown","15-19","unknown","20-29","unknown","20-29","30-39","30-39","0-4","50-59"],[null,null,null,null,null,null,null,null,null,null,"CHILD",null,null,null,"CHILD","CHILD",null,null,null,null,null,null,null,null,null,"FARMER",null,null,null,null,null,"OTHER",null,"FARMER",null,null,null,"FARMER",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"HEALTH_CARE_WORKER","STUDENT","HEALTH_CARE_WORKER",null,"BUTCHER","BUTCHER",null,"FARMER"],["2020-04-15","2020-04-16","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-05-25","2020-04-15","2020-05-01","2020-05-25","2020-04-15","2020-05-25","2020-03-22","2020-03-22","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-03-22","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-05-25","2020-03-22","2020-04-15","2020-04-15","2020-04-15","2020-05-25","2020-04-15","2020-05-25","2020-04-15","2020-05-25","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-09-02","2020-09-03","2020-07-08","2020-07-11","2020-07-16","2020-07-07","2020-04-15","2020-03-22"],["2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-09-03","2020-09-04","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08"],["2020-06-22","2020-08-13","2020-06-22","2020-06-15","2020-06-17","2020-09-02","2020-05-15","2020-06-16","2020-05-13","2020-06-20","2020-04-28","2020-04-26","2020-06-22","2020-04-26","2020-06-07","2020-06-07","2020-06-17","2020-06-16","2020-06-20","2020-06-19","2020-05-10","2020-06-24","2020-05-08","2020-06-15","2020-06-05","2020-06-07","2020-06-05","2020-06-22","2020-05-10","2020-06-15","2020-06-05","2020-06-07","2020-06-05","2020-04-28","2020-06-06","2020-06-05","2020-04-29","2020-06-07","2020-06-05","2020-06-17","2020-06-17","2020-05-15","2020-06-20","2020-05-10","2020-06-22","2020-05-13","2020-06-22","2020-06-17","2020-06-15","2020-06-24","2020-06-17","2020-06-22","2020-06-22","2020-06-17","2020-06-17","2020-06-15","2020-06-17","2020-06-24","2020-09-02","2020-09-01","2020-05-06","2020-05-10","2020-07-27","2020-05-06","2020-04-26","2020-04-28"],["2020-08-15","2020-08-14","2020-08-14","2020-06-16","2020-06-18","2020-09-03",null,"2020-06-17","2020-05-14","2020-06-21","2020-04-29","2020-04-27","2020-06-23","2020-04-27","2020-06-08","2020-06-08","2020-06-18","2020-06-17","2020-06-21","2020-06-20",null,"2020-06-25",null,"2020-06-16","2020-06-06","2020-06-08","2020-06-06","2020-06-23",null,"2020-06-16","2020-06-06","2020-06-08","2020-06-06",null,"2020-06-08","2020-06-06","2020-04-30","2020-06-08","2020-06-06","2020-06-18","2020-06-18","2020-05-16","2020-06-21","2020-05-11","2020-06-23","2020-05-14","2020-06-23","2020-06-18","2020-06-16","2020-06-25","2020-06-18","2020-06-23","2020-06-23","2020-06-18","2020-06-18","2020-06-16","2020-06-18","2020-06-25","2020-09-03","2020-09-02",null,null,null,null,"2020-06-06",null],["2020-08-28","2020-08-27","2020-08-27","2020-06-29","2020-07-01","2020-09-16",null,"2020-06-30","2020-05-27","2020-07-04","2020-05-12","2020-05-10","2020-07-06","2020-05-10","2020-06-21","2020-06-21","2020-07-01","2020-06-30","2020-07-04","2020-07-03",null,"2020-07-08",null,"2020-06-29","2020-06-19","2020-06-21","2020-06-19","2020-07-06",null,"2020-06-29","2020-06-19","2020-06-21","2020-06-19",null,"2020-06-21","2020-06-19","2020-05-13","2020-06-21","2020-06-19","2020-07-01","2020-07-01","2020-05-29","2020-07-04","2020-05-24","2020-07-06","2020-05-27","2020-07-06","2020-07-01","2020-06-29","2020-07-08","2020-07-01","2020-07-06","2020-07-06","2020-07-01","2020-07-01","2020-06-29","2020-07-01","2020-07-08","2020-09-16","2020-09-15",null,null,null,null,"2020-06-19",null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"1_LOW","3_HIGH","1_LOW",null,null,null,null],[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,null,null,null,null,null,null],["Djembe","Trumpet","Djembe","Djembe","Trumpet","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Trumpet","Djembe","Djembe","Congas","Venu","Cornet","Venu","Djembe","Djembe"]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>contact_id<\/th>\n      <th>contact_status<\/th>\n      <th>firstName<\/th>\n      <th>lastName<\/th>\n      <th>gender<\/th>\n      <th>age<\/th>\n      <th>age_class<\/th>\n      <th>occupation<\/th>\n      <th>date_of_reporting<\/th>\n      <th>date_of_data_entry<\/th>\n      <th>date_of_last_exposure<\/th>\n      <th>date_of_followup_start<\/th>\n      <th>date_of_followup_end<\/th>\n      <th>risk_level<\/th>\n      <th>was_case<\/th>\n      <th>admin_2_name<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":5}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="dados-de-acompanhamento" class="section level4 unnumbered">
<h4>Dados de acompanhamento<a class="anchor" aria-label="anchor" href="#dados-de-acompanhamento"><i class="fas fa-link"></i></a>
</h4>
<p>Esses dados são registros das interações de “acompanhamento” (follow-up) com os contatos. Espera-se que cada contato tenha um encontro de onitoramento a cada dia durante 14 dias após sua exposição.</p>
<p>Importamos a base e executamos algumas etapas de limpeza. Selecionamos certas colunas e também convertemos uma coluna de caracteres em todos os valores em minúsculas.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">followups</span> <span class="op">&lt;-</span> <span class="fu">rio</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"godata"</span>, <span class="st">"followups_clean.rds"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">select</span><span class="op">(</span><span class="va">contact_id</span>, <span class="va">followup_status</span>, <span class="va">followup_number</span>,
         <span class="va">date_of_followup</span>, <span class="va">admin_2_name</span>, <span class="va">admin_1_name</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>followup_status <span class="op">=</span> <span class="fu">str_to_lower</span><span class="op">(</span><span class="va">followup_status</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Aqui estão as primeiras 50 linhas do conjunto de dados da fila de acompanhamento (<code>nrow(followups)</code>). Cada linha é uma interação de acompanhamento, com o status do resultado na coluna <code>followup_status</code>:</p>
<div id="htmlwidget-d74d78bb899d2aec7aff" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-d74d78bb899d2aec7aff">{"x":{"filter":"none","data":[["CONTACT-2020-0012","CONTACT-2020-0015","CONTACT-2020-0015","CONTACT-2020-0015","CONTACT-2020-0015","CONTACT-2020-0043","CONTACT-2020-0046","CONTACT-2020-0012","CONTACT-2020-0046","CONTACT-2020-0043","CONTACT-2020-0056","CONTACT-2020-0054","CONTACT-2020-0012","CONTACT-2020-0054","CONTACT-2020-0054","CONTACT-2020-0012","CONTACT-2020-0056","CONTACT-2020-0054","CONTACT-2020-0056","CONTACT-2020-0056","CONTACT-2020-0060","CONTACT-2020-0059","CONTACT-2020-0060","CONTACT-2020-0060","CONTACT-2020-0060","CONTACT-2020-0059","CONTACT-2020-0059","CONTACT-2020-0059","CONTACT-2020-0005","CONTACT-2020-0058","CONTACT-2020-0029","CONTACT-2020-0029","CONTACT-2020-0029","CONTACT-2020-0042","CONTACT-2020-0058","CONTACT-2020-0003","CONTACT-2020-0001","CONTACT-2020-0029","CONTACT-2020-0042","CONTACT-2020-0036","CONTACT-2020-0042","CONTACT-2020-0036","CONTACT-2020-0036","CONTACT-2020-0042","CONTACT-2020-0004","CONTACT-2020-0036","CONTACT-2020-0040","CONTACT-2020-0040","CONTACT-2020-0040","CONTACT-2020-0014"],["seen_ok","not_attempted","seen_ok","seen_ok","seen_ok","seen_ok","seen_ok","seen_ok","seen_ok","seen_ok","not_performed","seen_ok","seen_ok","seen_not_ok","seen_ok","seen_ok","seen_ok","seen_ok","not_performed","seen_ok","seen_ok","seen_ok","not_attempted","seen_ok","missed","seen_ok","missed","seen_ok","seen_ok","seen_ok","seen_ok","missed","seen_ok","seen_not_ok","missed","seen_ok","missed","seen_ok","seen_ok","seen_ok","missed","seen_ok","seen_ok","seen_ok","seen_ok","seen_ok","seen_ok","seen_ok","seen_not_ok","seen_ok"],[7,8,6,9,7,1,2,6,1,2,9,6,8,7,5,9,7,4,6,8,5,4,6,8,7,3,1,2,14,1,7,5,4,5,2,14,14,6,6,4,7,3,5,8,14,2,6,9,7,8],["2020-06-02","2020-06-03","2020-06-01","2020-06-04","2020-06-02","2020-06-03","2020-06-05","2020-06-01","2020-06-04","2020-06-04","2020-06-04","2020-06-03","2020-06-03","2020-06-04","2020-06-02","2020-06-04","2020-06-02","2020-06-01","2020-06-01","2020-06-03","2020-06-01","2020-06-04","2020-06-02","2020-06-04","2020-06-03","2020-06-03","2020-06-01","2020-06-02","2020-06-01","2020-06-03","2020-06-04","2020-06-02","2020-06-01","2020-06-01","2020-06-04","2020-06-01","2020-06-01","2020-06-03","2020-06-02","2020-06-03","2020-06-03","2020-06-02","2020-06-04","2020-06-04","2020-06-01","2020-06-01","2020-06-01","2020-06-04","2020-06-02","2020-06-03"],["Djembe","Trumpet","Trumpet","Trumpet","Trumpet","Djembe",null,"Djembe",null,"Djembe",null,"Trumpet","Djembe","Trumpet","Trumpet","Djembe",null,"Trumpet",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["Drums island","Brass island","Brass island","Brass island","Brass island","Drums island",null,"Drums island",null,"Drums island",null,"Brass island","Drums island","Brass island","Brass island","Drums island",null,"Brass island",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>contact_id<\/th>\n      <th>followup_status<\/th>\n      <th>followup_number<\/th>\n      <th>date_of_followup<\/th>\n      <th>admin_2_name<\/th>\n      <th>admin_1_name<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":2}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="dados-de-relação" class="section level4 unnumbered">
<h4>Dados de relação<a class="anchor" aria-label="anchor" href="#dados-de-rela%C3%A7%C3%A3o"><i class="fas fa-link"></i></a>
</h4>
<p>Aqui importamos os dados mostrando a relação entre os casos e contatos. Selecionamos certas colunas para demonstrar.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">relationships</span> <span class="op">&lt;-</span> <span class="fu">rio</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"godata"</span>, <span class="st">"relationships_clean.rds"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">select</span><span class="op">(</span><span class="va">source_visualid</span>, <span class="va">source_gender</span>, <span class="va">source_age</span>, <span class="va">date_of_last_contact</span>,
         <span class="va">date_of_data_entry</span>, <span class="va">target_visualid</span>, <span class="va">target_gender</span>,
         <span class="va">target_age</span>, <span class="va">exposure_type</span><span class="op">)</span></code></pre></div>
<p>Abaixo estão as primeiras 50 linhas da base de dados <code>relationships</code>, que contém todas as relações entre casos e contatos.</p>
<div id="htmlwidget-6d0be2ab7a31a4eca6c2" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-6d0be2ab7a31a4eca6c2">{"x":{"filter":"none","data":[["CASE-2020-0016",null,null,"CASE-2020-0045","CASE-2020-0004","CASE-2020-0010",null,"CASE-2020-0034",null,"CASE-2020-0037","CASE-2020-0005",null,"CASE-2020-0002","CASE-2020-0001","CASE-2020-0005",null,"CASE-2020-0004","CASE-2020-0012","CASE-2020-0022","CASE-2020-0004","CASE-2020-0003","CASE-2020-0001","CASE-2020-0030","CASE-2020-0022","CASE-2020-0010","CASE-2020-0018","CASE-2020-0045","CASE-2020-0030","CASE-2020-0001","CASE-2020-0018","CASE-2020-0008","CASE-2020-0014",null,"CASE-2020-0002","CASE-2020-0030","CASE-2020-0031","CASE-2020-0009","CASE-2020-0031","CASE-2020-0002",null,"CASE-2020-0001","CASE-2020-0001","CASE-2020-0022","CASE-2020-0001","CASE-2020-0012","CASE-2020-0023","CASE-2020-0016","CASE-2020-0001",null,"CASE-2020-0023"],["Female",null,null,"Female","Male","Female",null,"Male",null,"Female","Male",null,"Male","Female","Male",null,"Male","Female","Female","Male","Male","Female","Male","Female","Female","Male","Female","Male","Female","Male","Male","Male",null,"Male","Male","Male","Female","Male","Male",null,"Female","Female","Female","Female","Female","Female","Female","Female","Female","Female"],[80,null,null,34,43,37,null,20,null,80,23,0,52,49,23,null,43,80,51,43,58,49,52,51,37,25,34,52,49,25,7,54,null,52,52,20,57,20,52,null,49,49,51,49,80,43,80,49,43,43],["2020-06-24","2020-05-02","2020-06-15","2020-07-27","2020-06-05","2020-06-05","2020-08-19","2020-06-20","2020-08-19","2020-09-02","2020-08-07","2020-08-13","2020-05-15","2020-07-17","2020-06-15","2020-08-07","2020-06-15","2020-06-17","2020-06-05","2020-06-24","2020-06-07","2020-08-15","2020-06-17","2020-06-22","2020-06-19","2020-06-17","2020-07-27","2020-06-16","2020-04-28","2020-04-26","2020-06-15","2020-06-05","2020-05-02","2020-04-29","2020-06-22","2020-06-06","2020-05-13","2020-06-17","2020-05-01","2020-06-15","2020-06-07","2020-08-14","2020-06-20","2020-09-02","2020-06-24","2020-07-28","2020-06-17","2020-08-14","2020-08-14","2020-07-28"],["2020-06-08","2020-06-08","2020-06-08","2020-06-10","2020-06-08","2020-06-08","2020-08-20","2020-06-08","2020-08-20","2020-09-03","2020-08-21","2020-08-20","2020-06-08","2020-06-08","2020-06-08","2020-08-20","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-10","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-08-27","2020-06-08","2020-09-03","2020-06-08","2020-06-10","2020-06-08","2020-08-27","2020-08-27","2020-06-10"],["CONTACT-2020-0027","CASE-2020-0014","CASE-2020-0031","CASE-2020-0021","CONTACT-2020-0020","CONTACT-2020-0038","CASE-2020-0036","CONTACT-2020-0059","CASE-2020-0037",null,"CASE-2020-0015","CONTACT-2020-0015","CONTACT-2020-0009","CASE-2020-0008",null,"CASE-2020-0010","CONTACT-2020-0018","CONTACT-2020-0029","CONTACT-2020-0045","CONTACT-2020-0019","CONTACT-2020-0007","CASE-2020-0004","CONTACT-2020-0044","CONTACT-2020-0046","CONTACT-2020-0036","CONTACT-2020-0052","CASE-2020-0023","CONTACT-2020-0042","CONTACT-2020-0005","CONTACT-2020-0053","CONTACT-2020-0017","CONTACT-2020-0034","CASE-2020-0012","CASE-2020-0008","CONTACT-2020-0043","CONTACT-2020-0048","CONTACT-2020-0023","CONTACT-2020-0049","CASE-2020-0006","CASE-2020-0018","CONTACT-2020-0003","CASE-2020-0017","CONTACT-2020-0047","CONTACT-2020-0056","CONTACT-2020-0027","CASE-2020-0029","CONTACT-2020-0028","CONTACT-2020-0046","CONTACT-2020-0046","CASE-2020-0027"],["Male","Male","Male","Male","Female","Male","Female","Female","Female","Male","Female","Male","Male","Male",null,"Female","Male","Male","Female","Male","Female","Male","Male","Male","Female","Male","Female","Male","Male","Male","Female","Female","Female","Male","Male","Male","Male","Female","Male","Male","Male","Male","Male","Male","Male","Male","Female","Male","Male","Male"],[15,54,20,46,32,7,40,97,80,0,38,56,18,7,null,37,78,null,32,20,29,43,null,81,45,null,43,15,3,3,35,54,80,7,47,7,23,null,47,25,12,8,67,54,15,46,null,81,81,38],["Direct physical contact ",null,null,null,"Indirect contact (touched contaminated surface/materials/fomites etc.)","Direct non-physical contact (within 1 meter) ",null,"Direct physical contact ",null,"Direct physical contact ","Direct non-physical contact (within 1 meter) ","Direct non-physical contact (within 1 meter) ","Direct non-physical contact (within 1 meter) ","Direct physical contact ",null,"Direct non-physical contact (within 1 meter) ","Indirect contact (touched contaminated surface/materials/fomites etc.)","Indirect contact (touched contaminated surface/materials/fomites etc.)","Direct physical contact ","Direct non-physical contact (within 1 meter) ",null,"Direct physical contact ","Indirect contact (touched contaminated surface/materials/fomites etc.)","Direct physical contact ","Direct physical contact ","Direct non-physical contact (within 1 meter) ",null,"Direct physical contact ",null,"Direct physical contact ","Indirect contact (touched contaminated surface/materials/fomites etc.)","Direct non-physical contact (within 1 meter) ",null,"Direct physical contact ","Direct non-physical contact (within 1 meter) ","Direct non-physical contact (within 1 meter) ","Direct physical contact ","Direct physical contact ",null,null,null,null,"Indirect contact (touched contaminated surface/materials/fomites etc.)","Direct physical contact ","Direct physical contact ",null,"Direct physical contact ",null,null,null]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>source_visualid<\/th>\n      <th>source_gender<\/th>\n      <th>source_age<\/th>\n      <th>date_of_last_contact<\/th>\n      <th>date_of_data_entry<\/th>\n      <th>target_visualid<\/th>\n      <th>target_gender<\/th>\n      <th>target_age<\/th>\n      <th>exposure_type<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[2,7]}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="análises-descritivas" class="section level2" number="1.2">
<h2>
<span class="header-section-number">1.2</span> Análises descritivas<a class="anchor" aria-label="anchor" href="#an%C3%A1lises-descritivas"><i class="fas fa-link"></i></a>
</h2>
<p>Você pode utilizar as técnicas abordadas em outras páginas deste manual para realizar análises descritivas dos seus casos, contatos e respectivas relações. Abaixo estão alguns exemplos.</p>
<div id="demográficos" class="section level3 unnumbered">
<h3>Demográficos<a class="anchor" aria-label="anchor" href="#demogr%C3%A1ficos"><i class="fas fa-link"></i></a>
</h3>
<p>Como demonstrado neste manual [Pirâmides demográficas] [Demográficas pirâmides e escalas de Likert], é possível visualizar a idade e a distribuição por sexo (aqui utilizamos o pacote <strong>apyramid</strong>).</p>
<div id="idade-e-gênero-dos-contatos" class="section level4 unnumbered">
<h4>Idade e Gênero dos contatos<a class="anchor" aria-label="anchor" href="#idade-e-g%C3%AAnero-dos-contatos"><i class="fas fa-link"></i></a>
</h4>
<p>A pirâmide abaixo compara a distribuição etária dos contatos, por sexo. Note que contatos com idades faltosas (<em>missing</em>) estão inclusos em uma
barra no topo. Você pode alterar este comportamento padrão, mas depois considere listar os valores ausentes (“missing”) em uma legenda.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">apyramid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/apyramid/man/age_pyramid.html">age_pyramid</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">contacts</span>,                                   <span class="co"># usar base de dados de contatos</span>
  age_group <span class="op">=</span> <span class="st">"age_class"</span>,                           <span class="co"># coluna de faixa-etária</span>
  split_by <span class="op">=</span> <span class="st">"gender"</span><span class="op">)</span> <span class="op">+</span>                             <span class="co"># lados da pirâmide divididos por gênero</span>
  <span class="fu">labs</span><span class="op">(</span>
    fill <span class="op">=</span> <span class="st">"Gender"</span>,                                 <span class="co"># título da legenda</span>
    title <span class="op">=</span> <span class="st">"Age/Sex Pyramid of COVID-19 contacts"</span><span class="op">)</span><span class="op">+</span> <span class="co"># título da figura</span>
  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span>                                    <span class="co"># plano de fundo simples</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-14-1.png" width="672"></div>
<p>Com a estrutura de dados Go.Data, o conjunto de dados <code>relationships</code> contém as idades de ambos os casos e contatos, para que você pudesse
utilizar esse conjunto de dados e criar uma pirâmide de idades mostrando as diferenças entre esses dois grupos de pessoas. A base <code>relationships</code> será alterada para transformar as colunas numéricas de idade em categorias, ou seja, faixas-etárias (veja a página [Dados de limpeza e funções centrais]). Também pivotamos a base de dados de forma mais longa, para facilitar a criaçãodo gráfico com <strong>ggplot2</strong> (ver [Pivotando dados]).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">relation_age</span> <span class="op">&lt;-</span> <span class="va">relationships</span> <span class="op">%&gt;%</span> 
  <span class="fu">select</span><span class="op">(</span><span class="va">source_age</span>, <span class="va">target_age</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">transmute</span><span class="op">(</span>                              <span class="co"># transmute é como a função mutate(), mas remove todas as outras colunas não mencionadas</span>
    source_age_class <span class="op">=</span> <span class="fu">epikit</span><span class="fu">::</span><span class="fu"><a href="https://r4epi.github.io/epikit/reference/age_categories.html">age_categories</a></span><span class="op">(</span><span class="va">source_age</span>, breakers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">80</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span>,
    target_age_class <span class="op">=</span> <span class="fu">epikit</span><span class="fu">::</span><span class="fu"><a href="https://r4epi.github.io/epikit/reference/age_categories.html">age_categories</a></span><span class="op">(</span><span class="va">target_age</span>, breakers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">80</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span>,
    <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="fu">contains</span><span class="op">(</span><span class="st">"class"</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"category"</span>, values_to <span class="op">=</span> <span class="st">"age_class"</span><span class="op">)</span><span class="co"># pivotação longa</span>


<span class="va">relation_age</span></code></pre></div>
<pre><code>## # A tibble: 200 × 2
##    category         age_class
##    &lt;chr&gt;            &lt;fct&gt;    
##  1 source_age_class 80+      
##  2 target_age_class 15-19    
##  3 source_age_class &lt;NA&gt;     
##  4 target_age_class 50-54    
##  5 source_age_class &lt;NA&gt;     
##  6 target_age_class 20-24    
##  7 source_age_class 30-34    
##  8 target_age_class 45-49    
##  9 source_age_class 40-44    
## 10 target_age_class 30-34    
## # … with 190 more rows</code></pre>
<p>Agora podemos traçar este conjunto de dados transformados com a função <code>age_pyramid()</code> como antes, mas substituindo <code>gênder</code> por <code>category</code>
(Caso, ou Contato).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">apyramid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/apyramid/man/age_pyramid.html">age_pyramid</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">relation_age</span>,                               <span class="co"># usar a base de dados modificada `reltionship`</span>
  age_group <span class="op">=</span> <span class="st">"age_class"</span>,                           <span class="co"># coluna categórica de idade</span>
  split_by <span class="op">=</span> <span class="st">"category"</span><span class="op">)</span> <span class="op">+</span>                           <span class="co"># dividir por casos e contatos</span>
  <span class="fu">scale_fill_manual</span><span class="op">(</span>
    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"orange"</span>, <span class="st">"purple"</span><span class="op">)</span>,                  <span class="co"># para especificar cores E nomes</span>
    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Caso"</span>, <span class="st">"Contato"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>
    fill <span class="op">=</span> <span class="st">"Legend"</span>,                                           <span class="co"># título da legenda</span>
    title <span class="op">=</span> <span class="st">"Pirâmide Idade/Sexo de casos e contatos de COVID-19"</span><span class="op">)</span><span class="op">+</span> <span class="co"># título da figura</span>
  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span>                                              <span class="co"># plano de fundo simples</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-16-1.png" width="672"></div>
<p>Também podemos ver outras características, como a discriminação por ocupação (ex. em forma de gráfico de setores).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Limpar a base de dados e contar as ocupações</span>
<span class="va">occ_plot_data</span> <span class="op">&lt;-</span> <span class="va">cases</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>occupation <span class="op">=</span> <span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_explicit_na.html">fct_explicit_na</a></span><span class="op">(</span><span class="va">occupation</span><span class="op">)</span>,  <span class="co"># fazer valores NA e vazios uma categoria</span>
         occupation <span class="op">=</span> <span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_inorder.html">fct_infreq</a></span><span class="op">(</span><span class="va">occupation</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>   <span class="co"># ordenar em níveis, em ordem de frequência</span>
  <span class="fu">count</span><span class="op">(</span><span class="va">occupation</span><span class="op">)</span>                                          <span class="co"># contagens por ocupação</span>
  
<span class="co"># fazer gráfico de setores</span>
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">occ_plot_data</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="va">n</span>, fill <span class="op">=</span> <span class="va">occupation</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_bar</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">1</span>, stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_polar</span><span class="op">(</span><span class="st">"y"</span>, start <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>
    fill <span class="op">=</span> <span class="st">"Ocupação"</span>,
    title <span class="op">=</span> <span class="st">"Ocupações conhecidadas de casos de COVID-19"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>                    
  <span class="fu">theme</span><span class="op">(</span>axis.line <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,
        axis.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,
        axis.text <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-17-1.png" width="672"></div>
</div>
</div>
<div id="contatos-por-caso" class="section level3 unnumbered">
<h3>Contatos por caso<a class="anchor" aria-label="anchor" href="#contatos-por-caso"><i class="fas fa-link"></i></a>
</h3>
<p>O número de contatos por caso pode ser uma métrica importante para avaliar qualidade da contagem de contatos e a conformidade da população para uma resposta de saúde pública.</p>
<p>Dependendo de sua estrutura de dados, isto pode ser avaliado com um conjunto de dados que contém todos os casos e contatos. Nos conjuntos de
dados Go.Data, os links entre os casos (“fontes”) e os contatos (“alvos”) é armazenado no conjunto de dados <code>relationships</code>.</p>
<p>Neste conjunto de dados, cada linha é um contato, e o caso da fonte é listado em uma linha. Não há contatos que tenham relações com múltiplos
casos, mas se isso existir, você pode precisar computá-los antes de criar o gráfico.</p>
<p>Começamos contando o número de linhas (contatos) por caso de origem. Isto é salvo como um <em>data frame</em>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">contacts_per_case</span> <span class="op">&lt;-</span> <span class="va">relationships</span> <span class="op">%&gt;%</span> 
  <span class="fu">count</span><span class="op">(</span><span class="va">source_visualid</span><span class="op">)</span>

<span class="va">contacts_per_case</span></code></pre></div>
<pre><code>## # A tibble: 23 × 2
##    source_visualid     n
##    &lt;chr&gt;           &lt;int&gt;
##  1 CASE-2020-0001     13
##  2 CASE-2020-0002      5
##  3 CASE-2020-0003      2
##  4 CASE-2020-0004      4
##  5 CASE-2020-0005      5
##  6 CASE-2020-0006      3
##  7 CASE-2020-0008      3
##  8 CASE-2020-0009      3
##  9 CASE-2020-0010      3
## 10 CASE-2020-0012      3
## # … with 13 more rows</code></pre>
<p>Podemos usar <code>geom_histogram()</code> para fazer um histograma a partir desses dados.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">contacts_per_case</span><span class="op">)</span><span class="op">+</span>        <span class="co"># começar com a contagem da base de dados criada anteriormente</span>
  <span class="fu">geom_histogram</span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>  <span class="co"># criar o histograma do número de contatos por caso</span>
  <span class="fu">scale_y_continuous</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>   <span class="co"># remover o espaço em excesso abaixo de 0 no eixo y</span>
  <span class="fu">theme_light</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>                         <span class="co"># simplificar o plano de fundo</span>
  <span class="fu">labs</span><span class="op">(</span>
    title <span class="op">=</span> <span class="st">"Número de contatos por caso"</span>,
    y <span class="op">=</span> <span class="st">"Casus"</span>,
    x <span class="op">=</span> <span class="st">"Contatos por caso"</span>
  <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-19-1.png" width="672"></div>
</div>
</div>
<div id="acompanhamento-de-contato" class="section level2" number="1.3">
<h2>
<span class="header-section-number">1.3</span> Acompanhamento de contato<a class="anchor" aria-label="anchor" href="#acompanhamento-de-contato"><i class="fas fa-link"></i></a>
</h2>
<p>Os dados de rastreamento de contatos geralmente contêm dados de “acompanhamento”, que registram resultados das verificações diárias dos sintomas das pessoas em quarentena. Análises destes dados podem informar a estratégia de resposta, identificar contatos em risco de perda no acompanhamento ou risco de desenvolver doenças.</p>
<div id="limpeza-do-dados" class="section level3 unnumbered">
<h3>Limpeza do dados<a class="anchor" aria-label="anchor" href="#limpeza-do-dados"><i class="fas fa-link"></i></a>
</h3>
<p>Estes dados podem existir em uma variedade de formatos, como um formato Excel “largo/amplo”, com uma linha por contato e uma coluna por dia de acompanhamento. Veja [Pivotando dados] para descrições de dados “longos” e “largos”, e como pivotar dados mais amplos/largos ou mais longos.</p>
<p>Em nosso exemplo com Go.Data, estes dados são armazenados nos dados de acompanhamento (<code>followups</code>), em um formato “longo”, com uma linha por acompanhamento interação. As primeiras 50 filas são dessa forma:</p>
<div id="htmlwidget-8e388cffb366572963a8" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-8e388cffb366572963a8">{"x":{"filter":"none","data":[["CONTACT-2020-0012","CONTACT-2020-0015","CONTACT-2020-0015","CONTACT-2020-0015","CONTACT-2020-0015","CONTACT-2020-0043","CONTACT-2020-0046","CONTACT-2020-0012","CONTACT-2020-0046","CONTACT-2020-0043","CONTACT-2020-0056","CONTACT-2020-0054","CONTACT-2020-0012","CONTACT-2020-0054","CONTACT-2020-0054","CONTACT-2020-0012","CONTACT-2020-0056","CONTACT-2020-0054","CONTACT-2020-0056","CONTACT-2020-0056","CONTACT-2020-0060","CONTACT-2020-0059","CONTACT-2020-0060","CONTACT-2020-0060","CONTACT-2020-0060","CONTACT-2020-0059","CONTACT-2020-0059","CONTACT-2020-0059","CONTACT-2020-0005","CONTACT-2020-0058","CONTACT-2020-0029","CONTACT-2020-0029","CONTACT-2020-0029","CONTACT-2020-0042","CONTACT-2020-0058","CONTACT-2020-0003","CONTACT-2020-0001","CONTACT-2020-0029","CONTACT-2020-0042","CONTACT-2020-0036","CONTACT-2020-0042","CONTACT-2020-0036","CONTACT-2020-0036","CONTACT-2020-0042","CONTACT-2020-0004","CONTACT-2020-0036","CONTACT-2020-0040","CONTACT-2020-0040","CONTACT-2020-0040","CONTACT-2020-0014"],["seen_ok","not_attempted","seen_ok","seen_ok","seen_ok","seen_ok","seen_ok","seen_ok","seen_ok","seen_ok","not_performed","seen_ok","seen_ok","seen_not_ok","seen_ok","seen_ok","seen_ok","seen_ok","not_performed","seen_ok","seen_ok","seen_ok","not_attempted","seen_ok","missed","seen_ok","missed","seen_ok","seen_ok","seen_ok","seen_ok","missed","seen_ok","seen_not_ok","missed","seen_ok","missed","seen_ok","seen_ok","seen_ok","missed","seen_ok","seen_ok","seen_ok","seen_ok","seen_ok","seen_ok","seen_ok","seen_not_ok","seen_ok"],[7,8,6,9,7,1,2,6,1,2,9,6,8,7,5,9,7,4,6,8,5,4,6,8,7,3,1,2,14,1,7,5,4,5,2,14,14,6,6,4,7,3,5,8,14,2,6,9,7,8],["2020-06-02","2020-06-03","2020-06-01","2020-06-04","2020-06-02","2020-06-03","2020-06-05","2020-06-01","2020-06-04","2020-06-04","2020-06-04","2020-06-03","2020-06-03","2020-06-04","2020-06-02","2020-06-04","2020-06-02","2020-06-01","2020-06-01","2020-06-03","2020-06-01","2020-06-04","2020-06-02","2020-06-04","2020-06-03","2020-06-03","2020-06-01","2020-06-02","2020-06-01","2020-06-03","2020-06-04","2020-06-02","2020-06-01","2020-06-01","2020-06-04","2020-06-01","2020-06-01","2020-06-03","2020-06-02","2020-06-03","2020-06-03","2020-06-02","2020-06-04","2020-06-04","2020-06-01","2020-06-01","2020-06-01","2020-06-04","2020-06-02","2020-06-03"],["Djembe","Trumpet","Trumpet","Trumpet","Trumpet","Djembe",null,"Djembe",null,"Djembe",null,"Trumpet","Djembe","Trumpet","Trumpet","Djembe",null,"Trumpet",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["Drums island","Brass island","Brass island","Brass island","Brass island","Drums island",null,"Drums island",null,"Drums island",null,"Brass island","Drums island","Brass island","Brass island","Drums island",null,"Brass island",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>contact_id<\/th>\n      <th>followup_status<\/th>\n      <th>followup_number<\/th>\n      <th>date_of_followup<\/th>\n      <th>admin_2_name<\/th>\n      <th>admin_1_name<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":2}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script><p><span style="color: orange;"><strong>CUIDADO:</strong> Cuidado com as duplicatas ao lidar com dados de acompanhamento; podem haver vários seguimentos errôneos no mesmo dia para um determinado contato. Talvez pareça um erro, mas reflete a realidade - por exemplo, um investigador poderia submeter um formulário de acompanhamento no início do dia, quando não foi possível contactar o indivíduo e, mais tarde, submeter um segundo formulário quando conseguir contato. Dependerá do contexto operacional a forma como você quer lida com duplicatas - apenas certifique-se de documentar sua abordagem claramente.</span></p>
<p>Vamos <em>ver</em> quantas linhas “duplicadas” nós temos:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">followups</span> <span class="op">%&gt;%</span> 
  <span class="fu">count</span><span class="op">(</span><span class="va">contact_id</span>, <span class="va">date_of_followup</span><span class="op">)</span> <span class="op">%&gt;%</span>   <span class="co"># obter valores únicos para dias de contato (contact_days)</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">n</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span>                             <span class="co"># ver registros onde a contagem é maior que 1</span></code></pre></div>
<pre><code>## # A tibble: 3 × 3
##   contact_id date_of_followup     n
##   &lt;chr&gt;      &lt;date&gt;           &lt;int&gt;
## 1 &lt;NA&gt;       2020-09-03           2
## 2 &lt;NA&gt;       2020-09-04           2
## 3 &lt;NA&gt;       2020-09-05           2</code></pre>
<p>Em nossos dados de exemplo, os únicos registros aos quais isto se aplica são os que faltam um ID! Podemos removê-los. Mas, para fins de demonstração vamos mostrar os passos para remoção de duplicidades, de forma que haja apenas um acompanhamento por pessoa por dia. Para mais detalhes, veja a página [Eliminação de duplicidades]. Vamos supor que o registro mais recente é o correto. Também aproveitamos a oportunidade para limpar a coluna <code>followup_number</code> (o “dia” de acompanhamento que deve variar de 1 - 14).</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">followups_clean</span> <span class="op">&lt;-</span> <span class="va">followups</span> <span class="op">%&gt;%</span>
  
  <span class="co"># Remover duplicidades</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">contact_id</span>, <span class="va">date_of_followup</span><span class="op">)</span> <span class="op">%&gt;%</span>        <span class="co"># agrupar linhas por dia de contato (contact-day)</span>
  <span class="fu">arrange</span><span class="op">(</span><span class="va">contact_id</span>, <span class="fu">desc</span><span class="op">(</span><span class="va">date_of_followup</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>   <span class="co"># organizar linhas por dia de contato, data de acompanhamento (date of follow-up), trazendo o mais recente para o topo</span>
  <span class="fu">slice_head</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>                                  <span class="co"># manter apenas a primeira linha por valor único de ID do contato (contact id)</span>
  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  
  <span class="co"># Outras limpezas</span>
  <span class="fu">mutate</span><span class="op">(</span>followup_number <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/replace.html">replace</a></span><span class="op">(</span><span class="va">followup_number</span>, <span class="va">followup_number</span> <span class="op">&gt;</span> <span class="fl">14</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># limpar dados errados</span>
  <span class="fu">drop_na</span><span class="op">(</span><span class="va">contact_id</span><span class="op">)</span>                               <span class="co"># remover linhas com valor em branco para contact_id</span></code></pre></div>
<p>Para cada encontro de acompanhamento, temos um status de acompanhamento (por exemplo se o encontro ocorreu e se o contato teve sintomas ou não).
Para ver todos os valores, podemos executar um rápido <code>tabyl()</code> (do <strong>janitor</strong>) ou <code><a href="https://rdrr.io/r/base/table.html">table()</a></code> (do <strong>R Base</strong>) (ver [Tabelas descritivas]) por ‘followup_status’ para ver a frequência de cada um dos resultados.</p>
<p>Neste conjunto de dados, “seen_not_ok” significa “visto com sintomas” e “seen_ok” significa “visto sem sintomas”</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">followups_clean</span> <span class="op">%&gt;%</span> 
  <span class="fu">tabyl</span><span class="op">(</span><span class="va">followup_status</span><span class="op">)</span></code></pre></div>
<pre><code>##  followup_status   n    percent
##           missed  10 0.02325581
##    not_attempted   5 0.01162791
##    not_performed 319 0.74186047
##      seen_not_ok   6 0.01395349
##          seen_ok  90 0.20930233</code></pre>
</div>
<div id="gráfico-ao-longo-do-tempo" class="section level3 unnumbered">
<h3>Gráfico ao longo do tempo<a class="anchor" aria-label="anchor" href="#gr%C3%A1fico-ao-longo-do-tempo"><i class="fas fa-link"></i></a>
</h3>
<p>Como os dados das datas são contínuos, usaremos um histograma para representá-los com a data de acompanhamento (<code>date_of_followup</code>) atribuída ao eixo x. Podemos produzir um histograma “empilhado”, especificando um argumento <code>fill =</code> dentro de <code>aes()</code>, que atribuímos à coluna de status do acompanhamento (<code>followup_status</code>).
Consequentemente, você pode definir o título da legenda utilizando o argumento <code>fill =</code> do <code>labs()</code>.</p>
<p>Podemos ver que os contatos foram identificados em ondas (presumivelmente correspondente às ondas epidêmicas de casos), e que a conclusão do acompanhamento não parece ter melhorado ao longo do curso da epidemia.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">followups_clean</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_histogram</span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">date_of_followup</span>, fill <span class="op">=</span> <span class="va">followup_status</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_fill_discrete</span><span class="op">(</span>drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">+</span>   <span class="co"># exibir todos os níveis de fatores (followup_status) na legenda, mesmo os não utilizados</span>
  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>
    x <span class="op">=</span> <span class="st">""</span>,
    y <span class="op">=</span> <span class="st">"Número de contatos"</span>,
    title <span class="op">=</span> <span class="st">"Status de acompanhamento de contato diário"</span>,
    fill <span class="op">=</span> <span class="st">"Status de acompanhamento"</span>,
    subtitle <span class="op">=</span> <span class="fu">str_glue</span><span class="op">(</span><span class="st">"Dados de {max(followups$date_of_followup, na.rm=T)}"</span><span class="op">)</span><span class="op">)</span>   <span class="co"># subtítulo dinâmico subtitle</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-24-1.png" width="672"></div>
<p><span style="color: orange;"><strong>CUIDADO:</strong> Se você estiver preparando muitos gráficos (por exemplo, para múltiplas jurisdições) é preferível que as legendas apareçam de forma idêntica, mesmo com diferentes níveis de preenchimento ou composição de dados. Podem haver gráficos para os quais nem todos os status de acompanhamento estão presentes nos dados, mas você ainda quer que essas categorias apareçam nas legendas. Em ggplots (como acima), você pode especificar o argumento <code>drop = FALSE</code> do <code>scale_fill_discrete()</code>. Nas tabelas, utilize <code>tabyl()</code> que mostra contagens para todos os níveis de fatores, ou se utilizando<code>count()</code> do <strong>dplyr</strong> adicione o argumento <code>.drop = FALSE</code> para incluir contagens para todos os níveis de fatores.</span></p>
</div>
<div id="rastreamento-individual-diário" class="section level3 unnumbered">
<h3>Rastreamento individual diário<a class="anchor" aria-label="anchor" href="#rastreamento-individual-di%C3%A1rio"><i class="fas fa-link"></i></a>
</h3>
<p>Se seu surto for pequeno o suficiente, pode ser interessante olhar para cada contato individualmente e ver seu status ao longo de seu acompanhamento. Felizmente, este conjunto de dados <code>followups</code> já contém uma coluna com o “número” do dia de acompanhamento (de 1 a 14). Se isto não existir em seus dados, você poderia criá-lo calculando a diferença entre a data do contato e a data que o acompanhamento foi planejado para começar.</p>
<p>Um mecanismo de visualização conveniente (se o número de casos não for muito grande) pode ser um gráfico de calor, feito com <code>geom_tile()</code>.
Veja mais detalhes na página [Gráfico de calor].</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">followups_clean</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_tile</span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">followup_number</span>, y <span class="op">=</span> <span class="va">contact_id</span>, fill <span class="op">=</span> <span class="va">followup_status</span><span class="op">)</span>,
            color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span><span class="op">+</span>       <span class="co"># linhas de grade na cor cinza</span>
  <span class="fu">scale_fill_manual</span><span class="op">(</span> values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"yellow"</span>, <span class="st">"grey"</span>, <span class="st">"orange"</span>, <span class="st">"darkred"</span>, <span class="st">"darkgreen"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">1</span>, to <span class="op">=</span> <span class="fl">14</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-25-1.png" width="672"></div>
</div>
<div id="análises-por-grupo" class="section level3 unnumbered">
<h3>Análises por grupo<a class="anchor" aria-label="anchor" href="#an%C3%A1lises-por-grupo"><i class="fas fa-link"></i></a>
</h3>
<p>Talvez esses dados de acompanhamento estejam sendo vistos diariamente ou semanalmente para a tomada de decisões operacionais. Você pode considerar mais significativo a desagregação por área geográfica ou por equipe de rastreamento de contatos. Podemos fazer isso ajustando as colunas fornecidas no <code>group_by()</code>.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plot_by_region</span> <span class="op">&lt;-</span> <span class="va">followups_clean</span> <span class="op">%&gt;%</span>        <span class="co"># começar com a base de dados de acompanhamento</span>
  <span class="fu">count</span><span class="op">(</span><span class="va">admin_1_name</span>, <span class="va">admin_2_name</span>, <span class="va">followup_status</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># contagem por valores únicos no "region-status" (cria coluna 'n' com a contagem )</span>
  
  <span class="co"># iniciar o ggplot()</span>
  <span class="fu">ggplot</span><span class="op">(</span>                                         <span class="co"># iniciar o ggplot</span>
    mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">admin_2_name</span>, <span class="va">n</span><span class="op">)</span>,   <span class="co"># reordenar os níveis dos fatores de administração pelos valores numéricos na coluna 'n'</span>
                  y <span class="op">=</span> <span class="va">n</span>,                            <span class="co"># altura das barras segundo coluna 'n'</span>
                  fill <span class="op">=</span> <span class="va">followup_status</span>,           <span class="co"># cor da barra empilhada segundo seu status</span>
                  label <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>                      <span class="co"># transição para o geom_label()              </span>
  <span class="fu">geom_col</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>                              <span class="co"># barras empilhadas, vindo do mapeamento anterior</span>
  <span class="fu">geom_text</span><span class="op">(</span>                               <span class="co"># adicionar texto, vindo do mapeamento anterior</span>
    size <span class="op">=</span> <span class="fl">3</span>,                                         
    position <span class="op">=</span> <span class="fu">position_stack</span><span class="op">(</span>vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>, 
    color <span class="op">=</span> <span class="st">"white"</span>,           
    check_overlap <span class="op">=</span> <span class="cn">TRUE</span>,
    fontface <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>
    x <span class="op">=</span> <span class="st">""</span>,
    y <span class="op">=</span> <span class="st">"Número de contatos"</span>,
    title <span class="op">=</span> <span class="st">"Status do acompanhamento do contato, por Região"</span>,
    fill <span class="op">=</span> <span class="st">"Status do acompanhamento"</span>,
    subtitle <span class="op">=</span> <span class="fu">str_glue</span><span class="op">(</span><span class="st">"Dados de {max(followups_clean$date_of_followup, na.rm=T)}"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>                                               <span class="co"># Plano de fundo simplificado</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">admin_1_name</span>, strip.position <span class="op">=</span> <span class="st">"right"</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># introduzir facetas </span>

<span class="va">plot_by_region</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-26-1.png" width="672"></div>
<!-- Se isso fosse desagregado pelo marcador de contatos, talvez quiséssemos adicionar uma linha limite para exibir o total de contatos # que normalmente uma pessoa ou área/equipe pode lidar, e como a carga de trabalho atual se compara. Fazemos isso apenas usando a função `geom_hline()`. -->
<!-- ```{r, warning=F, message=F} -->
<!-- plot_by_region +  -->
<!--      geom_hline(aes(yintercept=25), color="#C70039", linetype = "dashed") # limiar fictício em 25 contatos -->
<!-- ``` -->
</div>
</div>
<div id="tabelas-kpi" class="section level2" number="1.4">
<h2>
<span class="header-section-number">1.4</span> Tabelas KPI<a class="anchor" aria-label="anchor" href="#tabelas-kpi"><i class="fas fa-link"></i></a>
</h2>
<p>Há uma série de diferentes indicadores-Chave de Desempenho (KPIs, de <em>Key Performance Indicators</em> em inglês) que podem ser calculados e rastreados em diferentes níveis de desagregação e ao longo de diferentes períodos de tempo para monitorar o desempenho do rastreamento de contatos. Uma vez que você tenha os cálculos e o formato básico da tabela; é bastante fácil trocar por diferentes KPIs.</p>
<p>Existem várias fontes de rastreamento de contatos KPIs, tais como este (de <a href="https://contacttracingplaybook.resolvetosavelives.org/checklists/metrics">ResolveToSaveLives.org</a>).A maior parte do trabalho será caminhar através de sua estrutura de dados e pensar em todos os critérios de inclusão/exclusão. Mostramos alguns exemplos abaixo; usando a estrutura de metadados Go.Data:</p>
<div class="inline-table"><table style="width:97%;" class="table table-sm">
<colgroup>
<col width="19%">
<col width="27%">
<col width="29%">
<col width="20%">
</colgroup>
<thead><tr class="header">
<th>Categoria</th>
<th>Indicador</th>
<th>Numerador Go.Data</th>
<th>Denominador
Go.Data</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Indicador
de processo
(Velocidade
de rastreio
do contato)</td>
<td>% casos
entrevistados e
isolados em até
24h da informação</td>
<td>COUNT OF <code>case_id</code>
WHERE
(<code>date_of_reporting</code>
-
<code>da te_of_data_entry</code>)
&lt; 1 dia E
(<code>is olation_startdate</code>
-
<code>da te_of_data_entry</code>)
&lt; 1 day</td>
<td>COUNT OF
<code>case_id</code>
</td>
</tr>
<tr class="even">
<td>Indicador
de processo
-
velocidade
de rastreio
do contato</td>
<td>% de contatos
notificados e em
quarentena em até
24h da exposição</td>
<td>COUNT OF
<code>contact_id</code> WHERE
<code>followup_status</code>
== “SEEN_NOT_OK”
OR “SEEN_OK” AND
<code>date_of_followup</code>
-
<code>date_of_reporting</code>
&lt; 1 day</td>
<td>COUNT OF
<code>contact_id</code>
</td>
</tr>
<tr class="odd">
<td>Indicador
de processo
-
Completude
da testagem</td>
<td>% de novos casos
sintomaticos
testados e
entrevistados em
até 3 dias do
início de
sintomas</td>
<td>COUNT OF <code>case_id</code>
WHERE
(<code>date_of_reporting</code>
- <code>date_of_onset</code>)
&lt; =3 days</td>
<td>COUNT OF
<code>case_id</code>
</td>
</tr>
<tr class="even">
<td>Indicador
de
resultados
- Geral</td>
<td>% novos casos
entre lista de
contatos
existente</td>
<td>COUNT OF <code>case_id</code>
WHERE
<code>was_contact</code> ==
“TRUE”</td>
<td>COUNT OF
<code>case_id</code>
</td>
</tr>
</tbody>
</table></div>
<p>Abaixo, iremos passar por um exercício de exemplo de criação de uma tabela que mostra o acompanhamento dos contatos ao longo de áreas administrativas. No final, tornaremos essa tabela apresentável com o pacote <strong>formattable</strong> (mas você poderia usar outros pacotes, como <strong>flextable</strong> - veja [Tabelas para apresentação]).</p>
<p>A criação de tabelas como esta, dependerá da sua estrutura de dados de rastreamento de contatos. Visite a página [Tabelas descritivas] para aprender como resumir os dados usando as funções do <strong>dplyr</strong>.</p>
<p>Criaremos uma tabela que será dinâmica e mudará de acordo com a mudança dos dados. Para tornar os resultados interessantes, estabeleceremos uma data de relato (<code>report_date</code>), que nos permite simular o funcionamento da tabela em um determinado dia (escolhemos 10 de Junho de 2020). Os dados são filtrados até essa data.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Criar a "Report date" para simular simular a execução do relatório com dados "a partir" desta data</span>
<span class="va">report_date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2020-06-10"</span><span class="op">)</span>

<span class="co"># Criar dados de acompanhamento para refletir a data do relatório</span>
<span class="va">table_data</span> <span class="op">&lt;-</span> <span class="va">followups_clean</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">date_of_followup</span> <span class="op">&lt;=</span> <span class="va">report_date</span><span class="op">)</span></code></pre></div>
<p>Agora, com base em nossa estrutura de dados, faremos o seguinte:</p>
<ol style="list-style-type: decimal">
<li>Comece com os <code>followups</code> e use o <em>summarise</em> para que contenha, em cada contato único:</li>
</ol>
<ul>
<li>A data do último registro (não importa o status do encontro)</li>
<li>A data do último encontro em que o contato foi “visto”</li>
<li>O status do encontro naquela última vez em que o contato foi “visto” (por exemplo, com sintomas ou sem sintomas)</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Junte estes dados aos dados de contato, que contêm outras informações como o status geral de contato, data do último exposição a um caso, etc. Também calcularemos as métricas de interesse para cada contato, tais como dias desde a última exposição</li>
<li>Agrupamos os dados de contato melhorados por região geográfica (<code>admin_2_name</code>) e calculamos estatísticas resumidas por região</li>
<li>Finalmente, formatamos a tabela para apresentação</li>
</ol>
<p>Primeiro resumimos os dados de acompanhamento para obter as informações de interesse:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">followup_info</span> <span class="op">&lt;-</span> <span class="va">table_data</span> <span class="op">%&gt;%</span> 
  <span class="fu">group_by</span><span class="op">(</span><span class="va">contact_id</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">summarise</span><span class="op">(</span>
    date_last_record   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">date_of_followup</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,
    date_last_seen     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">date_of_followup</span><span class="op">[</span><span class="va">followup_status</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"seen_ok"</span>, <span class="st">"seen_not_ok"</span><span class="op">)</span><span class="op">]</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,
    status_last_record <span class="op">=</span> <span class="va">followup_status</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">date_of_followup</span> <span class="op">==</span> <span class="va">date_last_record</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>Aqui vemos os dados:</p>
<div id="htmlwidget-0a9b7b5765194a8bccb6" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-0a9b7b5765194a8bccb6">{"x":{"filter":"none","data":[["CONTACT-2020-0001","CONTACT-2020-0003","CONTACT-2020-0004","CONTACT-2020-0005","CONTACT-2020-0006","CONTACT-2020-0007","CONTACT-2020-0012","CONTACT-2020-0013","CONTACT-2020-0014","CONTACT-2020-0015","CONTACT-2020-0016","CONTACT-2020-0017","CONTACT-2020-0018","CONTACT-2020-0019","CONTACT-2020-0026","CONTACT-2020-0027","CONTACT-2020-0028","CONTACT-2020-0029","CONTACT-2020-0033","CONTACT-2020-0035","CONTACT-2020-0036","CONTACT-2020-0039","CONTACT-2020-0040","CONTACT-2020-0041","CONTACT-2020-0042","CONTACT-2020-0043","CONTACT-2020-0044","CONTACT-2020-0046","CONTACT-2020-0047","CONTACT-2020-0048","CONTACT-2020-0049","CONTACT-2020-0050","CONTACT-2020-0052","CONTACT-2020-0054","CONTACT-2020-0055","CONTACT-2020-0056","CONTACT-2020-0057","CONTACT-2020-0058","CONTACT-2020-0059","CONTACT-2020-0060"],["2020-06-01","2020-06-01","2020-06-01","2020-06-01","2020-06-01","2020-06-01","2020-06-05","2020-06-05","2020-06-05","2020-06-05","2020-06-05","2020-06-05","2020-06-05","2020-06-05","2020-06-05","2020-06-05","2020-06-05","2020-06-05","2020-06-05","2020-06-05","2020-06-05","2020-06-06","2020-06-05","2020-06-05","2020-06-05","2020-06-05","2020-06-05","2020-06-06","2020-06-05","2020-06-01","2020-06-05","2020-06-05","2020-06-05","2020-06-05","2020-06-05","2020-06-05","2020-06-05","2020-06-05","2020-06-05","2020-06-05"],[null,"2020-06-01","2020-06-01","2020-06-01","2020-06-01","2020-06-01","2020-06-04","2020-06-04","2020-06-04","2020-06-04","2020-06-04","2020-06-03","2020-06-03","2020-06-05","2020-06-03","2020-06-05","2020-06-05","2020-06-05",null,"2020-06-03","2020-06-05","2020-06-06","2020-06-04","2020-06-04","2020-06-05","2020-06-04","2020-06-05","2020-06-05","2020-06-04","2020-06-01","2020-06-05","2020-06-05","2020-06-05","2020-06-04","2020-06-05","2020-06-03","2020-06-02","2020-06-03","2020-06-05","2020-06-05"],["missed","seen_ok","seen_ok","seen_ok","seen_ok","seen_ok","not_performed","not_performed","not_performed","not_performed","not_performed","not_performed","not_performed","seen_ok","not_performed","seen_ok","seen_ok","seen_ok","not_performed","missed","seen_ok","seen_ok","not_performed","not_performed","seen_ok","not_performed","seen_not_ok","not_performed","not_performed","seen_ok","seen_ok","seen_ok","seen_ok","not_performed","seen_ok","not_performed","not_performed","not_performed","seen_ok","seen_ok"]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>contact_id<\/th>\n      <th>date_last_record<\/th>\n      <th>date_last_seen<\/th>\n      <th>status_last_record<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":12,"scrollX":true,"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,12,25,50,100]}},"evals":[],"jsHooks":[]}</script><p>Agora vamos adicionar essas informações à base de dados <code>contacts</code> e calcular algumas colunas adicionais</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">contacts_info</span> <span class="op">&lt;-</span> <span class="va">followup_info</span> <span class="op">%&gt;%</span> 
  <span class="fu">right_join</span><span class="op">(</span><span class="va">contacts</span>, by <span class="op">=</span> <span class="st">"contact_id"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>
    database_date       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">date_last_record</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,
    days_since_seen     <span class="op">=</span> <span class="va">database_date</span> <span class="op">-</span> <span class="va">date_last_seen</span>,
    days_since_exposure <span class="op">=</span> <span class="va">database_date</span> <span class="op">-</span> <span class="va">date_of_last_exposure</span>
    <span class="op">)</span></code></pre></div>
<p>Aqui vemos a aparência dos dados. Observe a coluna <code>contacts</code> à direita e a nova coluna calculada na extrema direita.</p>
<div id="htmlwidget-cab474b73bee7b654e94" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-cab474b73bee7b654e94">{"x":{"filter":"none","data":[["CONTACT-2020-0001","CONTACT-2020-0003","CONTACT-2020-0004","CONTACT-2020-0005","CONTACT-2020-0006","CONTACT-2020-0007","CONTACT-2020-0012","CONTACT-2020-0013","CONTACT-2020-0014","CONTACT-2020-0015","CONTACT-2020-0016","CONTACT-2020-0017","CONTACT-2020-0018","CONTACT-2020-0019","CONTACT-2020-0026","CONTACT-2020-0027","CONTACT-2020-0028","CONTACT-2020-0029","CONTACT-2020-0033","CONTACT-2020-0035","CONTACT-2020-0036","CONTACT-2020-0039","CONTACT-2020-0040","CONTACT-2020-0041","CONTACT-2020-0042","CONTACT-2020-0043","CONTACT-2020-0044","CONTACT-2020-0046","CONTACT-2020-0047","CONTACT-2020-0048","CONTACT-2020-0049","CONTACT-2020-0050","CONTACT-2020-0052","CONTACT-2020-0054","CONTACT-2020-0055","CONTACT-2020-0056","CONTACT-2020-0057","CONTACT-2020-0058","CONTACT-2020-0059","CONTACT-2020-0060","CONTACT-2020-0030","CONTACT-2020-0021","CONTACT-2020-0053","CONTACT-2020-0011","CONTACT-2020-0032","CONTACT-2020-0025","CONTACT-2020-0045","CONTACT-2020-0020","CONTACT-2020-0031","CONTACT-2020-0037","CONTACT-2020-0051","CONTACT-2020-0008","CONTACT-2020-0038","CONTACT-2020-0010","CONTACT-2020-0034","CONTACT-2020-0009","CONTACT-2020-0022","CONTACT-2020-0023",null,null,"CASE-2020-0043","CASE-2020-0044","CASE-2020-0045","CASE-2020-0046","CONTACT-2020-0024","CONTACT-2020-0002"],["2020-06-01","2020-06-01","2020-06-01","2020-06-01","2020-06-01","2020-06-01","2020-06-05","2020-06-05","2020-06-05","2020-06-05","2020-06-05","2020-06-05","2020-06-05","2020-06-05","2020-06-05","2020-06-05","2020-06-05","2020-06-05","2020-06-05","2020-06-05","2020-06-05","2020-06-06","2020-06-05","2020-06-05","2020-06-05","2020-06-05","2020-06-05","2020-06-06","2020-06-05","2020-06-01","2020-06-05","2020-06-05","2020-06-05","2020-06-05","2020-06-05","2020-06-05","2020-06-05","2020-06-05","2020-06-05","2020-06-05",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,"2020-06-01","2020-06-01","2020-06-01","2020-06-01","2020-06-01","2020-06-04","2020-06-04","2020-06-04","2020-06-04","2020-06-04","2020-06-03","2020-06-03","2020-06-05","2020-06-03","2020-06-05","2020-06-05","2020-06-05",null,"2020-06-03","2020-06-05","2020-06-06","2020-06-04","2020-06-04","2020-06-05","2020-06-04","2020-06-05","2020-06-05","2020-06-04","2020-06-01","2020-06-05","2020-06-05","2020-06-05","2020-06-04","2020-06-05","2020-06-03","2020-06-02","2020-06-03","2020-06-05","2020-06-05",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["missed","seen_ok","seen_ok","seen_ok","seen_ok","seen_ok","not_performed","not_performed","not_performed","not_performed","not_performed","not_performed","not_performed","seen_ok","not_performed","seen_ok","seen_ok","seen_ok","not_performed","missed","seen_ok","seen_ok","not_performed","not_performed","seen_ok","not_performed","seen_not_ok","not_performed","not_performed","seen_ok","seen_ok","seen_ok","seen_ok","not_performed","seen_ok","not_performed","not_performed","not_performed","seen_ok","seen_ok",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["FOLLOW_UP_COMPLETED","FOLLOW_UP_COMPLETED","FOLLOW_UP_COMPLETED","UNDER_FOLLOW_UP","FOLLOW_UP_COMPLETED","FOLLOW_UP_COMPLETED","LOST_TO_FOLLOW_UP","UNDER_FOLLOW_UP","UNDER_FOLLOW_UP","LOST_TO_FOLLOW_UP","UNDER_FOLLOW_UP","FOLLOW_UP_COMPLETED","FOLLOW_UP_COMPLETED","UNDER_FOLLOW_UP","UNDER_FOLLOW_UP","UNDER_FOLLOW_UP","UNDER_FOLLOW_UP","DIED","UNDER_FOLLOW_UP","UNDER_FOLLOW_UP","UNDER_FOLLOW_UP","LOST_TO_FOLLOW_UP","FOLLOW_UP_COMPLETED","UNDER_FOLLOW_UP","FOLLOW_UP_COMPLETED","UNDER_FOLLOW_UP","LOST_TO_FOLLOW_UP","UNDER_FOLLOW_UP","UNDER_FOLLOW_UP","FOLLOW_UP_COMPLETED","UNDER_FOLLOW_UP","UNDER_FOLLOW_UP","UNDER_FOLLOW_UP","UNDER_FOLLOW_UP","DIED","FOLLOW_UP_COMPLETED","LOST_TO_FOLLOW_UP","UNDER_FOLLOW_UP","UNDER_FOLLOW_UP","LOST_TO_FOLLOW_UP","FOLLOW_UP_COMPLETED","UNDER_FOLLOW_UP","UNDER_FOLLOW_UP","UNDER_FOLLOW_UP","FOLLOW_UP_COMPLETED","UNDER_FOLLOW_UP","FOLLOW_UP_COMPLETED","FOLLOW_UP_COMPLETED","FOLLOW_UP_COMPLETED","FOLLOW_UP_COMPLETED","FOLLOW_UP_COMPLETED","FOLLOW_UP_COMPLETED","FOLLOW_UP_COMPLETED","UNDER_FOLLOW_UP","FOLLOW_UP_COMPLETED","UNDER_FOLLOW_UP","UNDER_FOLLOW_UP","UNDER_FOLLOW_UP","UNDER_FOLLOW_UP","UNDER_FOLLOW_UP","BECAME_CASE","BECAME_CASE","BECAME_CASE","BECAME_CASE","BECAME_CASE","BECAME_CASE"],["Cheik","Cheik","Khary","Birima","Malang","Maguette","Alfa","Ndiogou","Madia","Adama","Lamine","Racine","Yacouba","Kalidou","Thione","Sadibou","Papis","Coura","Thiony","Sofiatou","Djiby","Abba","Khary","Oumou","Dicory","Adja","Mbagnick","Abou","Ndiankou","Malamine","Youssouf","Waly","Mayatta","Alimatou","Djeynaba","Amath","Wasis","Bransan  ","Bintou","Binette","Aminata","Binta","Birima","Cheik","El Hadj","Khadija","Khary","Khary","Lat","Maguette","Maguette","Malamine","Malamine","Malang","Malang","Modou","Ndiaya","Oulimata","Mayatta","Jelani","Adama","Adji","Alfa","Alfa","Birima","Malang"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"Abebe",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"Obi","Onai",null,null,null,null,null,null],["MALE","MALE","FEMALE","MALE","FEMALE","FEMALE","FEMALE","FEMALE","MALE","MALE","FEMALE","FEMALE","MALE","MALE","MALE","MALE","FEMALE","MALE","FEMALE","FEMALE","FEMALE","FEMALE","MALE","MALE","MALE","MALE","MALE","MALE","MALE","MALE","FEMALE","MALE","MALE","MALE","FEMALE","MALE","FEMALE","FEMALE","FEMALE","FEMALE","FEMALE","FEMALE","MALE","MALE","MALE","MALE","FEMALE","FEMALE","FEMALE","FEMALE","FEMALE","MALE","MALE","FEMALE","FEMALE","MALE","FEMALE","MALE","MALE","MALE","MALE","FEMALE","FEMALE","FEMALE","MALE","FEMALE"],[12,12,32,3,54,29,34,56,34,56,12,35,78,20,45,15,null,null,5,null,45,17,21,34,15,47,null,81,67,7,null,56,null,8,54,54,2,23,97,34,36,32,3,12,21,4,32,32,23,9,9,63,7,54,54,18,32,23,null,24,null,25,34,34,3,54],["10-14","10-14","30-39","0-4","50-59","20-29","30-39","50-59","30-39","50-59","10-14","30-39","75-79","20-29","40-49","15-19","unknown","unknown","5-9","unknown","40-49","15-19","20-29","30-39","15-19","40-49","unknown","80+","65-69","5-9","unknown","50-59","unknown","5-9","50-59","50-59","0-4","20-29","80+","30-39","30-39","30-39","0-4","10-14","20-29","0-4","30-39","30-39","20-29","5-9","5-9","60-64","5-9","50-59","50-59","15-19","30-39","20-29","unknown","20-29","unknown","20-29","30-39","30-39","0-4","50-59"],["CHILD","CHILD","FARMER","CHILD","FARMER","OTHER",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"FARMER",null,null,null,null,null,null,"HEALTH_CARE_WORKER","STUDENT","HEALTH_CARE_WORKER",null,"BUTCHER","BUTCHER",null,"FARMER"],["2020-03-22","2020-03-22","2020-03-22","2020-05-01","2020-03-22","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-16","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-05-25","2020-05-25","2020-05-25","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-04-15","2020-05-25","2020-04-15","2020-05-25","2020-05-25","2020-05-25","2020-09-02","2020-09-03","2020-07-08","2020-07-11","2020-07-16","2020-07-07","2020-04-15","2020-03-22"],["2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-09-03","2020-09-04","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08"],["2020-06-07","2020-06-07","2020-06-07","2020-04-28","2020-06-07","2020-06-07","2020-06-15","2020-06-22","2020-06-15","2020-08-13","2020-06-22","2020-06-15","2020-06-15","2020-06-24","2020-06-22","2020-06-24","2020-06-17","2020-06-17","2020-06-22","2020-06-17","2020-06-19","2020-06-24","2020-06-15","2020-06-22","2020-06-16","2020-06-22","2020-06-17","2020-06-22","2020-06-20","2020-06-06","2020-06-17","2020-06-17","2020-06-17","2020-06-17","2020-06-20","2020-09-02","2020-06-17","2020-06-22","2020-06-20","2020-06-16","2020-05-15","2020-05-13","2020-04-26","2020-04-26","2020-05-10","2020-05-08","2020-06-05","2020-06-05","2020-05-10","2020-06-05","2020-06-05","2020-04-28","2020-06-05","2020-04-29","2020-06-05","2020-05-15","2020-05-10","2020-05-13","2020-09-02","2020-09-01","2020-05-06","2020-05-10","2020-07-27","2020-05-06","2020-04-26","2020-04-28"],["2020-06-08","2020-06-08","2020-06-08","2020-04-29","2020-06-08","2020-06-08","2020-06-16","2020-06-23","2020-06-16","2020-08-14","2020-06-23","2020-06-16","2020-06-16","2020-06-25","2020-06-23","2020-06-25","2020-06-18","2020-06-18","2020-06-23","2020-06-18","2020-06-20","2020-06-25","2020-06-16","2020-06-23","2020-06-17","2020-08-14","2020-06-18","2020-08-15","2020-06-21","2020-06-08","2020-06-18","2020-06-18","2020-06-18","2020-06-18","2020-06-21","2020-09-03","2020-06-18","2020-06-23","2020-06-21","2020-06-17",null,"2020-05-14","2020-04-27","2020-04-27",null,null,"2020-06-06","2020-06-06",null,"2020-06-06","2020-06-06",null,"2020-06-06","2020-04-30","2020-06-06","2020-05-16","2020-05-11","2020-05-14","2020-09-03","2020-09-02",null,null,null,null,"2020-06-06",null],["2020-06-21","2020-06-21","2020-06-21","2020-05-12","2020-06-21","2020-06-21","2020-06-29","2020-07-06","2020-06-29","2020-08-27","2020-07-06","2020-06-29","2020-06-29","2020-07-08","2020-07-06","2020-07-08","2020-07-01","2020-07-01","2020-07-06","2020-07-01","2020-07-03","2020-07-08","2020-06-29","2020-07-06","2020-06-30","2020-08-27","2020-07-01","2020-08-28","2020-07-04","2020-06-21","2020-07-01","2020-07-01","2020-07-01","2020-07-01","2020-07-04","2020-09-16","2020-07-01","2020-07-06","2020-07-04","2020-06-30",null,"2020-05-27","2020-05-10","2020-05-10",null,null,"2020-06-19","2020-06-19",null,"2020-06-19","2020-06-19",null,"2020-06-19","2020-05-13","2020-06-19","2020-05-29","2020-05-24","2020-05-27","2020-09-16","2020-09-15",null,null,null,null,"2020-06-19",null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"1_LOW","3_HIGH","1_LOW",null,null,null,null],[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,null,null,null,null,null,null],["Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Trumpet","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Trumpet","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Trumpet","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Djembe","Congas","Venu","Cornet","Venu","Djembe","Djembe"],["2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06","2020-06-06"],[null,5,5,5,5,5,2,2,2,2,2,3,3,1,3,1,1,1,null,3,1,0,2,2,1,2,1,1,2,5,1,1,1,2,1,3,4,3,1,1,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[-1,-1,-1,39,-1,-1,-9,-16,-9,-68,-16,-9,-9,-18,-16,-18,-11,-11,-16,-11,-13,-18,-9,-16,-10,-16,-11,-16,-14,0,-11,-11,-11,-11,-14,-88,-11,-16,-14,-10,22,24,41,41,27,29,1,1,27,1,1,39,1,38,1,22,27,24,-88,-87,31,27,-51,31,41,39]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>contact_id<\/th>\n      <th>date_last_record<\/th>\n      <th>date_last_seen<\/th>\n      <th>status_last_record<\/th>\n      <th>contact_status<\/th>\n      <th>firstName<\/th>\n      <th>lastName<\/th>\n      <th>gender<\/th>\n      <th>age<\/th>\n      <th>age_class<\/th>\n      <th>occupation<\/th>\n      <th>date_of_reporting<\/th>\n      <th>date_of_data_entry<\/th>\n      <th>date_of_last_exposure<\/th>\n      <th>date_of_followup_start<\/th>\n      <th>date_of_followup_end<\/th>\n      <th>risk_level<\/th>\n      <th>was_case<\/th>\n      <th>admin_2_name<\/th>\n      <th>database_date<\/th>\n      <th>days_since_seen<\/th>\n      <th>days_since_exposure<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":12,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":8}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,12,25,50,100]}},"evals":[],"jsHooks":[]}</script><p>A seguir, resumimos os dados de contato por região, para obter uma base concisa de colunas estatísticas resumidas.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">contacts_table</span> <span class="op">&lt;-</span> <span class="va">contacts_info</span> <span class="op">%&gt;%</span> 
  
  <span class="fu">group_by</span><span class="op">(</span>`Admin 2` <span class="op">=</span> <span class="va">admin_2_name</span><span class="op">)</span> <span class="op">%&gt;%</span>
  
  <span class="fu">summarise</span><span class="op">(</span>
    `Registered contacts` <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span>,
    `Active contacts`     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">contact_status</span> <span class="op">==</span> <span class="st">"UNDER_FOLLOW_UP"</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,
    `In first week`       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">days_since_exposure</span> <span class="op">&lt;</span> <span class="fl">8</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,
    `In second week`      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">days_since_exposure</span> <span class="op">&gt;=</span> <span class="fl">8</span> <span class="op">&amp;</span> <span class="va">days_since_exposure</span> <span class="op">&lt;</span> <span class="fl">15</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,
    `Became case`         <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">contact_status</span> <span class="op">==</span> <span class="st">"BECAME_CASE"</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,
    `Lost to follow up`   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">days_since_seen</span> <span class="op">&gt;=</span> <span class="fl">3</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,
    `Never seen`          <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">date_last_seen</span><span class="op">)</span><span class="op">)</span>,
    `Followed up - signs` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">status_last_record</span> <span class="op">==</span> <span class="st">"Seen_not_ok"</span> <span class="op">&amp;</span> <span class="va">date_last_record</span> <span class="op">==</span> <span class="va">database_date</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,
    `Followed up - no signs` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">status_last_record</span> <span class="op">==</span> <span class="st">"Seen_ok"</span> <span class="op">&amp;</span> <span class="va">date_last_record</span> <span class="op">==</span> <span class="va">database_date</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,
    `Not Followed up`     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span>
      <span class="op">(</span><span class="va">status_last_record</span> <span class="op">==</span> <span class="st">"NOT_ATTEMPTED"</span> <span class="op">|</span> <span class="va">status_last_record</span> <span class="op">==</span> <span class="st">"NOT_PERFORMED"</span><span class="op">)</span> <span class="op">&amp;</span>
        <span class="va">date_last_record</span> <span class="op">==</span> <span class="va">database_date</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    
  <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">`Registered contacts`</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-62612bee476ca60de11f" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-62612bee476ca60de11f">{"x":{"filter":"none","data":[["Djembe","Trumpet","Venu","Congas","Cornet"],[59,3,2,1,1],[30,1,0,0,0],[44,3,0,0,1],[0,0,0,0,0],[2,0,2,1,1],[15,0,0,0,0],[22,0,2,1,1],[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>Admin 2<\/th>\n      <th>Registered contacts<\/th>\n      <th>Active contacts<\/th>\n      <th>In first week<\/th>\n      <th>In second week<\/th>\n      <th>Became case<\/th>\n      <th>Lost to follow up<\/th>\n      <th>Never seen<\/th>\n      <th>Followed up - signs<\/th>\n      <th>Followed up - no signs<\/th>\n      <th>Not Followed up<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":12,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10]}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,12,25,50,100]}},"evals":[],"jsHooks":[]}</script><p>E agora aplicamos estilos dos pacotes <strong>formattable</strong> e <strong>knitr</strong>, incluindo uma nota de rodapé que mostra a data “a partir de”.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">contacts_table</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>
    `Admin 2` <span class="op">=</span> <span class="fu">formatter</span><span class="op">(</span><span class="st">"span"</span>, style <span class="op">=</span> <span class="op">~</span> <span class="fu">formattable</span><span class="fu">::</span><span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/style.html">style</a></span><span class="op">(</span>
      color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">`Admin 2`</span> <span class="op">==</span> <span class="cn">NA</span>, <span class="st">"red"</span>, <span class="st">"grey"</span><span class="op">)</span>,
      font.weight <span class="op">=</span> <span class="st">"bold"</span>,font.style <span class="op">=</span> <span class="st">"italic"</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="va">`Admin 2`</span><span class="op">)</span>,
    `Followed up - signs`<span class="op">=</span> <span class="fu">color_tile</span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"orange"</span><span class="op">)</span><span class="op">(</span><span class="va">`Followed up - signs`</span><span class="op">)</span>,
    `Followed up - no signs`<span class="op">=</span> <span class="fu">color_tile</span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"#A0E2BD"</span><span class="op">)</span><span class="op">(</span><span class="va">`Followed up - no signs`</span><span class="op">)</span>,
    `Became case`<span class="op">=</span> <span class="fu">color_tile</span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"grey"</span><span class="op">)</span><span class="op">(</span><span class="va">`Became case`</span><span class="op">)</span>,
    `Lost to follow up`<span class="op">=</span> <span class="fu">color_tile</span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"grey"</span><span class="op">)</span><span class="op">(</span><span class="va">`Lost to follow up`</span><span class="op">)</span>, 
    `Never seen`<span class="op">=</span> <span class="fu">color_tile</span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">(</span><span class="va">`Never seen`</span><span class="op">)</span>,
    `Active contacts` <span class="op">=</span> <span class="fu">color_tile</span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"#81A4CE"</span><span class="op">)</span><span class="op">(</span><span class="va">`Active contacts`</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">kable</span><span class="op">(</span><span class="st">"html"</span>, escape <span class="op">=</span> <span class="cn">F</span>, align <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"l"</span>,<span class="st">"c"</span>,<span class="st">"c"</span>,<span class="st">"c"</span>,<span class="st">"c"</span>,<span class="st">"c"</span>,<span class="st">"c"</span>,<span class="st">"c"</span>,<span class="st">"c"</span>,<span class="st">"c"</span>,<span class="st">"c"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">kable_styling</span><span class="op">(</span><span class="st">"hover"</span>, full_width <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">add_header_above</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">" "</span> <span class="op">=</span> <span class="fl">3</span>, 
                     <span class="st">"Contatos atualmente em acompanhamento"</span> <span class="op">=</span> <span class="fl">5</span>,
                     <span class="st">"Status na última visita"</span> <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/footnote.html">footnote</a></span><span class="op">(</span>general <span class="op">=</span> <span class="fu">str_glue</span><span class="op">(</span><span class="st">"Data are current to {format(report_date, '%b %d %Y')}"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;">
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="3">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="5">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Contatos atualmente em acompanhamento
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Status na última visita
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Admin 2
</th>
<th style="text-align:center;">
Registered contacts
</th>
<th style="text-align:center;">
Active contacts
</th>
<th style="text-align:center;">
In first week
</th>
<th style="text-align:center;">
In second week
</th>
<th style="text-align:center;">
Became case
</th>
<th style="text-align:center;">
Lost to follow up
</th>
<th style="text-align:center;">
Never seen
</th>
<th style="text-align:center;">
Followed up - signs
</th>
<th style="text-align:center;">
Followed up - no signs
</th>
<th style="text-align:center;">
Not Followed up
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<span style="font-weight: bold; font-style: italic">Djembe </span>
</td>
<td style="text-align:center;">
59
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #81a4ce">30</span>
</td>
<td style="text-align:center;">
44
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #bebebe">2</span>
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #bebebe">15</span>
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000">22</span>
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff">0</span>
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff">0</span>
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
<span style="font-weight: bold; font-style: italic">Trumpet</span>
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #fafbfd">1</span>
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff">0</span>
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff">0</span>
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff">0</span>
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff">0</span>
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff">0</span>
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
<span style="font-weight: bold; font-style: italic">Venu </span>
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff">0</span>
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #bebebe">2</span>
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff">0</span>
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #ffe7e7">2</span>
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff">0</span>
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff">0</span>
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
<span style="font-weight: bold; font-style: italic">Congas </span>
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff">0</span>
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #dedede">1</span>
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff">0</span>
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #fff3f3">1</span>
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff">0</span>
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff">0</span>
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
<span style="font-weight: bold; font-style: italic">Cornet </span>
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff">0</span>
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #dedede">1</span>
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff">0</span>
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #fff3f3">1</span>
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff">0</span>
</td>
<td style="text-align:center;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff">0</span>
</td>
<td style="text-align:center;">
0
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; " colspan="100%">
<span style="font-style: italic;">Note: </span>
</td>
</tr>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> Data are current to Jun 10 2020
</td>
</tr>
</tfoot>
</table></div>
</div>
<div id="matrizes-de-transmissão" class="section level2" number="1.5">
<h2>
<span class="header-section-number">1.5</span> Matrizes de transmissão<a class="anchor" aria-label="anchor" href="#matrizes-de-transmiss%C3%A3o"><i class="fas fa-link"></i></a>
</h2>
<p>Como foi discutido na página [Gráficos de calor], você pode criar uma matriz de “quem infectou quem” utilizando <code>geom_tile()</code>.</p>
<p>Quando novos contatos são criados, o Go.Data armazena essa informação de relações no ponto final da API <code>relationships</code>; e podemos ver o primeiras 50 filas deste conjunto de dados abaixo. Isto significa que podemos criar um gráfico de calor com relativamente poucas etapas, dado que cada contato já está unido ao seu caso de origem.</p>
<div id="htmlwidget-25fc243f9508ebfa79fa" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-25fc243f9508ebfa79fa">{"x":{"filter":"none","data":[["CASE-2020-0016",null,null,"CASE-2020-0045","CASE-2020-0004","CASE-2020-0010",null,"CASE-2020-0034",null,"CASE-2020-0037","CASE-2020-0005",null,"CASE-2020-0002","CASE-2020-0001","CASE-2020-0005",null,"CASE-2020-0004","CASE-2020-0012","CASE-2020-0022","CASE-2020-0004","CASE-2020-0003","CASE-2020-0001","CASE-2020-0030","CASE-2020-0022","CASE-2020-0010","CASE-2020-0018","CASE-2020-0045","CASE-2020-0030","CASE-2020-0001","CASE-2020-0018","CASE-2020-0008","CASE-2020-0014",null,"CASE-2020-0002","CASE-2020-0030","CASE-2020-0031","CASE-2020-0009","CASE-2020-0031","CASE-2020-0002",null,"CASE-2020-0001","CASE-2020-0001","CASE-2020-0022","CASE-2020-0001","CASE-2020-0012","CASE-2020-0023","CASE-2020-0016","CASE-2020-0001",null,"CASE-2020-0023"],["Female",null,null,"Female","Male","Female",null,"Male",null,"Female","Male",null,"Male","Female","Male",null,"Male","Female","Female","Male","Male","Female","Male","Female","Female","Male","Female","Male","Female","Male","Male","Male",null,"Male","Male","Male","Female","Male","Male",null,"Female","Female","Female","Female","Female","Female","Female","Female","Female","Female"],[80,null,null,34,43,37,null,20,null,80,23,0,52,49,23,null,43,80,51,43,58,49,52,51,37,25,34,52,49,25,7,54,null,52,52,20,57,20,52,null,49,49,51,49,80,43,80,49,43,43],["2020-06-24","2020-05-02","2020-06-15","2020-07-27","2020-06-05","2020-06-05","2020-08-19","2020-06-20","2020-08-19","2020-09-02","2020-08-07","2020-08-13","2020-05-15","2020-07-17","2020-06-15","2020-08-07","2020-06-15","2020-06-17","2020-06-05","2020-06-24","2020-06-07","2020-08-15","2020-06-17","2020-06-22","2020-06-19","2020-06-17","2020-07-27","2020-06-16","2020-04-28","2020-04-26","2020-06-15","2020-06-05","2020-05-02","2020-04-29","2020-06-22","2020-06-06","2020-05-13","2020-06-17","2020-05-01","2020-06-15","2020-06-07","2020-08-14","2020-06-20","2020-09-02","2020-06-24","2020-07-28","2020-06-17","2020-08-14","2020-08-14","2020-07-28"],["2020-06-08","2020-06-08","2020-06-08","2020-06-10","2020-06-08","2020-06-08","2020-08-20","2020-06-08","2020-08-20","2020-09-03","2020-08-21","2020-08-20","2020-06-08","2020-06-08","2020-06-08","2020-08-20","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-10","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-06-08","2020-08-27","2020-06-08","2020-09-03","2020-06-08","2020-06-10","2020-06-08","2020-08-27","2020-08-27","2020-06-10"],["CONTACT-2020-0027","CASE-2020-0014","CASE-2020-0031","CASE-2020-0021","CONTACT-2020-0020","CONTACT-2020-0038","CASE-2020-0036","CONTACT-2020-0059","CASE-2020-0037",null,"CASE-2020-0015","CONTACT-2020-0015","CONTACT-2020-0009","CASE-2020-0008",null,"CASE-2020-0010","CONTACT-2020-0018","CONTACT-2020-0029","CONTACT-2020-0045","CONTACT-2020-0019","CONTACT-2020-0007","CASE-2020-0004","CONTACT-2020-0044","CONTACT-2020-0046","CONTACT-2020-0036","CONTACT-2020-0052","CASE-2020-0023","CONTACT-2020-0042","CONTACT-2020-0005","CONTACT-2020-0053","CONTACT-2020-0017","CONTACT-2020-0034","CASE-2020-0012","CASE-2020-0008","CONTACT-2020-0043","CONTACT-2020-0048","CONTACT-2020-0023","CONTACT-2020-0049","CASE-2020-0006","CASE-2020-0018","CONTACT-2020-0003","CASE-2020-0017","CONTACT-2020-0047","CONTACT-2020-0056","CONTACT-2020-0027","CASE-2020-0029","CONTACT-2020-0028","CONTACT-2020-0046","CONTACT-2020-0046","CASE-2020-0027"],["Male","Male","Male","Male","Female","Male","Female","Female","Female","Male","Female","Male","Male","Male",null,"Female","Male","Male","Female","Male","Female","Male","Male","Male","Female","Male","Female","Male","Male","Male","Female","Female","Female","Male","Male","Male","Male","Female","Male","Male","Male","Male","Male","Male","Male","Male","Female","Male","Male","Male"],[15,54,20,46,32,7,40,97,80,0,38,56,18,7,null,37,78,null,32,20,29,43,null,81,45,null,43,15,3,3,35,54,80,7,47,7,23,null,47,25,12,8,67,54,15,46,null,81,81,38],["Direct physical contact ",null,null,null,"Indirect contact (touched contaminated surface/materials/fomites etc.)","Direct non-physical contact (within 1 meter) ",null,"Direct physical contact ",null,"Direct physical contact ","Direct non-physical contact (within 1 meter) ","Direct non-physical contact (within 1 meter) ","Direct non-physical contact (within 1 meter) ","Direct physical contact ",null,"Direct non-physical contact (within 1 meter) ","Indirect contact (touched contaminated surface/materials/fomites etc.)","Indirect contact (touched contaminated surface/materials/fomites etc.)","Direct physical contact ","Direct non-physical contact (within 1 meter) ",null,"Direct physical contact ","Indirect contact (touched contaminated surface/materials/fomites etc.)","Direct physical contact ","Direct physical contact ","Direct non-physical contact (within 1 meter) ",null,"Direct physical contact ",null,"Direct physical contact ","Indirect contact (touched contaminated surface/materials/fomites etc.)","Direct non-physical contact (within 1 meter) ",null,"Direct physical contact ","Direct non-physical contact (within 1 meter) ","Direct non-physical contact (within 1 meter) ","Direct physical contact ","Direct physical contact ",null,null,null,null,"Indirect contact (touched contaminated surface/materials/fomites etc.)","Direct physical contact ","Direct physical contact ",null,"Direct physical contact ",null,null,null]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>source_visualid<\/th>\n      <th>source_gender<\/th>\n      <th>source_age<\/th>\n      <th>date_of_last_contact<\/th>\n      <th>date_of_data_entry<\/th>\n      <th>target_visualid<\/th>\n      <th>target_gender<\/th>\n      <th>target_age<\/th>\n      <th>exposure_type<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[2,7]}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script><p>Como feito anteriormente para a pirâmide etária comparando casos e contatos, podemos selecionar as poucas variáveis necessárias e criar colunas com faixas etárias categóricas, tanto para fontes (casos) quanto para alvos (contatos).</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">heatmap_ages</span> <span class="op">&lt;-</span> <span class="va">relationships</span> <span class="op">%&gt;%</span> 
  <span class="fu">select</span><span class="op">(</span><span class="va">source_age</span>, <span class="va">target_age</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>   <span class="co"># a função transmute é como a função mutate(), mas remove todas as outras colunas</span>
    source_age_class <span class="op">=</span> <span class="fu">epikit</span><span class="fu">::</span><span class="fu"><a href="https://r4epi.github.io/epikit/reference/age_categories.html">age_categories</a></span><span class="op">(</span><span class="va">source_age</span>, breakers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">80</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span>,
    target_age_class <span class="op">=</span> <span class="fu">epikit</span><span class="fu">::</span><span class="fu"><a href="https://r4epi.github.io/epikit/reference/age_categories.html">age_categories</a></span><span class="op">(</span><span class="va">target_age</span>, breakers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">80</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<p>Como descrito anteriormente, criamos uma tabulação cruzada;</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cross_tab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span>
  source_cases <span class="op">=</span> <span class="va">heatmap_ages</span><span class="op">$</span><span class="va">source_age_class</span>,
  target_cases <span class="op">=</span> <span class="va">heatmap_ages</span><span class="op">$</span><span class="va">target_age_class</span><span class="op">)</span>

<span class="va">cross_tab</span></code></pre></div>
<pre><code>##             target_cases
## source_cases 0-4 5-9 10-14 15-19 20-24 25-29 30-34 35-39 40-44 45-49
##        0-4     0   0     0     0     0     0     0     0     0     1
##        5-9     0   0     1     0     0     0     0     1     0     0
##        10-14   0   0     0     0     0     0     0     0     0     0
##        15-19   0   0     0     0     0     0     0     0     0     0
##        20-24   1   1     0     1     2     0     2     1     0     0
##        25-29   1   2     0     0     0     0     0     0     0     0
##        30-34   0   0     0     0     0     0     0     0     1     1
##        35-39   0   2     0     0     0     0     0     0     0     1
##        40-44   0   0     0     0     1     0     2     1     0     3
##        45-49   1   2     2     0     0     0     3     0     1     0
##        50-54   1   2     1     2     0     0     1     0     0     3
##        55-59   0   1     0     0     1     1     2     0     0     0
##        60-64   0   0     0     0     0     0     0     0     0     0
##        65-69   0   0     0     0     0     0     0     0     0     0
##        70-74   0   0     0     0     0     0     0     0     0     0
##        75-79   0   0     0     0     0     0     0     0     0     0
##        80+     1   0     0     2     1     0     0     0     1     0
##             target_cases
## source_cases 50-54 55-59 60-64 65-69 70-74 75-79 80+
##        0-4       0     1     0     0     0     0   0
##        5-9       0     1     0     0     0     0   0
##        10-14     0     0     0     0     0     0   0
##        15-19     0     0     0     0     0     0   0
##        20-24     0     1     0     0     0     0   1
##        25-29     0     0     0     0     0     0   0
##        30-34     0     1     0     0     0     0   0
##        35-39     0     0     0     0     0     0   0
##        40-44     1     1     0     0     0     1   1
##        45-49     3     2     1     0     0     0   1
##        50-54     4     1     0     1     0     0   1
##        55-59     0     0     0     0     0     0   0
##        60-64     0     0     0     0     0     0   0
##        65-69     0     0     0     0     0     0   0
##        70-74     0     0     0     0     0     0   0
##        75-79     0     0     0     0     0     0   0
##        80+       0     0     0     0     0     0   0</code></pre>
<p>converter em formato longo com proporções;</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">long_prop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="va">cross_tab</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>e criar um gráfico de calor para a idade.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">long_prop</span><span class="op">)</span><span class="op">+</span>       <span class="co"># usar dados longos, com proporção como Freq</span>
  <span class="fu">geom_tile</span><span class="op">(</span>                    <span class="co"># visualizar quadrantes</span>
    <span class="fu">aes</span><span class="op">(</span>
      x <span class="op">=</span> <span class="va">target_cases</span>,         <span class="co"># eixo X é a idade do Alvo</span>
      y <span class="op">=</span> <span class="va">source_cases</span>,         <span class="co"># eixo Y é a idade da Fonte</span>
      fill <span class="op">=</span> <span class="va">Freq</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>            <span class="co"># cor dos quadrantes é de acordo com a coluna Freq da base de dados</span>
  <span class="fu">scale_fill_gradient</span><span class="op">(</span>          <span class="co"># ajustar a cor de enchimento das quadrantes</span>
    low <span class="op">=</span> <span class="st">"blue"</span>,
    high <span class="op">=</span> <span class="st">"orange"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>                         <span class="co"># rótulos</span>
    x <span class="op">=</span> <span class="st">"Target case age"</span>,
    y <span class="op">=</span> <span class="st">"Source case age"</span>,
    title <span class="op">=</span> <span class="st">"Who infected whom"</span>,
    subtitle <span class="op">=</span> <span class="st">"Frequency matrix of transmission events"</span>,
    fill <span class="op">=</span> <span class="st">"Proportion of all\ntranmsission events"</span>     <span class="co"># título da legenda</span>
  <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-39-1.png" width="672"></div>
</div>
<div id="fontes" class="section level2" number="1.6">
<h2>
<span class="header-section-number">1.6</span> Fontes<a class="anchor" aria-label="anchor" href="#fontes"><i class="fas fa-link"></i></a>
</h2>
<p><a href="https://github.com/WorldHealthOrganization/godata/tree/master/analytics/r-reporting" class="uri">https://github.com/WorldHealthOrganization/godata/tree/master/analytics/r-reporting</a></p>
<p><a href="https://worldhealthorganization.github.io/godata/" class="uri">https://worldhealthorganization.github.io/godata/</a></p>
<p><a href="https://community-godata.who.int/" class="uri">https://community-godata.who.int/</a></p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="index.html"></a></div>
<div class="empty"></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#rastreio-de-contatos"><span class="header-section-number">1</span> Rastreio de contatos</a></li>
<li>
<a class="nav-link" href="#prepara%C3%A7%C3%A3o"><span class="header-section-number">1.1</span> Preparação</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#carregar-pacotes">Carregar pacotes</a></li>
<li><a class="nav-link" href="#importa%C3%A7%C3%A3o-de-dados">Importação de dados</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#an%C3%A1lises-descritivas"><span class="header-section-number">1.2</span> Análises descritivas</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#demogr%C3%A1ficos">Demográficos</a></li>
<li><a class="nav-link" href="#contatos-por-caso">Contatos por caso</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#acompanhamento-de-contato"><span class="header-section-number">1.3</span> Acompanhamento de contato</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#limpeza-do-dados">Limpeza do dados</a></li>
<li><a class="nav-link" href="#gr%C3%A1fico-ao-longo-do-tempo">Gráfico ao longo do tempo</a></li>
<li><a class="nav-link" href="#rastreamento-individual-di%C3%A1rio">Rastreamento individual diário</a></li>
<li><a class="nav-link" href="#an%C3%A1lises-por-grupo">Análises por grupo</a></li>
</ul>
</li>
<li><a class="nav-link" href="#tabelas-kpi"><span class="header-section-number">1.4</span> Tabelas KPI</a></li>
<li><a class="nav-link" href="#matrizes-de-transmiss%C3%A3o"><span class="header-section-number">1.5</span> Matrizes de transmissão</a></li>
<li><a class="nav-link" href="#fontes"><span class="header-section-number">1.6</span> Fontes</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Manual de R para Epidemiologistas</strong>" was written by the handbook team. It was last built on 2022-06-18.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
