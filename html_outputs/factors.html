<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>11 Fatores | Manual de R para Epidemiologistas</title>
<meta name="author" content="the handbook team">
<meta name="description" content="No R, os fatores são uma classe de dados que permitem categorias ordenadas com um conjunto fixo de valores possíveis. Normalmente, você converteria uma coluna de caractere ou classe numérica em um...">
<meta name="generator" content="bookdown 0.35 with bs4_book()">
<meta property="og:title" content="11 Fatores | Manual de R para Epidemiologistas">
<meta property="og:type" content="book">
<meta property="og:description" content="No R, os fatores são uma classe de dados que permitem categorias ordenadas com um conjunto fixo de valores possíveis. Normalmente, você converteria uma coluna de caractere ou classe numérica em um...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="11 Fatores | Manual de R para Epidemiologistas">
<meta name="twitter:description" content="No R, os fatores são uma classe de dados que permitem categorias ordenadas com um conjunto fixo de valores possíveis. Normalmente, você converteria uma coluna de caractere ou classe numérica em um...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.5.1/transition.js"></script><script src="libs/bs3compat-0.5.1/tabs.js"></script><script src="libs/bs3compat-0.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.29/datatables.js"></script><link href="libs/dt-core-1.13.4/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.13.4/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.13.4/js/jquery.dataTables.min.js"></script><link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script><link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="libs/selectize-0.12.0/selectize.min.js"></script><link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="libs/tabwid-1.1.3/tabwid.js"></script><script src="libs/viz-1.8.2/viz.js"></script><link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="libs/grViz-binding-1.0.10/grViz.js"></script><script src="libs/d3-4.5.0/d3.min.js"></script><script src="libs/sankey-1/sankey.js"></script><script src="libs/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script><script src="libs/plotly-binding-4.10.2/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script><link href="libs/vis-9.1.0/vis-network.min.css" rel="stylesheet">
<script src="libs/vis-9.1.0/vis-network.min.js"></script><script src="libs/visNetwork-binding-2.1.2/visNetwork.js"></script><link href="libs/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet">
<script src="libs/plotly-basic-2.11.1/plotly-basic-2.11.1.min.js"></script><script src="libs/plotly-cartesian-2.11.1/plotly-cartesian-2.11.1.min.js"></script><script src="libs/proj4js-2.3.15/proj4.js"></script><link href="libs/highcharts-9.3.1/css/motion.css" rel="stylesheet">
<script src="libs/highcharts-9.3.1/highcharts.js"></script><script src="libs/highcharts-9.3.1/highcharts-3d.js"></script><script src="libs/highcharts-9.3.1/highcharts-more.js"></script><script src="libs/highcharts-9.3.1/modules/stock.js"></script><script src="libs/highcharts-9.3.1/modules/map.js"></script><script src="libs/highcharts-9.3.1/modules/data.js"></script><script src="libs/highcharts-9.3.1/modules/exporting.js"></script><script src="libs/highcharts-9.3.1/modules/offline-exporting.js"></script><script src="libs/highcharts-9.3.1/modules/drilldown.js"></script><script src="libs/highcharts-9.3.1/modules/item-series.js"></script><script src="libs/highcharts-9.3.1/modules/overlapping-datalabels.js"></script><script src="libs/highcharts-9.3.1/modules/annotations.js"></script><script src="libs/highcharts-9.3.1/modules/export-data.js"></script><script src="libs/highcharts-9.3.1/modules/funnel.js"></script><script src="libs/highcharts-9.3.1/modules/heatmap.js"></script><script src="libs/highcharts-9.3.1/modules/treemap.js"></script><script src="libs/highcharts-9.3.1/modules/sankey.js"></script><script src="libs/highcharts-9.3.1/modules/dependency-wheel.js"></script><script src="libs/highcharts-9.3.1/modules/organization.js"></script><script src="libs/highcharts-9.3.1/modules/solid-gauge.js"></script><script src="libs/highcharts-9.3.1/modules/streamgraph.js"></script><script src="libs/highcharts-9.3.1/modules/sunburst.js"></script><script src="libs/highcharts-9.3.1/modules/vector.js"></script><script src="libs/highcharts-9.3.1/modules/wordcloud.js"></script><script src="libs/highcharts-9.3.1/modules/xrange.js"></script><script src="libs/highcharts-9.3.1/modules/tilemap.js"></script><script src="libs/highcharts-9.3.1/modules/venn.js"></script><script src="libs/highcharts-9.3.1/modules/gantt.js"></script><script src="libs/highcharts-9.3.1/modules/timeline.js"></script><script src="libs/highcharts-9.3.1/modules/parallel-coordinates.js"></script><script src="libs/highcharts-9.3.1/modules/bullet.js"></script><script src="libs/highcharts-9.3.1/modules/coloraxis.js"></script><script src="libs/highcharts-9.3.1/modules/dumbbell.js"></script><script src="libs/highcharts-9.3.1/modules/lollipop.js"></script><script src="libs/highcharts-9.3.1/modules/series-label.js"></script><script src="libs/highcharts-9.3.1/plugins/motion.js"></script><script src="libs/highcharts-9.3.1/custom/reset.js"></script><script src="libs/highcharts-9.3.1/modules/boost.js"></script><script src="libs/highchart-binding-0.9.4/highchart.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-QXDW878QLX"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-QXDW878QLX');
    </script>
</head>
<body>
<p>

    Você precisa de ajuda para aprender R? Inscreva-se no curso de introdução ao R da Applied Epi, experimente nossos tutoriais gratuitos sobre o R, publique em nosso fórum de perguntas e respostas ou solicite nosso suporte ao R.

    </p>
<div class="alert alert-info alert-dismissible">
      <a href="#" class="close" data-dismiss="alert" aria-label="close">×</a>
      <strong>Você precisa de ajuda para aprender R?</strong> Inscreva-se no curso de <a href="https://www.appliedepi.org/live/" class="alert-link">introdução ao R</a> da Applied Epi, experimente nossos <a href="https://www.appliedepi.org/tutorial/" class="alert-link">tutoriais gratuitos sobre o R</a>, publique em nosso <a href="https://community.appliedepi.org/" class="alert-link">fórum de perguntas e respostas</a>, ou solicite nosso <a href="mailto:contact@appliedepi.org" class="alert-link">suporte ao R</a>.
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style_bs4.css">
<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Manual de R para Epidemiologistas</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"></a></li>
<li class="book-part">Sobre este livro</li>
<li><a class="" href="editorial-style.html"><span class="header-section-number">1</span> Notas editoriais e técnicas</a></li>
<li><a class="" href="data-used.html"><span class="header-section-number">2</span> Baixe o livro e os dados</a></li>
<li class="book-part">Básico</li>
<li><a class="" href="basics.html"><span class="header-section-number">3</span> Introdução ao R</a></li>
<li><a class="" href="transition-to-R.html"><span class="header-section-number">4</span> Transição para o R</a></li>
<li><a class="" href="packages-suggested.html"><span class="header-section-number">5</span> Pacotes sugeridos</a></li>
<li><a class="" href="r-projects.html"><span class="header-section-number">6</span> R projects</a></li>
<li><a class="" href="importing.html"><span class="header-section-number">7</span> Importar e exportar</a></li>
<li class="book-part">Gerenciamento dos Dados</li>
<li><a class="" href="cleaning.html"><span class="header-section-number">8</span> Limpeza de dados e principais funções</a></li>
<li><a class="" href="dates.html"><span class="header-section-number">9</span> Trabalhando com datas</a></li>
<li><a class="" href="characters-strings.html"><span class="header-section-number">10</span> Caracteres e strings</a></li>
<li><a class="active" href="factors.html"><span class="header-section-number">11</span> Fatores</a></li>
<li><a class="" href="pivoting.html"><span class="header-section-number">12</span> Pivoteando dados</a></li>
<li><a class="" href="grouping.html"><span class="header-section-number">13</span> Agrupando dados</a></li>
<li><a class="" href="joining-matching.html"><span class="header-section-number">14</span> Juntando dados (Joins)</a></li>
<li><a class="" href="deduplication.html"><span class="header-section-number">15</span> Eliminação de duplicidades</a></li>
<li><a class="" href="iteration.html"><span class="header-section-number">16</span> Iterações, loops e listas</a></li>
<li class="book-part">Análise dos dados</li>
<li><a class="" href="tables-descriptive.html"><span class="header-section-number">17</span> Tabelas descritivas</a></li>
<li><a class="" href="stat-tests.html"><span class="header-section-number">18</span> Testes estatísticos simples</a></li>
<li><a class="" href="regression.html"><span class="header-section-number">19</span> Regressão simples e múltipla</a></li>
<li><a class="" href="missing-data.html"><span class="header-section-number">20</span> Campos em branco/faltantes</a></li>
<li><a class="" href="standardization.html"><span class="header-section-number">21</span> Normalização de taxas</a></li>
<li><a class="" href="moving-average.html"><span class="header-section-number">22</span> Médias móveis</a></li>
<li><a class="" href="epidemic-models.html"><span class="header-section-number">23</span> Modelagem de epidemias</a></li>
<li><a class="" href="contact-tracing.html"><span class="header-section-number">24</span> Rastreamento de contatos</a></li>
<li><a class="" href="survey-analysis.html"><span class="header-section-number">25</span> Analises de pesquisa de questionários (survey)</a></li>
<li><a class="" href="survival-analysis.html"><span class="header-section-number">26</span> Análise de sobrevivência</a></li>
<li class="book-part">Visualização de Dados</li>
<li><a class="" href="tables-presentation.html"><span class="header-section-number">27</span> Tabelas para apresentação</a></li>
<li><a class="" href="ggplot-basics.html"><span class="header-section-number">28</span> O básico do ggplot</a></li>
<li><a class="" href="ggplot-tips.html"><span class="header-section-number">29</span> Dicas do ggplot</a></li>
<li><a class="" href="epicurves.html"><span class="header-section-number">30</span> Curvas epidêmicas</a></li>
<li><a class="" href="age-pyramid.html"><span class="header-section-number">31</span> Pirâmides demográficas e escalas Likert</a></li>
<li><a class="" href="heatmaps.html"><span class="header-section-number">32</span> Gráficos de calor</a></li>
<li><a class="" href="diagrams.html"><span class="header-section-number">33</span> Diagramas e gráficos</a></li>
<li><a class="" href="combination-analysis.html"><span class="header-section-number">34</span> Análise de Combinações</a></li>
<li><a class="" href="transmission-chains.html"><span class="header-section-number">35</span> Cadeias de Transmissão</a></li>
<li><a class="" href="phylogenetic-trees.html"><span class="header-section-number">36</span> Árvores filogenéticas</a></li>
<li><a class="" href="interactive-plots.html"><span class="header-section-number">37</span> Gráficos interativos</a></li>
<li class="book-part">Relatórios e dashboards</li>
<li><a class="" href="rmarkdown.html"><span class="header-section-number">38</span> Relatórios com R Markdown</a></li>
<li><a class="" href="reportfactory.html"><span class="header-section-number">39</span> Organização de relatórios de rotina</a></li>
<li><a class="" href="flexdashboard.html"><span class="header-section-number">40</span> Painéis (Dashboards) com R Markdown</a></li>
<li><a class="" href="shiny-basics.html"><span class="header-section-number">41</span> Painéis com Shiny</a></li>
<li class="book-part">Miscelânea</li>
<li><a class="" href="writing-functions.html"><span class="header-section-number">42</span> Escrevendo funções</a></li>
<li><a class="" href="directories.html"><span class="header-section-number">43</span> Interações de diretório</a></li>
<li><a class="" href="collaboration.html"><span class="header-section-number">44</span> Controle de versão e colaboração com Git e Github</a></li>
<li><a class="" href="errors.html"><span class="header-section-number">45</span> Erros comuns</a></li>
<li><a class="" href="help.html"><span class="header-section-number">46</span> Conseguindo ajuda</a></li>
<li><a class="" href="network-drives.html"><span class="header-section-number">47</span> R em drives (pastas) na rede</a></li>
<li><a class="" href="data-table.html"><span class="header-section-number">48</span> Data Table</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="factors" class="section level1" number="11">
<h1>
<span class="header-section-number">11</span> Fatores<a class="anchor" aria-label="anchor" href="#factors"><i class="fas fa-link"></i></a>
</h1>
<div class="inline-figure"><img src="images/Factors_1500x500.png" width="100%"></div>
<p>No R, os <em>fatores</em> são uma classe de dados que permitem categorias ordenadas com um conjunto fixo de valores possíveis.</p>
<p>Normalmente, você converteria uma coluna de caractere ou classe numérica em um fator se quiser definir uma ordem intrínseca para os valores (“níveis”) para que eles possam ser exibidos de forma não alfabética em gráficos e tabelas. Outro uso comum de fatores é padronizar as legendas dos gráficos para que não flutuem se certos valores estiverem temporariamente ausentes dos dados.</p>
<p>Esta página demonstra o uso de funções do pacote <strong>forcats</strong> (um nome curto para “<strong>For</strong> <strong>cat</strong>egorical variables” - “para variáveis categóricas”) e algumas funções do R <strong>base</strong>. Também abordamos o uso de <strong>lubridate</strong> e <strong>aweek</strong> para casos de fatores especiais relacionados a semanas epidemiológicas (epiweeks).</p>
<p>Uma lista completa das funções do <strong>forcats</strong> pode ser encontrada online <a href="https://forcats.tidyverse.org/reference/index.html">aqui</a>. Abaixo, demonstramos alguns dos mais comuns.</p>
<!-- ======================================================= -->
<div id="preparação-2" class="section level2" number="11.1">
<h2>
<span class="header-section-number">11.1</span> Preparação<a class="anchor" aria-label="anchor" href="#prepara%C3%A7%C3%A3o-2"><i class="fas fa-link"></i></a>
</h2>
<div id="carregar-pacotes-1" class="section level3 unnumbered">
<h3>Carregar pacotes<a class="anchor" aria-label="anchor" href="#carregar-pacotes-1"><i class="fas fa-link"></i></a>
</h3>
<p>Este trecho de código mostra o carregamento de pacotes necessários para as análises. Neste manual, enfatizamos o <code><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load()</a></code> do <strong>pacman</strong>, o qual instala o pacote se necessário <em>e</em> o carrega para uso. Você também pode carregar pacotes instalados com <code><a href="https://rdrr.io/r/base/library.html">library()</a></code> do R <strong>base</strong>. Veja a pagina em <a href="basics.html#basics">Introdução ao R</a> para mais informações sobre pacotes R.</p>
<div class="sourceCode" id="cb535"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span></span>
<span>  <span class="va">rio</span>,           <span class="co"># importar/exportar</span></span>
<span>  <span class="va">here</span>,          <span class="co"># diretório</span></span>
<span>  <span class="va">lubridate</span>,     <span class="co"># trabalhando com datas</span></span>
<span>  <span class="va">forcats</span>,       <span class="co"># fatores</span></span>
<span>  <span class="va">aweek</span>,         <span class="co"># criar epiweeks com níveis de fatores automático</span></span>
<span>  <span class="va">janitor</span>,       <span class="co"># tabelas</span></span>
<span>  <span class="va">tidyverse</span>      <span class="co"># dados mgmt e viz</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div id="importe-os-dados" class="section level3 unnumbered">
<h3>Importe os dados<a class="anchor" aria-label="anchor" href="#importe-os-dados"><i class="fas fa-link"></i></a>
</h3>
<p>Importamos o conjunto de dados de casos de uma simulação de epidemia de Ebola. Se você quiser acompanhar, <a href="https://github.com/appliedepi/epirhandbook_eng/raw/master/data/case_linelists/linelist_cleaned.rds" class="download-button">clique para baixar o “clean” linelist</a> (as .rds file). Importe seus dados com a função <code><a href="https://rdrr.io/pkg/rio/man/import.html">import()</a></code> do pacote <strong>rio</strong> package (o pacote aceita muitos tipos de arquivo como .xlsx, .rds, .csv - veja a página <a href="importing.html#importing">Importar e exportar</a> para detalhes).</p>
<div class="sourceCode" id="cb536"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># importar seu conjunto de dados</span></span>
<span><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="st">"linelist_cleaned.rds"</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="fct_newcat" class="section level3 unnumbered">
<h3>Nova variável categórica<a class="anchor" aria-label="anchor" href="#fct_newcat"><i class="fas fa-link"></i></a>
</h3>
<p>Para demonstração nesta página, usaremos um cenário comum - a criação de uma nova variável categórica.</p>
<p>Observe que se você converter uma coluna numérica em fator, não será capaz de calcular estatísticas numéricas sobre ela.</p>
<div id="criar-coluna" class="section level4 unnumbered">
<h4>Criar coluna<a class="anchor" aria-label="anchor" href="#criar-coluna"><i class="fas fa-link"></i></a>
</h4>
<p>Usamos a coluna existente <code>days_onset_hosp</code> (dias desde o início dos sintomas até a admissão hospitalar) e criamos uma nova coluna <code>delay_cat</code> classificando cada linha em uma das várias categorias. Nós fazemos isso com a função do <strong>dplyr</strong> <code><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when()</a></code>, que aplica critérios lógicos sequencialmente (lado direito) a cada linha e retorna o valor do lado esquerdo correspondente para a nova coluna <code>delay_cat</code>. Leia mais sobre <code><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when()</a></code> em <a href="cleaning.html#cleaning">Limpeza de dados e principais funções</a>.</p>
<div class="sourceCode" id="cb537"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>delay_cat <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>    <span class="co"># critério                                  # novo valor se TRUE</span></span>
<span>    <span class="va">days_onset_hosp</span> <span class="op">&lt;</span> <span class="fl">2</span>                        <span class="op">~</span> <span class="st">"&lt;2 dias"</span>,</span>
<span>    <span class="va">days_onset_hosp</span> <span class="op">&gt;=</span> <span class="fl">2</span> <span class="op">&amp;</span> <span class="va">days_onset_hosp</span> <span class="op">&lt;</span> <span class="fl">5</span> <span class="op">~</span> <span class="st">"2-5 dias"</span>,</span>
<span>    <span class="va">days_onset_hosp</span> <span class="op">&gt;=</span> <span class="fl">5</span>                       <span class="op">~</span> <span class="st">"&gt;5 dias"</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">days_onset_hosp</span><span class="op">)</span>                     <span class="op">~</span> <span class="cn">NA_character_</span>,</span>
<span>    <span class="cn">TRUE</span>                                       <span class="op">~</span> <span class="st">"Verifique"</span><span class="op">)</span><span class="op">)</span>  </span></code></pre></div>
</div>
<div id="padrão-da-ordem-dos-valores" class="section level4 unnumbered">
<h4>Padrão da ordem dos valores<a class="anchor" aria-label="anchor" href="#padr%C3%A3o-da-ordem-dos-valores"><i class="fas fa-link"></i></a>
</h4>
<p>Conforme criado com <code><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when()</a></code>, a nova coluna <code>delay_cat</code> é uma coluna categórica da classe Caractere - <em>ainda não</em> é um fator. Assim, em uma tabela de frequência, vemos que os valores exclusivos aparecem por padrão em uma ordem alfanumérica - uma ordem que não faz muito sentido intuitivo:</p>
<div class="sourceCode" id="cb538"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">delay_cat</span>, useNA <span class="op">=</span> <span class="st">"always"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  &lt;2 dias  &gt;5 dias 2-5 dias     &lt;NA&gt; 
##     2990      602     2040      256</code></pre>
<p>Da mesma forma, se fizermos um gráfico de barra, os valores também aparecem nesta ordem no eixo x (consulte a página <a href="ggplot-basics.html#ggplot-basics">O básico o ggplot</a> para mais informações sobre o <strong>ggplot2</strong> - o pacote de visualização mais comum no R).</p>
<div class="sourceCode" id="cb540"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">linelist</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">delay_cat</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-379-1.png" width="672"></div>
</div>
</div>
</div>
<div id="converter-para-fator" class="section level2" number="11.2">
<h2>
<span class="header-section-number">11.2</span> Converter para fator<a class="anchor" aria-label="anchor" href="#converter-para-fator"><i class="fas fa-link"></i></a>
</h2>
<p>Para converter um caractere ou coluna numérica para classe <em>fator</em>, você pode usar qualquer função do pacote <strong>forcats</strong> (muitos são detalhados <a href="factors.html#fct_adjust">abaixo</a>). Eles serão convertidos para fator e, em seguida, também realizarão ou permitirão certa ordenação dos níveis - por exemplo, usar <code><a href="https://forcats.tidyverse.org/reference/fct_relevel.html">fct_relevel()</a></code> permite que você especifique manualmente a ordem dos níveis. A função <code><a href="https://forcats.tidyverse.org/reference/as_factor.html">as_factor()</a></code> simplesmente converte a classe sem quaisquer recursos adicionais.</p>
<p>A função do R <strong>base</strong> <code><a href="https://rdrr.io/r/base/factor.html">factor()</a></code> converte uma coluna em fator e permite que você especifique manualmente a ordem dos níveis, como um vetor de caracteres para seu argumento <code>levels =</code>.</p>
<p>Abaixo usamos <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> e <code><a href="https://forcats.tidyverse.org/reference/fct_relevel.html">fct_relevel()</a></code> para converter a coluna <code>delay_cat</code> de classe caractere para classe fator. A coluna <code>delay_cat</code> é criada na seção <a href="factors.html#fct_newcat">Preparação</a> acima.</p>
<div class="sourceCode" id="cb541"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>delay_cat <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_relevel.html">fct_relevel</a></span><span class="op">(</span><span class="va">delay_cat</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><em>Os “valores” únicos nesta coluna são agora considerados “níveis” do fator.</em> Os níveis têm uma <em>ordem</em>, que pode ser exibida com a função do R <strong>base</strong> <code><a href="https://rdrr.io/r/base/levels.html">levels()</a></code>, ou, alternativamente, visualizada em uma tabela de contagem via <code><a href="https://rdrr.io/r/base/table.html">table()</a></code> do R <strong>base</strong> ou <code>tabyl()</code> do <strong>janitor</strong>. Por padrão, a ordem dos níveis será alfanumérica, como antes. Observe que <code>NA</code> não é um nível de fator.</p>
<div class="sourceCode" id="cb542"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">delay_cat</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "&lt;2 dias"  "&gt;5 dias"  "2-5 dias"</code></pre>
<p>A função <code><a href="https://forcats.tidyverse.org/reference/fct_relevel.html">fct_relevel()</a></code> tem a utilidade adicional de permitir que você especifique manualmente a ordem dos níveis. Basta escrever os valores dos níveis em ordem, entre aspas, separados por vírgulas, conforme mostrado abaixo. Observe que a grafia deve corresponder exatamente aos valores. Se você quiser criar níveis que não existem nos dados, use <a href="factors.html#fct_add"><code>fct_expand()</code> ao invés</a>).</p>
<div class="sourceCode" id="cb544"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>delay_cat <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_relevel.html">fct_relevel</a></span><span class="op">(</span><span class="va">delay_cat</span>, <span class="st">"&lt;2 days"</span>, <span class="st">"2-5 days"</span>, <span class="st">"&gt;5 days"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `mutate()`.
## ℹ In argument: `delay_cat = fct_relevel(delay_cat, "&lt;2 days", "2-5 days", "&gt;5
##   days")`.
## Caused by warning:
## ! 3 unknown levels in `f`: &lt;2 days, 2-5 days, and &gt;5 days</code></pre>
<p>Agora podemos ver que os níveis estão ordenados, conforme especificado no comando anterior, em uma ordem sensata.</p>
<div class="sourceCode" id="cb546"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">delay_cat</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "&lt;2 dias"  "&gt;5 dias"  "2-5 dias"</code></pre>
<p>Agora, a ordem do gráfico também faz um sentido mais intuitivo.</p>
<div class="sourceCode" id="cb548"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">linelist</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">delay_cat</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-384-1.png" width="672"></div>
</div>
<div id="adicionar-ou-remover-níveis" class="section level2" number="11.3">
<h2>
<span class="header-section-number">11.3</span> Adicionar ou remover níveis<a class="anchor" aria-label="anchor" href="#adicionar-ou-remover-n%C3%ADveis"><i class="fas fa-link"></i></a>
</h2>
<div id="fct_add" class="section level3 unnumbered">
<h3>Adicionar<a class="anchor" aria-label="anchor" href="#fct_add"><i class="fas fa-link"></i></a>
</h3>
<p>Se você precisar adicionar níveis a um fator, você pode fazer isso com <code><a href="https://forcats.tidyverse.org/reference/fct_expand.html">fct_expand()</a></code>. Basta escrever o nome da coluna seguido pelos novos níveis (separados por vírgulas). Tabulando os valores, podemos ver os novos níveis e as contagens zero. Você pode usar <code><a href="https://rdrr.io/r/base/table.html">table()</a></code> do R <strong>base</strong>, ou <code>tabyl()</code> do <strong>janitor</strong>:</p>
<div class="sourceCode" id="cb549"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>delay_cat <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_expand.html">fct_expand</a></span><span class="op">(</span><span class="va">delay_cat</span>, <span class="st">"Not admitted to hospital"</span>, <span class="st">"Transfer to other jurisdiction"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">tabyl</span><span class="op">(</span><span class="va">delay_cat</span><span class="op">)</span>   <span class="co"># print table</span></span></code></pre></div>
<pre><code>##                       delay_cat    n    percent valid_percent
##                         &lt;2 dias 2990 0.50781250     0.5308949
##                         &gt;5 dias  602 0.10224185     0.1068892
##                        2-5 dias 2040 0.34646739     0.3622159
##        Not admitted to hospital    0 0.00000000     0.0000000
##  Transfer to other jurisdiction    0 0.00000000     0.0000000
##                            &lt;NA&gt;  256 0.04347826            NA</code></pre>
<p>Nota: há uma função especial no <strong>forcats</strong> para adicionar facilmente valores ausentes (<code>NA</code>) como um nível. Consulte a seção abaixo sobre <a href="factors.html#fct_missing">Valores ausentes</a>.</p>
</div>
<div id="remover" class="section level3 unnumbered">
<h3>Remover<a class="anchor" aria-label="anchor" href="#remover"><i class="fas fa-link"></i></a>
</h3>
<p>Se você usar <code><a href="https://forcats.tidyverse.org/reference/fct_drop.html">fct_drop()</a></code>, os níveis “não usados” com contagem zero serão retirados do conjunto de níveis. Os níveis que adicionamos acima (“Not admitted to a hospital” - Não admitido em um hospital) existem como um nível, mas nenhuma linha realmente possui esses valores. Portanto, eles serão eliminados aplicando <code><a href="https://forcats.tidyverse.org/reference/fct_drop.html">fct_drop()</a></code> na nossa coluna de fator:</p>
<div class="sourceCode" id="cb551"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>delay_cat <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_drop.html">fct_drop</a></span><span class="op">(</span><span class="va">delay_cat</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">tabyl</span><span class="op">(</span><span class="va">delay_cat</span><span class="op">)</span></span></code></pre></div>
<pre><code>##  delay_cat    n    percent valid_percent
##    &lt;2 dias 2990 0.50781250     0.5308949
##    &gt;5 dias  602 0.10224185     0.1068892
##   2-5 dias 2040 0.34646739     0.3622159
##       &lt;NA&gt;  256 0.04347826            NA</code></pre>
</div>
</div>
<div id="fct_adjust" class="section level2" number="11.4">
<h2>
<span class="header-section-number">11.4</span> Ajuste a ordem dos níveis<a class="anchor" aria-label="anchor" href="#fct_adjust"><i class="fas fa-link"></i></a>
</h2>
<p>O pacote <strong>forcats</strong> oferece funções úteis para ajustar facilmente a ordem dos níveis de um fator (após uma coluna ser definida como classe fator):</p>
<p>Essas funções podem ser aplicadas a uma coluna de fator em dois contextos:</p>
<ol style="list-style-type: decimal">
<li>Para a coluna no data frame, como de costume, para que a transformação esteja disponível para qualquer uso subsequente dos dados<br>
</li>
<li>
<em>Dentro de um gráfico,</em> de modo que a alteração seja aplicada apenas dentro do gráfico</li>
</ol>
<div id="manualmente" class="section level3 unnumbered">
<h3>Manualmente<a class="anchor" aria-label="anchor" href="#manualmente"><i class="fas fa-link"></i></a>
</h3>
<p>Esta função é usada para ordenar manualmente os níveis dos fatores. Se usada em uma coluna sem fator, a coluna será primeiro convertida para classe fator.</p>
<p>Entre parênteses, primeiro forneça o nome da coluna do fator e, em seguida, forneça:</p>
<ul>
<li>Todos os níveis na ordem desejada (como um vetor de caracteres <code><a href="https://rdrr.io/r/base/c.html">c()</a></code>), ou<br>
</li>
<li>Um nível e seu posicionamento corrigido usando o argumento <code>after =</code>
</li>
</ul>
<p>Aqui está um exemplo de redefinição da coluna <code>delay_cat</code> (que já é da classe Factor) e especificando toda a ordem de níveis desejada.</p>
<div class="sourceCode" id="cb553"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># redefine a ordem dos níveis dos fatores</span></span>
<span><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>delay_cat <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_relevel.html">fct_relevel</a></span><span class="op">(</span><span class="va">delay_cat</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"&lt;2 days"</span>, <span class="st">"2-5 days"</span>, <span class="st">"&gt;5 days"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `mutate()`.
## ℹ In argument: `delay_cat = fct_relevel(delay_cat, c("&lt;2 days", "2-5 days", "&gt;5
##   days"))`.
## Caused by warning:
## ! 3 unknown levels in `f`: &lt;2 days, 2-5 days, and &gt;5 days</code></pre>
<p>Se você quiser mover apenas um nível, você pode especificá-lo sozinha para <code><a href="https://forcats.tidyverse.org/reference/fct_relevel.html">fct_relevel()</a></code> e dar um número ao argumento <code>after =</code> para indicar onde na ordem ele deveria estar. Por exemplo, o comando abaixo muda “&lt;2 dias” para a segunda posição:</p>
<div class="sourceCode" id="cb555"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># redefinir a ordem dos níveis</span></span>
<span><span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>delay_cat <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_relevel.html">fct_relevel</a></span><span class="op">(</span><span class="va">delay_cat</span>, <span class="st">"&lt;2 days"</span>, after <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">tabyl</span><span class="op">(</span><span class="va">delay_cat</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="dentro-de-um-gráfico" class="section level3 unnumbered">
<h3>Dentro de um gráfico<a class="anchor" aria-label="anchor" href="#dentro-de-um-gr%C3%A1fico"><i class="fas fa-link"></i></a>
</h3>
<p>Os comandos do <strong>forcats</strong> podem ser usados para definir a ordem dos níveis no data frame ou apenas dentro de um gráfico. Usando o comando para “envolver” o nome da coluna <em>dentro</em> do comando de plotagem <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> você pode reverter / reordenar / etc, assim, a transformação só se aplicará a esse gráfico.</p>
<p>Abaixo, dois gráficos são criados com <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> (consulte a página <a href="ggplot-basics.html#ggplot-basics">O básico o ggplot</a>). No primeiro, a coluna <code>delay_cat</code> é mapeada para o eixo x do gráfico, com sua ordem de nível padrão como nos dados da <code>linelist</code>. No segundo exemplo, ele é inserido em <code><a href="https://forcats.tidyverse.org/reference/fct_relevel.html">fct_relevel()</a></code> e a ordem é alterada no gráfico.</p>
<pre><code>## Warning: There was 1 warning in `mutate()`.
## ℹ In argument: `delay_cat = fct_relevel(delay_cat, c("2-5 days", "&lt;2 days", "&gt;5
##   days"))`.
## Caused by warning:
## ! 3 unknown levels in `f`: 2-5 days, &lt;2 days, and &gt;5 days</code></pre>
<div class="sourceCode" id="cb557"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Ordem alfanumérica padrão - sem ajuste no ggplot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">linelist</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">delay_cat</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ordem dos níveis dos fatores ajustada dentro do ggplot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">linelist</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_relevel.html">fct_relevel</a></span><span class="op">(</span><span class="va">delay_cat</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"&lt;2 days"</span>, <span class="st">"2-5 days"</span>, <span class="st">"&gt;5 days"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-390-1.png" width="50%"><img src="_main_files/figure-html/unnamed-chunk-390-2.png" width="50%"></p>
<p>Observe que o título padrão do eixo x agora é bastante complicado - você pode reescrever este título com o argumento <code><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs()</a></code> do <strong>ggplot2</strong>.</p>
</div>
<div id="inverter" class="section level3 unnumbered">
<h3>Inverter<a class="anchor" aria-label="anchor" href="#inverter"><i class="fas fa-link"></i></a>
</h3>
<p>É bastante comum que você queira inverter a ordem dos níveis. Simplesmente envolva o fator com <code><a href="https://forcats.tidyverse.org/reference/fct_rev.html">fct_rev()</a></code>.</p>
<p>Observe que se você deseja reverter <em>apenas</em> uma legenda do gráfico, mas não os níveis reais dos fatores, pode fazer isso com <code><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides()</a></code> (consulte <a href="ggplot-tips.html#ggplot-tips">Dicas para o ggplot</a>).</p>
</div>
<div id="por-frequência" class="section level3 unnumbered">
<h3>Por frequência<a class="anchor" aria-label="anchor" href="#por-frequ%C3%AAncia"><i class="fas fa-link"></i></a>
</h3>
<p>Para ordenar pela frequência com que o valor aparece nos dados, use <code><a href="https://forcats.tidyverse.org/reference/fct_inorder.html">fct_infreq()</a></code>. Quaisquer valores ausentes (<code>NA</code>) serão incluídos automaticamente no final, a menos que sejam convertidos para um nível explícito (veja <a href="factors.html#fct_missing">essa seção</a>). Você pode inverter a ordem envolvendo em seguida com <code><a href="https://forcats.tidyverse.org/reference/fct_rev.html">fct_rev()</a></code>.</p>
<p>Esta função pode ser usada em um <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>, conforme mostrado abaixo.</p>
<div class="sourceCode" id="cb558"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ordenando por frequência</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">linelist</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_inorder.html">fct_infreq</a></span><span class="op">(</span><span class="va">delay_cat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Delay onset to admission (days)"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Ordered by frequency"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># inverter frequência</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">linelist</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_rev.html">fct_rev</a></span><span class="op">(</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_inorder.html">fct_infreq</a></span><span class="op">(</span><span class="va">delay_cat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Delay onset to admission (days)"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Reverse of order by frequency"</span><span class="op">)</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-391-1.png" width="50%"><img src="_main_files/figure-html/unnamed-chunk-391-2.png" width="50%"></p>
</div>
<div id="pela-aparência" class="section level3 unnumbered">
<h3>Pela aparência<a class="anchor" aria-label="anchor" href="#pela-apar%C3%AAncia"><i class="fas fa-link"></i></a>
</h3>
<p>Use <code><a href="https://forcats.tidyverse.org/reference/fct_inorder.html">fct_inorder()</a></code> para definir a ordem dos níveis para corresponder à ordem de aparecimento nos dados, começando da primeira linha. Isso pode ser útil se você primeiro organizar os dados cuidadosamente por meio do <code><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange()</a></code> no data frame e, em seguida, usar isso para definir a ordem dos fatores.</p>
</div>
<div id="pela-estatística-de-resumo-de-outra-coluna" class="section level3 unnumbered">
<h3>Pela estatística de resumo de outra coluna<a class="anchor" aria-label="anchor" href="#pela-estat%C3%ADstica-de-resumo-de-outra-coluna"><i class="fas fa-link"></i></a>
</h3>
<p>Você pode usar <code><a href="https://forcats.tidyverse.org/reference/fct_reorder.html">fct_reorder()</a></code> para ordenar os níveis de uma coluna <em>por uma estatística de resumo de outra coluna</em>. Visualmente, isso pode resultar em gráficos agradáveis, onde as barras / pontos sobem ou descem de forma constante no gráfico.</p>
<p>Nos exemplos abaixo, o eixo x é <code>delay_cat</code>, e o eixo y é a coluna numérica <code>ct_blood</code> (valor do limite do ciclo). Os gráficos de caixa mostram a distribuição do valor CT por grupo <code>delay_cat</code>. Queremos ordenar os gráficos de caixa em ordem crescente pelo valor de CT mediano do grupo.</p>
<p>No primeiro exemplo abaixo, a ordem padrão de nível alfanumérico é usada. Você pode ver que as alturas do box plot estão confusas e não em uma ordem específica. No segundo exemplo, a coluna <code>delay_cat</code> (mapeada para o eixo x) foi agrupada em <code><a href="https://forcats.tidyverse.org/reference/fct_reorder.html">fct_reorder()</a></code>, a coluna <code>ct_blood</code> é fornecida como o segundo argumento e “median” (mediana) é fornecido como o terceiro argumento (você também pode usar “max”, “mean”, “min”, etc). Portanto, a ordem dos níveis de <code>delay_cat</code> agora refletirá os valores médios de CT crescentes de cada valor de CT médio dos grupos presentes em <code>delay_cat</code>. Isso se reflete no segundo gráfico - os gráficos de caixa foram reorganizados para ascender. Observe como <code>NA</code> (ausente) aparecerá no final, a menos que seja convertido para um nível explícito.</p>
<div class="sourceCode" id="cb559"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># boxplots ordenados para os níveis originais dos fatores</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">linelist</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">delay_cat</span>,</span>
<span>        y <span class="op">=</span> <span class="va">ct_blood</span>, </span>
<span>        fill <span class="op">=</span> <span class="va">delay_cat</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Delay onset to admission (days)"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Ordered by original alpha-numeric levels"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># boxplots ordenados pelo valor médio de CT</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">linelist</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_reorder.html">fct_reorder</a></span><span class="op">(</span><span class="va">delay_cat</span>, <span class="va">ct_blood</span>, <span class="st">"median"</span><span class="op">)</span>,</span>
<span>        y <span class="op">=</span> <span class="va">ct_blood</span>,</span>
<span>        fill <span class="op">=</span> <span class="va">delay_cat</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Delay onset to admission (days)"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Ordered by median CT value in group"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-392-1.png" width="50%"><img src="_main_files/figure-html/unnamed-chunk-392-2.png" width="50%"></p>
<p>Observe que neste exemplo acima não há etapas necessárias antes da função <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> - o agrupamento e os cálculos são todos feitos dentro do comando do ggplot.</p>
</div>
<div id="por-valor-final" class="section level3 unnumbered">
<h3>Por valor “final”<a class="anchor" aria-label="anchor" href="#por-valor-final"><i class="fas fa-link"></i></a>
</h3>
<p>Use <code><a href="https://forcats.tidyverse.org/reference/fct_reorder.html">fct_reorder2()</a></code> para gráficos de linha agrupados. Ele ordena os níveis (e, portanto, a <em>legenda</em>) para alinhar com a ordem vertical das linhas no “final” do gráfico. Tecnicamente falando, ele “ordena pelos valores y associados aos maiores valores x”.</p>
<p>Por exemplo, se você tiver linhas mostrando contagens de casos por hospital ao longo do tempo, você pode aplicar <code><a href="https://forcats.tidyverse.org/reference/fct_reorder.html">fct_reorder2()</a></code> ao argumento <code>color =</code> dentro do <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>, de modo que a ordem vertical dos hospitais que aparecem na legenda se alinhe com a ordem das linhas no extremidade final do gráfico. Leia mais na <a href="https://forcats.tidyverse.org/reference/fct_reorder.html">documentação online</a>.</p>
<div class="sourceCode" id="cb560"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">epidemic_data</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>         <span class="co"># comece com a linelist   </span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">date_onset</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2014-09-21"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>    <span class="co"># limite a data para clareza visual</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span>                                            <span class="co"># obter a contagem dos casos por semana e por hospital</span></span>
<span>      epiweek <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/round_date.html">floor_date</a></span><span class="op">(</span><span class="va">date_onset</span>, <span class="st">"week"</span><span class="op">)</span>,  </span>
<span>      <span class="va">hospital</span>                                            </span>
<span>    <span class="op">)</span> </span>
<span>  </span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">epidemic_data</span><span class="op">)</span><span class="op">+</span>                       <span class="co"># inicie o gráfico</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>                                        <span class="co"># faça as linhas </span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">epiweek</span>,                                  <span class="co"># eixo-x epiweek</span></span>
<span>      y <span class="op">=</span> <span class="va">n</span>,                                        <span class="co"># altura é o número de casos por semana</span></span>
<span>      color <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_reorder.html">fct_reorder2</a></span><span class="op">(</span><span class="va">hospital</span>, <span class="va">epiweek</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span> <span class="co"># dados agrupados e coloridos por hospital, com fator de ordem por altura no final do gráfico</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Factor levels (and legend display) by line height at end of plot"</span>,</span>
<span>       color <span class="op">=</span> <span class="st">"Hospital"</span><span class="op">)</span>                          <span class="co"># change legend title</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-393-1.png" width="672"></div>
</div>
</div>
<div id="fct_missing" class="section level2" number="11.5">
<h2>
<span class="header-section-number">11.5</span> Valores ausentes<a class="anchor" aria-label="anchor" href="#fct_missing"><i class="fas fa-link"></i></a>
</h2>
<p>Se você tiver valores <code>NA</code> em sua coluna de fatores, poderá convertê-los facilmente em um nível nomeado, como “Missing” (ausentes) com <code><a href="https://forcats.tidyverse.org/reference/fct_explicit_na.html">fct_explicit_na()</a></code>. Por padrão, os valores <code>NA</code> são convertidos para “(Missing)” no final da ordenação dos nível. Você pode ajustar o nome do nível com o argumento <code>na_level =</code>.</p>
<p>A seguir, esta operação é realizada na <code>delay_cat</code> e uma tabela é exibida com <code>tabyl()</code> contendo <code>NA</code> convertido para “Missing delay”.</p>
<div class="sourceCode" id="cb561"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>delay_cat <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_explicit_na.html">fct_explicit_na</a></span><span class="op">(</span><span class="va">delay_cat</span>, na_level <span class="op">=</span> <span class="st">"Missing delay"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">tabyl</span><span class="op">(</span><span class="va">delay_cat</span><span class="op">)</span></span></code></pre></div>
<pre><code>##      delay_cat    n    percent
##        &lt;2 dias 2990 0.50781250
##        &gt;5 dias  602 0.10224185
##       2-5 dias 2040 0.34646739
##  Missing delay  256 0.04347826</code></pre>
</div>
<div id="combine-os-níveis" class="section level2" number="11.6">
<h2>
<span class="header-section-number">11.6</span> Combine os níveis<a class="anchor" aria-label="anchor" href="#combine-os-n%C3%ADveis"><i class="fas fa-link"></i></a>
</h2>
<div id="manualmente-1" class="section level3 unnumbered">
<h3>Manualmente<a class="anchor" aria-label="anchor" href="#manualmente-1"><i class="fas fa-link"></i></a>
</h3>
<p>Você pode ajustar a exibibição dos níveis manualmente com <code><a href="https://forcats.tidyverse.org/reference/fct_recode.html">fct_recode()</a></code>. Essa função é similar a função <code><a href="https://dplyr.tidyverse.org/reference/recode.html">recode()</a></code> do <strong>dplyr</strong> (veja <a href="cleaning.html#cleaning">Limpeza de dados e principais funções</a>), mas permite a criação de novos níveis de fator. Se você usar simplesmente o <code><a href="https://dplyr.tidyverse.org/reference/recode.html">recode()</a></code> em um fator, novos valores recodificados serão rejeitados, a menos que já tenham sido definidos como níveis permitidos.</p>
<p>Essa ferramenta também pode ser usada para “combinar” níveis, atribuindo vários níveis ao mesmo valor recodificado. Só tome cuidado para não perder informações! Considere fazer essas etapas de combinação em uma nova coluna (não sobrescrever a coluna existente).</p>
<p><code><a href="https://forcats.tidyverse.org/reference/fct_recode.html">fct_recode()</a></code> tem uma sintaxe diferente de <code><a href="https://dplyr.tidyverse.org/reference/recode.html">recode()</a></code>. <code><a href="https://dplyr.tidyverse.org/reference/recode.html">recode()</a></code> usa <code>OLD = NEW</code>, enquanto <code><a href="https://forcats.tidyverse.org/reference/fct_recode.html">fct_recode()</a></code> usa <code>NEW = OLD</code>.</p>
<p>Os níveis atuais de <code>delay_cat</code> são:</p>
<pre><code>## Warning: There was 1 warning in `mutate()`.
## ℹ In argument: `delay_cat = fct_relevel(delay_cat, "&lt;2 days", after = 0)`.
## Caused by warning:
## ! 1 unknown level in `f`: &lt;2 days</code></pre>
<div class="sourceCode" id="cb564"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">delay_cat</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "&lt;2 dias"  "&gt;5 dias"  "2-5 dias"</code></pre>
<p>Os novos níveis são criados usando a sintaxe <code>fct_recode(column, "new" = "old", "new" = "old", "new" = "old")</code> e exibidos:</p>
<div class="sourceCode" id="cb566"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>delay_cat <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_recode.html">fct_recode</a></span><span class="op">(</span></span>
<span>    <span class="va">delay_cat</span>,</span>
<span>    <span class="st">"Less than 2 days"</span> <span class="op">=</span> <span class="st">"&lt;2 days"</span>,</span>
<span>    <span class="st">"2 to 5 days"</span>      <span class="op">=</span> <span class="st">"2-5 days"</span>,</span>
<span>    <span class="st">"More than 5 days"</span> <span class="op">=</span> <span class="st">"&gt;5 days"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">tabyl</span><span class="op">(</span><span class="va">delay_cat</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `mutate()`.
## ℹ In argument: `delay_cat = fct_recode(...)`.
## Caused by warning:
## ! Unknown levels in `f`: &lt;2 days, 2-5 days, &gt;5 days</code></pre>
<pre><code>##  delay_cat    n    percent valid_percent
##    &lt;2 dias 2990 0.50781250     0.5308949
##    &gt;5 dias  602 0.10224185     0.1068892
##   2-5 dias 2040 0.34646739     0.3622159
##       &lt;NA&gt;  256 0.04347826            NA</code></pre>
<p>Aqui, eles são combinados manualmente com <code><a href="https://forcats.tidyverse.org/reference/fct_recode.html">fct_recode()</a></code>. Observe que nenhum erro foi gerado na criação de um novo nível “Less than 5 days” (Menos de 5 dias) .</p>
<div class="sourceCode" id="cb569"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>delay_cat <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_recode.html">fct_recode</a></span><span class="op">(</span></span>
<span>    <span class="va">delay_cat</span>,</span>
<span>    <span class="st">"Less than 5 days"</span> <span class="op">=</span> <span class="st">"&lt;2 days"</span>,</span>
<span>    <span class="st">"Less than 5 days"</span> <span class="op">=</span> <span class="st">"2-5 days"</span>,</span>
<span>    <span class="st">"More than 5 days"</span> <span class="op">=</span> <span class="st">"&gt;5 days"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">tabyl</span><span class="op">(</span><span class="va">delay_cat</span><span class="op">)</span></span></code></pre></div>
<pre><code>##  delay_cat    n    percent valid_percent
##    &lt;2 dias 2990 0.50781250     0.5308949
##    &gt;5 dias  602 0.10224185     0.1068892
##   2-5 dias 2040 0.34646739     0.3622159
##       &lt;NA&gt;  256 0.04347826            NA</code></pre>
</div>
<div id="reduzir-para-outro" class="section level3 unnumbered">
<h3>Reduzir para “Outro”<a class="anchor" aria-label="anchor" href="#reduzir-para-outro"><i class="fas fa-link"></i></a>
</h3>
<p>Você pode usar <code><a href="https://forcats.tidyverse.org/reference/fct_other.html">fct_other()</a></code> para atribuir manualmente níveis de fator a um nível chamado “Outros”. Abaixo, todos os níveis da coluna <code>hospital</code>, aside from “Port Hospital” and “Central Hospital”, are combined into “Other”. exceto “Port Hospital” e “Central Hospital”, são combinados em “Other”. Você pode fornecer um vetor para <code>keep =</code>, ou <code>drop =</code>. Você pode alterar a exibição do nível “Outro” com <code>other_level =</code>.</p>
<div class="sourceCode" id="cb571"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>    </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>hospital <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_other.html">fct_other</a></span><span class="op">(</span>                      <span class="co"># ajustar níveis</span></span>
<span>    <span class="va">hospital</span>,</span>
<span>    keep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Port Hospital"</span>, <span class="st">"Central Hospital"</span><span class="op">)</span>,  <span class="co"># manter esses separados</span></span>
<span>    other_level <span class="op">=</span> <span class="st">"Other Hospital"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>            <span class="co"># Todos os outros como "Other Hospital"</span></span>
<span>  <span class="fu">tabyl</span><span class="op">(</span><span class="va">hospital</span><span class="op">)</span>                                   <span class="co"># exiba a tabela</span></span></code></pre></div>
<pre><code>##          hospital    n    percent
##  Central Hospital  454 0.07710598
##     Port Hospital 1762 0.29925272
##    Other Hospital 3672 0.62364130</code></pre>
</div>
<div id="reduzir-por-frequência" class="section level3 unnumbered">
<h3>Reduzir por frequência<a class="anchor" aria-label="anchor" href="#reduzir-por-frequ%C3%AAncia"><i class="fas fa-link"></i></a>
</h3>
<p>Você pode combinar os níveis do fator menos frequentes automaticamente usando <code><a href="https://forcats.tidyverse.org/reference/fct_lump.html">fct_lump()</a></code>.</p>
<p>Para “agrupar” muitos níveis de baixa frequência em um grupo “Outro”, siga um destes procedimentos:</p>
<ul>
<li>Defina <code>n =</code> como o número de grupos que deseja manter. Os n níveis mais frequentes serão mantidos e todos os outros serão combinados em “Outros”.<br>
</li>
<li>Defina <code>prop =</code> como a proporção de frequência limite para os níveis acima dos quais você deseja manter. Todos os outros valores serão combinados em “Outro”.</li>
</ul>
<p>Você pode alterar a exibição do nível “Outro” com <code>other_level =</code>. Abaixo, todos, exceto os dois hospitais mais frequentes, são combinados em “Other Hospital” (Outro hospital).</p>
<div class="sourceCode" id="cb573"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>    </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>hospital <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_lump.html">fct_lump</a></span><span class="op">(</span>                      <span class="co"># ajuste os níveis</span></span>
<span>    <span class="va">hospital</span>,</span>
<span>    n <span class="op">=</span> <span class="fl">2</span>,                                          <span class="co"># mantenha os 2 níveis superiores</span></span>
<span>    other_level <span class="op">=</span> <span class="st">"Other Hospital"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>            <span class="co"># todos os outros como "Other Hospital"</span></span>
<span>  <span class="fu">tabyl</span><span class="op">(</span><span class="va">hospital</span><span class="op">)</span>                                   <span class="co"># exiba a tabela</span></span></code></pre></div>
<pre><code>##        hospital    n   percent
##         Ausente 1469 0.2494905
##   Port Hospital 1762 0.2992527
##  Other Hospital 2657 0.4512568</code></pre>
</div>
</div>
<div id="mostrar-todos-os-níveis" class="section level2" number="11.7">
<h2>
<span class="header-section-number">11.7</span> Mostrar todos os níveis<a class="anchor" aria-label="anchor" href="#mostrar-todos-os-n%C3%ADveis"><i class="fas fa-link"></i></a>
</h2>
<p>Um benefício de usar fatores é padronizar a aparência das legendas e tabelas do gráfico, independentemente de quais valores estão realmente presentes em um conjunto de dados.</p>
<p>Se você estiver preparando muitas figuras (por exemplo, para várias jurisdições), você desejará que as legendas e tabelas apareçam de forma idêntica, mesmo com variação nos níveis de conclusão ou composição de dados.</p>
<div id="em-gráficos" class="section level3 unnumbered">
<h3>Em gráficos<a class="anchor" aria-label="anchor" href="#em-gr%C3%A1ficos"><i class="fas fa-link"></i></a>
</h3>
<p>Em uma figura <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>, simplesmente adicione o argumento <code>drop = FALSE</code> na função de escala relevante <code>scale_xxxx()</code>. Todos os níveis de fator serão exibidos, independentemente de estarem presentes nos dados. Se seus níveis de coluna de fator são exibidos usando <code>fill =</code>, então em scale_fill_discrete() você inclui <code>drop = FALSE</code>, conforme mostrado abaixo. Se seus níveis são exibidos com <code>x =</code> (para o eixo x), você deve fornecer <code>color =</code> ou <code>size =</code> para a função <code><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html">scale_color_discrete()</a></code> ou para <code><a href="https://ggplot2.tidyverse.org/reference/scale_size.html">scale_size_discrete()</a></code>, respectivamente.</p>
<p>Este exemplo é um gráfico de barras empilhadas das categorias por idade e por hospital. Adicionar <code>scale_fill_discrete(drop = FALSE)</code> garante que todas as faixas etárias apareçam na legenda, mesmo se não estiverem presentes nos dados.</p>
<div class="sourceCode" id="cb575"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">linelist</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">hospital</span>, fill <span class="op">=</span> <span class="va">age_cat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html">scale_fill_discrete</a></span><span class="op">(</span>drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">+</span>                        <span class="co"># mostra todos os grupos de idade na legenda, mesmo aqueles não presentes</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Todas as faixas etárias aparecerão na legenda, mesmo se não estiverem presentes nos dados"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-401-1.png" width="672"></div>
</div>
<div id="em-tabelas" class="section level3 unnumbered">
<h3>Em tabelas<a class="anchor" aria-label="anchor" href="#em-tabelas"><i class="fas fa-link"></i></a>
</h3>
<p>Ambas as funções <code><a href="https://rdrr.io/r/base/table.html">table()</a></code> do R <strong>base</strong> e <code>tabyl()</code> do <strong>janitor</strong> mostrarão todos os níveis de fator (mesmo os níveis não utilizados).</p>
<p>Se você usar <code><a href="https://dplyr.tidyverse.org/reference/count.html">count()</a></code> ou <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code> do <strong>dplyr</strong> para fazer uma tabela, adicione o argumento <code>.drop = FALSE</code> para incluir contagens para todos os níveis do fator, mesmo aqueles não usados.</p>
<p>Leia mais na página <a href="tables-descriptive.html#tables-descriptive">Tabelas descritivas</a>, ou no <a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">documento do scale_discrete</a>, ou na <a href="https://dplyr.tidyverse.org/reference/count.html">documentação do count()</a>. Você pode ver outro exemplo na página <a href="contact-tracing.html#contact-tracing">Rastreamento de contatos</a>.</p>
</div>
</div>
<div id="epiweeks-semanas-epidemiológicas" class="section level2" number="11.8">
<h2>
<span class="header-section-number">11.8</span> Epiweeks (semanas epidemiológicas)<a class="anchor" aria-label="anchor" href="#epiweeks-semanas-epidemiol%C3%B3gicas"><i class="fas fa-link"></i></a>
</h2>
<p>Consulte a ampla discussão sobre como criar semanas epidemiológicas na página <a href="grouping.html#grouping">Agrupamento de dados</a>.</p>
<p>Consulte também a página <a href="dates.html#dates">Trabalhando com datas</a> para obter dicas sobre como criar e formatar semanas epidemiológicas.</p>
<div id="epiweeks-em-um-gráfico" class="section level3 unnumbered">
<h3>Epiweeks em um gráfico<a class="anchor" aria-label="anchor" href="#epiweeks-em-um-gr%C3%A1fico"><i class="fas fa-link"></i></a>
</h3>
<p>Se seu objetivo é criar epiweeks para exibir em um gráfico, você pode fazer isso simplesmente com o pacote <strong>lubridate</strong> e função <code><a href="https://lubridate.tidyverse.org/reference/round_date.html">floor_date()</a></code>, conforme explicado na página <a href="grouping.html#grouping">Agrupamento de dados</a>. Os valores retornados serão da classe Data com formato AAAA-MM-DD. Se você usar esta coluna em um gráfico, as datas irão naturalmente ordenar corretamente, e você não precisa se preocupar com os níveis ou com a conversão para a classe Fator. Veja o histograma <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> das datas de início abaixo.</p>
<p>Nesta abordagem, você pode ajustar a <em>exibição</em> das datas em um eixo com <code><a href="https://ggplot2.tidyverse.org/reference/scale_date.html">scale_x_date()</a></code>. Consulte a página em <a href="epicurves.html#epicurves">Curvas epidêmicas</a> para obter mais informações. Você pode especificar um formato de exibição “strptime” para o argumento <code>date_labels =</code> da função <code><a href="https://ggplot2.tidyverse.org/reference/scale_date.html">scale_x_date()</a></code>. Esses formatos usam marcadores “%” e são abordados na página <a href="dates.html#dates">Trabalhando com datas</a>. Use “% Y” para representar um ano de 4 dígitos e “% W” ou “% U” para representar o número da semana (semanas de segunda ou domingo, respectivamente).</p>
<div class="sourceCode" id="cb576"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>epiweek_date <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/round_date.html">floor_date</a></span><span class="op">(</span><span class="va">date_onset</span>, <span class="st">"week"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>  <span class="co"># criando uma coluna de semanas</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>                                                  <span class="co"># iniciando o ggplot</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">epiweek_date</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>           <span class="co"># histograma da data de início</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html">scale_x_date</a></span><span class="op">(</span>date_labels <span class="op">=</span> <span class="st">"%Y-W%W"</span><span class="op">)</span>                       <span class="co"># ajustar a exibição das datas para YYYY-WWw</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-402-1.png" width="672"></div>
</div>
<div id="epiweeks-nos-dados" class="section level3 unnumbered">
<h3>Epiweeks nos dados<a class="anchor" aria-label="anchor" href="#epiweeks-nos-dados"><i class="fas fa-link"></i></a>
</h3>
<p>No entanto, se o seu objetivo na transformação para fator <em>não é</em> gerar um gráfico, você pode abordar isso de duas maneiras:</p>
<ol style="list-style-type: decimal">
<li>
<em>Para um controle preciso sobre a exibição</em>, converta no <strong>lubridate</strong> a coluna epiweek (YYYY-MM-DD) para o formato de exibição desejado (YYYY-WWw) <em>dentro do próprio data frame</em> e, em seguida, converta-o para a classe Fator.</li>
</ol>
<p>Primeiro, use <code><a href="https://rdrr.io/r/base/format.html">format()</a></code> do R <strong>base</strong> para converter a exibição de data de YYYY-MM-DD para YYYY-Www (consulte a página <a href="dates.html#dates">Trabalhando com datas</a>). Neste processo, a classe será convertida em caractere. Em seguida, converta de caractere para classe Fator com <code><a href="https://rdrr.io/r/base/factor.html">factor()</a></code>.</p>
<div class="sourceCode" id="cb577"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>epiweek_date <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/round_date.html">floor_date</a></span><span class="op">(</span><span class="va">date_onset</span>, <span class="st">"week"</span><span class="op">)</span>,       <span class="co"># cria semanas epidemiológicas - epiweeks (YYYY-MM-DD)</span></span>
<span>         epiweek_formatted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="va">epiweek_date</span>, <span class="st">"%Y-W%W"</span><span class="op">)</span>,  <span class="co"># Converter para mostrar (YYYY-WWW)</span></span>
<span>         epiweek_formatted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">epiweek_formatted</span><span class="op">)</span><span class="op">)</span>       <span class="co"># Converter para fator</span></span>
<span></span>
<span><span class="co"># Mostrar níveis</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">epiweek_formatted</span><span class="op">)</span></span></code></pre></div>
<pre><code>##  [1] "2014-W13" "2014-W14" "2014-W15" "2014-W16" "2014-W17" "2014-W18" "2014-W19"
##  [8] "2014-W20" "2014-W21" "2014-W22" "2014-W23" "2014-W24" "2014-W25" "2014-W26"
## [15] "2014-W27" "2014-W28" "2014-W29" "2014-W30" "2014-W31" "2014-W32" "2014-W33"
## [22] "2014-W34" "2014-W35" "2014-W36" "2014-W37" "2014-W38" "2014-W39" "2014-W40"
## [29] "2014-W41" "2014-W42" "2014-W43" "2014-W44" "2014-W45" "2014-W46" "2014-W47"
## [36] "2014-W48" "2014-W49" "2014-W50" "2014-W51" "2015-W00" "2015-W01" "2015-W02"
## [43] "2015-W03" "2015-W04" "2015-W05" "2015-W06" "2015-W07" "2015-W08" "2015-W09"
## [50] "2015-W10" "2015-W11" "2015-W12" "2015-W13" "2015-W14" "2015-W15" "2015-W16"</code></pre>
<p><span style="color: red;"><strong><em>PERIGO:</em></strong> Se você colocar as semanas à frente dos anos (“Www-YYYY”) (“% W-% Y”), a ordem de nível alfanumérico padrão estará incorreta (por exemplo, 01-2015 estará antes de 35-2014) . Pode ser necessário ajustar manualmente a ordem, o que seria um processo longo e doloroso.</span></p>
<ol start="2" style="list-style-type: decimal">
<li>
<em>Para uma exibição padrão rápida</em>, use o pacote <strong>aweek</strong> e sua função <code>date2week()</code>. Você pode definir o dia do início da semana por <code>week_start =</code> e, se definir <code>factor = TRUE</code> a coluna de saída é um fator ordenado. Como bônus, o fator inclui níveis para <em>todas</em> as semanas possíveis no intervalo - mesmo se não houver casos naquela semana.</li>
</ol>
<div class="sourceCode" id="cb579"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>epiweek <span class="op">=</span> <span class="fu">date2week</span><span class="op">(</span><span class="va">date_onset</span>, week_start <span class="op">=</span> <span class="st">"Monday"</span>, factor <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">epiweek</span><span class="op">)</span></span></code></pre></div>
<p>Veja a página <a href="dates.html#dates">Trabalhando com datas</a> para mais informações sobre <strong>aweek</strong>. O pacote também oferece a função reversa <code>week2date()</code>.</p>
<!-- ======================================================= -->
</div>
</div>
<div id="recursos-4" class="section level2" number="11.9">
<h2>
<span class="header-section-number">11.9</span> Recursos<a class="anchor" aria-label="anchor" href="#recursos-4"><i class="fas fa-link"></i></a>
</h2>
<p>R para a página de Ciência de Dados em <a href="https://r4ds.had.co.nz/factors.html">factors</a><br><a href="https://cran.r-project.org/web/packages/aweek/vignettes/introduction.html">vinheta do pacote aweek</a></p>

<!-- ======================================================= -->
<!-- ======================================================= -->
<!-- ======================================================= -->
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="characters-strings.html"><span class="header-section-number">10</span> Caracteres e strings</a></div>
<div class="next"><a href="pivoting.html"><span class="header-section-number">12</span> Pivoteando dados</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#factors"><span class="header-section-number">11</span> Fatores</a></li>
<li>
<a class="nav-link" href="#prepara%C3%A7%C3%A3o-2"><span class="header-section-number">11.1</span> Preparação</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#carregar-pacotes-1">Carregar pacotes</a></li>
<li><a class="nav-link" href="#importe-os-dados">Importe os dados</a></li>
<li><a class="nav-link" href="#fct_newcat">Nova variável categórica</a></li>
</ul>
</li>
<li><a class="nav-link" href="#converter-para-fator"><span class="header-section-number">11.2</span> Converter para fator</a></li>
<li>
<a class="nav-link" href="#adicionar-ou-remover-n%C3%ADveis"><span class="header-section-number">11.3</span> Adicionar ou remover níveis</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#fct_add">Adicionar</a></li>
<li><a class="nav-link" href="#remover">Remover</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#fct_adjust"><span class="header-section-number">11.4</span> Ajuste a ordem dos níveis</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#manualmente">Manualmente</a></li>
<li><a class="nav-link" href="#dentro-de-um-gr%C3%A1fico">Dentro de um gráfico</a></li>
<li><a class="nav-link" href="#inverter">Inverter</a></li>
<li><a class="nav-link" href="#por-frequ%C3%AAncia">Por frequência</a></li>
<li><a class="nav-link" href="#pela-apar%C3%AAncia">Pela aparência</a></li>
<li><a class="nav-link" href="#pela-estat%C3%ADstica-de-resumo-de-outra-coluna">Pela estatística de resumo de outra coluna</a></li>
<li><a class="nav-link" href="#por-valor-final">Por valor “final”</a></li>
</ul>
</li>
<li><a class="nav-link" href="#fct_missing"><span class="header-section-number">11.5</span> Valores ausentes</a></li>
<li>
<a class="nav-link" href="#combine-os-n%C3%ADveis"><span class="header-section-number">11.6</span> Combine os níveis</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#manualmente-1">Manualmente</a></li>
<li><a class="nav-link" href="#reduzir-para-outro">Reduzir para “Outro”</a></li>
<li><a class="nav-link" href="#reduzir-por-frequ%C3%AAncia">Reduzir por frequência</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#mostrar-todos-os-n%C3%ADveis"><span class="header-section-number">11.7</span> Mostrar todos os níveis</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#em-gr%C3%A1ficos">Em gráficos</a></li>
<li><a class="nav-link" href="#em-tabelas">Em tabelas</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#epiweeks-semanas-epidemiol%C3%B3gicas"><span class="header-section-number">11.8</span> Epiweeks (semanas epidemiológicas)</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#epiweeks-em-um-gr%C3%A1fico">Epiweeks em um gráfico</a></li>
<li><a class="nav-link" href="#epiweeks-nos-dados">Epiweeks nos dados</a></li>
</ul>
</li>
<li><a class="nav-link" href="#recursos-4"><span class="header-section-number">11.9</span> Recursos</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Manual de R para Epidemiologistas</strong>" was written by the handbook team. It was last built on 2023-10-22.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
