<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>27 Análise de sobrevivência | Manual de R para Epidemiologistas</title>
<meta name="author" content="the handbook team">
<meta name="description" content="27.1 Visão Geral A análise de sobrevivência centra-se na descrição, para um determinado indivíduo ou grupo de indivíduos, de um ponto definido de evento chamado a falha (ocorrência de uma doença,...">
<meta name="generator" content="bookdown 0.35 with bs4_book()">
<meta property="og:title" content="27 Análise de sobrevivência | Manual de R para Epidemiologistas">
<meta property="og:type" content="book">
<meta property="og:description" content="27.1 Visão Geral A análise de sobrevivência centra-se na descrição, para um determinado indivíduo ou grupo de indivíduos, de um ponto definido de evento chamado a falha (ocorrência de uma doença,...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="27 Análise de sobrevivência | Manual de R para Epidemiologistas">
<meta name="twitter:description" content="27.1 Visão Geral A análise de sobrevivência centra-se na descrição, para um determinado indivíduo ou grupo de indivíduos, de um ponto definido de evento chamado a falha (ocorrência de uma doença,...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.5.1/transition.js"></script><script src="libs/bs3compat-0.5.1/tabs.js"></script><script src="libs/bs3compat-0.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.29/datatables.js"></script><link href="libs/dt-core-1.13.4/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.13.4/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.13.4/js/jquery.dataTables.min.js"></script><link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script><link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="libs/selectize-0.12.0/selectize.min.js"></script><link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="libs/tabwid-1.1.3/tabwid.js"></script><link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="libs/leaflet-1.3.1/leaflet.js"></script><link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="libs/proj4-2.6.2/proj4.min.js"></script><script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="libs/leaflet-binding-2.2.0/leaflet.js"></script><script src="libs/leaflet-providers-1.13.0/leaflet-providers_1.13.0.js"></script><script src="libs/leaflet-providers-plugin-2.2.0/leaflet-providers-plugin.js"></script><script src="libs/viz-1.8.2/viz.js"></script><link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="libs/grViz-binding-1.0.10/grViz.js"></script><script src="libs/d3-4.5.0/d3.min.js"></script><script src="libs/sankey-1/sankey.js"></script><script src="libs/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script><script src="libs/plotly-binding-4.10.2/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script><link href="libs/vis-9.1.0/vis-network.min.css" rel="stylesheet">
<script src="libs/vis-9.1.0/vis-network.min.js"></script><script src="libs/visNetwork-binding-2.1.2/visNetwork.js"></script><link href="libs/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet">
<script src="libs/plotly-basic-2.11.1/plotly-basic-2.11.1.min.js"></script><script src="libs/plotly-cartesian-2.11.1/plotly-cartesian-2.11.1.min.js"></script><script src="libs/proj4js-2.3.15/proj4.js"></script><link href="libs/highcharts-9.3.1/css/motion.css" rel="stylesheet">
<script src="libs/highcharts-9.3.1/highcharts.js"></script><script src="libs/highcharts-9.3.1/highcharts-3d.js"></script><script src="libs/highcharts-9.3.1/highcharts-more.js"></script><script src="libs/highcharts-9.3.1/modules/stock.js"></script><script src="libs/highcharts-9.3.1/modules/map.js"></script><script src="libs/highcharts-9.3.1/modules/data.js"></script><script src="libs/highcharts-9.3.1/modules/exporting.js"></script><script src="libs/highcharts-9.3.1/modules/offline-exporting.js"></script><script src="libs/highcharts-9.3.1/modules/drilldown.js"></script><script src="libs/highcharts-9.3.1/modules/item-series.js"></script><script src="libs/highcharts-9.3.1/modules/overlapping-datalabels.js"></script><script src="libs/highcharts-9.3.1/modules/annotations.js"></script><script src="libs/highcharts-9.3.1/modules/export-data.js"></script><script src="libs/highcharts-9.3.1/modules/funnel.js"></script><script src="libs/highcharts-9.3.1/modules/heatmap.js"></script><script src="libs/highcharts-9.3.1/modules/treemap.js"></script><script src="libs/highcharts-9.3.1/modules/sankey.js"></script><script src="libs/highcharts-9.3.1/modules/dependency-wheel.js"></script><script src="libs/highcharts-9.3.1/modules/organization.js"></script><script src="libs/highcharts-9.3.1/modules/solid-gauge.js"></script><script src="libs/highcharts-9.3.1/modules/streamgraph.js"></script><script src="libs/highcharts-9.3.1/modules/sunburst.js"></script><script src="libs/highcharts-9.3.1/modules/vector.js"></script><script src="libs/highcharts-9.3.1/modules/wordcloud.js"></script><script src="libs/highcharts-9.3.1/modules/xrange.js"></script><script src="libs/highcharts-9.3.1/modules/tilemap.js"></script><script src="libs/highcharts-9.3.1/modules/venn.js"></script><script src="libs/highcharts-9.3.1/modules/gantt.js"></script><script src="libs/highcharts-9.3.1/modules/timeline.js"></script><script src="libs/highcharts-9.3.1/modules/parallel-coordinates.js"></script><script src="libs/highcharts-9.3.1/modules/bullet.js"></script><script src="libs/highcharts-9.3.1/modules/coloraxis.js"></script><script src="libs/highcharts-9.3.1/modules/dumbbell.js"></script><script src="libs/highcharts-9.3.1/modules/lollipop.js"></script><script src="libs/highcharts-9.3.1/modules/series-label.js"></script><script src="libs/highcharts-9.3.1/plugins/motion.js"></script><script src="libs/highcharts-9.3.1/custom/reset.js"></script><script src="libs/highcharts-9.3.1/modules/boost.js"></script><script src="libs/highchart-binding-0.9.4/highchart.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-QXDW878QLX"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-QXDW878QLX');
    </script>
</head>
<body>
<div class="alert alert-info alert-dismissible">
      <a href="#" class="close" data-dismiss="alert" aria-label="close">×</a>
      <strong>Você precisa de ajuda para aprender R?</strong> Inscreva-se no curso de <a href="https://www.appliedepi.org/live/" class="alert-link">introdução ao R</a> da Applied Epi, experimente nossos <a href="https://www.appliedepi.org/tutorial/" class="alert-link">tutoriais gratuitos sobre o R</a>, publique em nosso <a href="https://community.appliedepi.org/" class="alert-link">fórum de perguntas e respostas</a>, ou solicite nosso <a href="mailto:contact@appliedepi.org" class="alert-link">suporte ao R</a>.
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style_bs4.css">
<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Manual de R para Epidemiologistas</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"></a></li>
<li class="book-part">Sobre este livro</li>
<li><a class="" href="editorial-style.html"><span class="header-section-number">1</span> Notas editoriais e técnicas</a></li>
<li><a class="" href="data-used.html"><span class="header-section-number">2</span> Baixe o livro e os dados</a></li>
<li class="book-part">Básico</li>
<li><a class="" href="basics.html"><span class="header-section-number">3</span> Introdução ao R</a></li>
<li><a class="" href="transition-to-R.html"><span class="header-section-number">4</span> Transição para o R</a></li>
<li><a class="" href="packages-suggested.html"><span class="header-section-number">5</span> Pacotes sugeridos</a></li>
<li><a class="" href="r-projects.html"><span class="header-section-number">6</span> R projects</a></li>
<li><a class="" href="importing.html"><span class="header-section-number">7</span> Importar e exportar</a></li>
<li class="book-part">Gerenciamento dos Dados</li>
<li><a class="" href="cleaning.html"><span class="header-section-number">8</span> Limpeza de dados e principais funções</a></li>
<li><a class="" href="dates.html"><span class="header-section-number">9</span> Trabalhando com datas</a></li>
<li><a class="" href="characters-strings.html"><span class="header-section-number">10</span> Caracteres e strings</a></li>
<li><a class="" href="factors.html"><span class="header-section-number">11</span> Fatores</a></li>
<li><a class="" href="pivoting.html"><span class="header-section-number">12</span> Pivoteando dados</a></li>
<li><a class="" href="grouping.html"><span class="header-section-number">13</span> Agrupando dados</a></li>
<li><a class="" href="joining-matching.html"><span class="header-section-number">14</span> Juntando dados (Joins)</a></li>
<li><a class="" href="deduplication.html"><span class="header-section-number">15</span> Eliminação de duplicidades</a></li>
<li><a class="" href="iteration.html"><span class="header-section-number">16</span> Iterações, loops e listas</a></li>
<li class="book-part">Análise dos dados</li>
<li><a class="" href="tables-descriptive.html"><span class="header-section-number">17</span> Tabelas descritivas</a></li>
<li><a class="" href="stat-tests.html"><span class="header-section-number">18</span> Testes estatísticos simples</a></li>
<li><a class="" href="regression.html"><span class="header-section-number">19</span> Regressão simples e múltipla</a></li>
<li><a class="" href="missing-data.html"><span class="header-section-number">20</span> Campos em branco/faltantes</a></li>
<li><a class="" href="standardization.html"><span class="header-section-number">21</span> Normalização de taxas</a></li>
<li><a class="" href="moving-average.html"><span class="header-section-number">22</span> Médias móveis</a></li>
<li><a class="" href="time-series.html"><span class="header-section-number">23</span> Séries temporais e detecção de surtos</a></li>
<li><a class="" href="epidemic-models.html"><span class="header-section-number">24</span> Modelagem de epidemias</a></li>
<li><a class="" href="contact-tracing.html"><span class="header-section-number">25</span> Rastreamento de contatos</a></li>
<li><a class="" href="survey-analysis.html"><span class="header-section-number">26</span> Analises de pesquisa de questionários (survey)</a></li>
<li><a class="active" href="survival-analysis.html"><span class="header-section-number">27</span> Análise de sobrevivência</a></li>
<li><a class="" href="gis.html"><span class="header-section-number">28</span> Introdução ao GIS</a></li>
<li class="book-part">Visualização de Dados</li>
<li><a class="" href="tables-presentation.html"><span class="header-section-number">29</span> Tabelas para apresentação</a></li>
<li><a class="" href="ggplot-basics.html"><span class="header-section-number">30</span> O básico do ggplot</a></li>
<li><a class="" href="ggplot-tips.html"><span class="header-section-number">31</span> Dicas do ggplot</a></li>
<li><a class="" href="epicurves.html"><span class="header-section-number">32</span> Curvas epidêmicas</a></li>
<li><a class="" href="age-pyramid.html"><span class="header-section-number">33</span> Pirâmides demográficas e escalas Likert</a></li>
<li><a class="" href="heatmaps.html"><span class="header-section-number">34</span> Gráficos de calor</a></li>
<li><a class="" href="diagrams.html"><span class="header-section-number">35</span> Diagramas e gráficos</a></li>
<li><a class="" href="combination-analysis.html"><span class="header-section-number">36</span> Análise de Combinações</a></li>
<li><a class="" href="transmission-chains.html"><span class="header-section-number">37</span> Cadeias de Transmissão</a></li>
<li><a class="" href="phylogenetic-trees.html"><span class="header-section-number">38</span> Árvores filogenéticas</a></li>
<li><a class="" href="interactive-plots.html"><span class="header-section-number">39</span> Gráficos interativos</a></li>
<li class="book-part">Relatórios e dashboards</li>
<li><a class="" href="rmarkdown.html"><span class="header-section-number">40</span> Relatórios com R Markdown</a></li>
<li><a class="" href="reportfactory.html"><span class="header-section-number">41</span> Organização de relatórios de rotina</a></li>
<li><a class="" href="flexdashboard.html"><span class="header-section-number">42</span> Painéis (Dashboards) com R Markdown</a></li>
<li><a class="" href="shiny-basics.html"><span class="header-section-number">43</span> Painéis com Shiny</a></li>
<li class="book-part">Miscelânea</li>
<li><a class="" href="writing-functions.html"><span class="header-section-number">44</span> Escrevendo funções</a></li>
<li><a class="" href="directories.html"><span class="header-section-number">45</span> Interações de diretório</a></li>
<li><a class="" href="collaboration.html"><span class="header-section-number">46</span> Controle de versão e colaboração com Git e Github</a></li>
<li><a class="" href="errors.html"><span class="header-section-number">47</span> Erros comuns</a></li>
<li><a class="" href="help.html"><span class="header-section-number">48</span> Conseguindo ajuda</a></li>
<li><a class="" href="network-drives.html"><span class="header-section-number">49</span> R em drives (pastas) na rede</a></li>
<li><a class="" href="data-table.html"><span class="header-section-number">50</span> Data Table</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="survival-analysis" class="section level1" number="27">
<h1>
<span class="header-section-number">27</span> Análise de sobrevivência<a class="anchor" aria-label="anchor" href="#survival-analysis"><i class="fas fa-link"></i></a>
</h1>
<div class="inline-figure"><img src="images/survival_analysis.png" width="75%" style="display: block; margin: auto;"></div>
<!-- ======================================================= -->
<div id="visão-geral-3" class="section level2" number="27.1">
<h2>
<span class="header-section-number">27.1</span> Visão Geral<a class="anchor" aria-label="anchor" href="#vis%C3%A3o-geral-3"><i class="fas fa-link"></i></a>
</h2>
<p><em>A análise de sobrevivência</em> centra-se na descrição, para um determinado indivíduo ou grupo de indivíduos, de um ponto definido de evento chamado <strong>a falha</strong> (ocorrência de uma doença, cura de uma doença, óbito, recaída após resposta ao tratamento…) que ocorre após um período de tempo chamado <strong>tempo de falha</strong> (ou <strong>tempo de seguimento</strong> em estudos baseados em coorte/população) durante o qual os indivíduos são observados. Para determinar o tempo de falha, é então necessário definir um tempo de origem (que pode ser a data de inclusão, a data de diagnóstico…).</p>
<p>O alvo de inferência para a análise de sobrevivência é então o tempo entre uma origem e um evento. Na investigação médica actual, é amplamente utilizado em estudos clínicos para avaliar o efeito de um tratamento, por exemplo, ou na epidemiologia do câncer para avaliar uma grande variedade de medidas de sobrevivência ao câncer.</p>
<p>É normalmente expressa através da <strong>probabilidade de sobrevivência</strong> que é a probabilidade de o evento de interesse não ter ocorrido por uma duração t.</p>
<p><strong>Censura</strong>: A censura ocorre quando no final do seguimento, alguns dos indivíduos não tiveram o evento de interesse, e assim o seu verdadeiro tempo para o evento é desconhecido. Aqui focaremos principalmente na censura correta, mas para mais detalhes sobre a censura e a análise de sobrevivência em geral, é possível ver referências.</p>
<!-- ======================================================= -->
</div>
<div id="preparação-17" class="section level2" number="27.2">
<h2>
<span class="header-section-number">27.2</span> Preparação<a class="anchor" aria-label="anchor" href="#prepara%C3%A7%C3%A3o-17"><i class="fas fa-link"></i></a>
</h2>
<div id="carregar-pacotes-5" class="section level3 unnumbered">
<h3>Carregar Pacotes<a class="anchor" aria-label="anchor" href="#carregar-pacotes-5"><i class="fas fa-link"></i></a>
</h3>
<p>Para realizar análises de sobrevivência em R, um dos pacotes mais utilizados é o pacote <strong>survival</strong>. Primeiro o instalamos e depois o carregamos, bem como os outros pacotes que serão utilizados nesta secção:</p>
<p>Neste manual enfatizamos <code><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load()</a></code> do <strong>pacman</strong>, que instala o pacote se necessário <em>e</em> carrega-o para utilização. Pode também carregar os pacotes instalados com <code><a href="https://rdrr.io/r/base/library.html">library()</a></code> do R <strong>base</strong> . Veja a página em <a href="basics.html#basics">Introdução ao R</a> para mais informações sobre os pacotes R.</p>
<p>Esta página explora análises de sobrevivência usando a <em>linelist</em> usada na maioria das páginas anteriores e na qual aplicamos algumas alterações para termos dados de sobrevivência adequados.</p>
<p>Importar conjunto de dados</p>
<p>Importamos o conjunto de dados de casos de uma epidemia simulada de Ebola. Se quiser acompanhar, <a href="https://github.com/epirhandbook/Epi_R_handbook/raw/master/data/case_linelists/linelist_cleaned.rds" class="download-button">clique para fazer o download da <em>linelist</em> “limpa” </a> (as .rds file). Importe os dados com a função <code><a href="https://rdrr.io/pkg/rio/man/import.html">import()</a></code> do pacote <strong>rio</strong> (suporta muitos formatos de arquivos .xlsx, .csv, .rds - veja a página <a href="importing.html#importing">Importar e exportar</a> para mais detalhes).</p>
<div class="sourceCode" id="cb1280"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># importar linelist</span></span>
<span><span class="va">linelist_case_data</span> <span class="op">&lt;-</span> <span class="fu">rio</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="st">"linelist_cleaned.rds"</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="gestão-e-transformação-de-dados" class="section level3 unnumbered">
<h3>Gestão e transformação de dados<a class="anchor" aria-label="anchor" href="#gest%C3%A3o-e-transforma%C3%A7%C3%A3o-de-dados"><i class="fas fa-link"></i></a>
</h3>
<p>Em suma, os dados de sobrevivência podem ser descritos como tendo as três características seguintes:</p>
<ol style="list-style-type: decimal">
<li>a variável ou resposta dependente é o tempo de espera até à ocorrência de um evento bem definido,</li>
<li>as observações são censuradas, no sentido de que para algumas unidades o evento de interesse não ocorreu no momento em que os dados são analisados, e</li>
<li>existem preditores ou variáveis explicativas cujo efeito sobre o tempo de espera desejamos avaliar ou controlar.</li>
</ol>
<p>Assim, criaremos diferentes variáveis necessárias para respeitar essa estrutura e executar a análise de sobrevivência.</p>
<p>Definimos:</p>
<ul>
<li>um novo <em>data frame</em> <code>linelist_surv</code> para esta análise</li>
<li>o nosso evento de interesse como sendo “óbito” (nossa probabilidade de sobrevivência será a probabilidade de estar vivo um certo tempo após o tempo de origem),</li>
<li>o tempo de seguimento (<code>futime</code>) como o tempo entre o tempo de início e o tempo do resultado <em>em dias</em>,</li>
<li>pacientes censurados como aqueles que recuperaram ou para os quais o resultado final não é conhecido, ou seja, o evento “morte” não foi observado (<code>evento=0</code>).</li>
</ul>
<p><span estilo="color: orange;"><strong>CUIDADO:</strong> Uma vez que num estudo de coorte real, a informação sobre a hora de origem e o fim do seguimento é conhecida, dado que são observados indivíduos, removeremos as observações onde a data de início ou a data do desfecho é desconhecida. Também os casos em que a data de início é posterior à data do resultado serão removidos, uma vez que são considerados errados</span></p>
<p><span style="color: darkgreen;"><strong>DICA:</strong> Dado que filtrar para maior que (&gt;) ou menor que (&lt;) uma data pode remover linhas sem valores, aplicar o filtro nas datas erradas também removerá as linhas sem datas.</span></p>
<p>Depois utilizamos <code><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when()</a></code> para criar uma coluna <code>age_cat_small</code> na qual existem apenas 3 categorias de idade.</p>
<div class="sourceCode" id="cb1281"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#criar um novo dado chamado linelist_surv a partir do linelist_case_data</span></span>
<span></span>
<span><span class="va">linelist_surv</span> <span class="op">&lt;-</span>  <span class="va">linelist_case_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>     </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>       <span class="co"># remover observações com datas de início ou desfecho erradas ou vazias</span></span>
<span>       <span class="va">date_outcome</span> <span class="op">&gt;</span> <span class="va">date_onset</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>       <span class="co"># criar o evento var que é 1 se o paciente morreu e 0 se ele foi censurado correctamente</span></span>
<span>       event <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">outcome</span><span class="op">)</span> <span class="op">|</span> <span class="va">outcome</span> <span class="op">==</span> <span class="st">"Recover"</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>    </span>
<span>       <span class="co"># criar o var sobre o tempo de seguimento em dias</span></span>
<span>       futime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html">as.double</a></span><span class="op">(</span><span class="va">date_outcome</span> <span class="op">-</span> <span class="va">date_onset</span><span class="op">)</span>, </span>
<span>    </span>
<span>       <span class="co"># criar uma nova variável de categoria de idade com apenas 3 níveis de estratos</span></span>
<span>       age_cat_small <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span> </span>
<span>            <span class="va">age_years</span> <span class="op">&lt;</span> <span class="fl">5</span>  <span class="op">~</span> <span class="st">"0-4"</span>,</span>
<span>            <span class="va">age_years</span> <span class="op">&gt;=</span> <span class="fl">5</span> <span class="op">&amp;</span> <span class="va">age_years</span> <span class="op">&lt;</span> <span class="fl">20</span> <span class="op">~</span> <span class="st">"5-19"</span>,</span>
<span>            <span class="va">age_years</span> <span class="op">&gt;=</span> <span class="fl">20</span>   <span class="op">~</span> <span class="st">"20+"</span><span class="op">)</span>,</span>
<span>       </span>
<span>       <span class="co"># passo anterior criou age_cat_small var como caractere</span></span>
<span>       <span class="co"># agora o converte em fator e especifica os níveis.</span></span>
<span>       <span class="co"># note que os valores NA continuam a ser NA e não são colocados num nível "desconhecido", por exemplo,</span></span>
<span>       <span class="co"># uma vez que nas análises seguintes tem de ser removidas.</span></span>
<span>       age_cat_small <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_relevel.html">fct_relevel</a></span><span class="op">(</span><span class="va">age_cat_small</span>, <span class="st">"0-4"</span>, <span class="st">"5-19"</span>, <span class="st">"20+"</span><span class="op">)</span></span>
<span>       <span class="op">)</span></span></code></pre></div>
<p><span style="color: darkgreen;"><strong>DICA:</strong> Podemos verificar as novas colunas que criamos fazendo um resumo sobre o <code>futime</code> e uma tabulação cruzada entre o <code>evento</code> e o <code>resultado</code> de onde foi criado. Para além desta verificação, é um bom hábito comunicar o tempo médio de seguimento ao interpretar os resultados da análise de sobrevivência.</span></p>
<div class="sourceCode" id="cb1282"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">linelist_surv</span><span class="op">$</span><span class="va">futime</span><span class="op">)</span></span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    1.00    6.00   10.00   11.98   16.00   64.00</code></pre>
<div class="sourceCode" id="cb1284"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># tabulação cruzada das novas variáveis modificadas "event" e "outcome" (desfecho) </span></span>
<span><span class="co"># para garantir que o código fazia o que se pretendia</span></span>
<span><span class="va">linelist_surv</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">tabyl</span><span class="op">(</span><span class="va">outcome</span>, <span class="va">event</span><span class="op">)</span></span></code></pre></div>
<pre><code>##  outcome    0    1
##    Death    0 1952
##  Recover 1547    0
##     &lt;NA&gt; 1040    0</code></pre>
<p>Agora fazemos uma tabulação cruzada da nova variável “age_cat_small” e da antiga coluna “age_cat” para garantir atribuições corretas</p>
<div class="sourceCode" id="cb1286"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist_surv</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">tabyl</span><span class="op">(</span><span class="va">age_cat_small</span>, <span class="va">age_cat</span><span class="op">)</span></span></code></pre></div>
<pre><code>##  age_cat_small 0-4 5-9 10-14 15-19 20-29 30-49 50-69 70+ NA_
##            0-4 834   0     0     0     0     0     0   0   0
##           5-19   0 852   717   575     0     0     0   0   0
##            20+   0   0     0     0   862   554    69   5   0
##           &lt;NA&gt;   0   0     0     0     0     0     0   0  71</code></pre>
<p>Agora revisamos as 10 primeiras observações dos dados da <code>linelist_surv</code>, olhando para variáveis específicas (incluindo aquelas recentemente criadas).</p>
<div class="sourceCode" id="cb1288"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist_surv</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">case_id</span>, <span class="va">age_cat_small</span>, <span class="va">date_onset</span>, <span class="va">date_outcome</span>, <span class="va">outcome</span>, <span class="va">event</span>, <span class="va">futime</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<pre><code>##    case_id age_cat_small date_onset date_outcome outcome event futime
## 1   8689b7           0-4 2014-05-13   2014-05-18 Recover     0      5
## 2   11f8ea           20+ 2014-05-16   2014-05-30 Recover     0     14
## 3   893f25           0-4 2014-05-21   2014-05-29 Recover     0      8
## 4   be99c8          5-19 2014-05-22   2014-05-24 Recover     0      2
## 5   07e3e8          5-19 2014-05-27   2014-06-01 Recover     0      5
## 6   369449           0-4 2014-06-02   2014-06-07   Death     1      5
## 7   f393b4           20+ 2014-06-05   2014-06-18 Recover     0     13
## 8   1389ca           20+ 2014-06-05   2014-06-09   Death     1      4
## 9   2978ac          5-19 2014-06-06   2014-06-15   Death     1      9
## 10  fc15ef          5-19 2014-06-16   2014-07-09 Recover     0     23</code></pre>
<p>Também podemos fazer tabulações cruzadas entre as colunas <code>age_cat_small</code> e <code>gender</code> para obter mais detalhes acercada distribuição dessas novas colunas por gênero. Usamos <code>tabyl()</code> e a função <em>adorn</em> do pacote <strong>janitor</strong>, como descrito na página <a href="tables-descriptive.html#tables-descriptive">Tabelas descritivas</a>.</p>
<!-- Para isso, usamos a função `stat.table()` do pacote **Epi**. -->
<div class="sourceCode" id="cb1290"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist_surv</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">tabyl</span><span class="op">(</span><span class="va">gender</span>, <span class="va">age_cat_small</span>, show_na <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">adorn_totals</span><span class="op">(</span>where <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">adorn_percentages</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">adorn_pct_formatting</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">adorn_ns</span><span class="op">(</span>position <span class="op">=</span> <span class="st">"front"</span><span class="op">)</span></span></code></pre></div>
<pre><code>##  gender         0-4          5-19           20+          Total
##       f 482 (22.4%) 1,184 (54.9%)   490 (22.7%) 2,156 (100.0%)
##       m 325 (15.0%)   880 (40.6%)   960 (44.3%) 2,165 (100.0%)
##   Total 807 (18.7%) 2,064 (47.8%) 1,450 (33.6%) 4,321 (100.0%)</code></pre>
<!-- Epi::stat.table(  -->
<!--   #atribua variáveis para a tabulação cruzada -->
<!--   list( -->
<!--     gender,  -->
<!--     age_cat_small -->
<!--     ), -->
<!--   #especifique a função que deseja chamar (mean,count..) -->
<!--   list(  -->
<!--     count(), -->
<!--     percent(age_cat_small) -->
<!--     ),  -->
<!--   #adicione margens -->
<!--   margins=T,  -->
<!--   #dados utilizados -->
<!--   data = linelist_surv  -->
<!--   ) -->
<!-- ``` -->
<!-- ======================================================= -->
</div>
</div>
<div id="noções-básicas-de-análise-de-sobrevivência" class="section level2" number="27.3">
<h2>
<span class="header-section-number">27.3</span> Noções básicas de análise de sobrevivência<a class="anchor" aria-label="anchor" href="#no%C3%A7%C3%B5es-b%C3%A1sicas-de-an%C3%A1lise-de-sobreviv%C3%AAncia"><i class="fas fa-link"></i></a>
</h2>
<div id="construir-um-objeto-do-tipo-sobrevivente" class="section level3 unnumbered">
<h3>Construir um objeto do tipo sobrevivente<a class="anchor" aria-label="anchor" href="#construir-um-objeto-do-tipo-sobrevivente"><i class="fas fa-link"></i></a>
</h3>
<p>Utilizaremos primeiro a função <code>Surv()</code> do pacote <strong>survival</strong> para construir um objeto de sobrevivência a partir das colunas de tempo e evento seguintes.</p>
<p>O resultado de tal passo é produzir um objeto do tipo <em>Surv</em> que condensa a informação do tempo e se o evento de interesse (óbito) foi observado. Este objeto acabará por ser utilizado no lado direito das fórmulas do modelo subsequente (ver <a href="https://cran.r-project.org/web/packages/survival/vignettes/survival.pdf">documentação</a>).</p>
<div class="sourceCode" id="cb1292"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use a sintaxe Suv() para dados censurados</span></span>
<span><span class="va">survobj</span> <span class="op">&lt;-</span> <span class="fu">Surv</span><span class="op">(</span>time <span class="op">=</span> <span class="va">linelist_surv</span><span class="op">$</span><span class="va">futime</span>,</span>
<span>                event <span class="op">=</span> <span class="va">linelist_surv</span><span class="op">$</span><span class="va">event</span><span class="op">)</span></span></code></pre></div>
<!-- ```{r} -->
<!-- survobj <- with(linelist_surv, -->
<!--                 survival::Surv(futime, event) -->
<!--                 ) -->
<!-- ``` -->
<p>Para rever, aqui estão as primeiras 10 linhas dos dados da <code>linelist_surv</code>, visualizando apenas algumas colunas importantes.</p>
<div class="sourceCode" id="cb1293"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist_surv</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">case_id</span>, <span class="va">date_onset</span>, <span class="va">date_outcome</span>, <span class="va">futime</span>, <span class="va">outcome</span>, <span class="va">event</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<pre><code>##    case_id date_onset date_outcome futime outcome event
## 1   8689b7 2014-05-13   2014-05-18      5 Recover     0
## 2   11f8ea 2014-05-16   2014-05-30     14 Recover     0
## 3   893f25 2014-05-21   2014-05-29      8 Recover     0
## 4   be99c8 2014-05-22   2014-05-24      2 Recover     0
## 5   07e3e8 2014-05-27   2014-06-01      5 Recover     0
## 6   369449 2014-06-02   2014-06-07      5   Death     1
## 7   f393b4 2014-06-05   2014-06-18     13 Recover     0
## 8   1389ca 2014-06-05   2014-06-09      4   Death     1
## 9   2978ac 2014-06-06   2014-06-15      9   Death     1
## 10  fc15ef 2014-06-16   2014-07-09     23 Recover     0</code></pre>
<p>E aqui estão os primeiros 10 elementos do <code>survobj</code>. Imprime essencialmente como um vetor de tempo de seguimento, com “+” para representar se uma observação foi bem censurada. Veja como os números se alinham acima e abaixo.</p>
<div class="sourceCode" id="cb1295"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#imprime os 50 primeiros elementos do vetor para ver como ele se apresenta</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">survobj</span>, <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<pre><code>##  [1]  5+ 14+  8+  2+  5+  5  13+  4   9  23+</code></pre>
</div>
<div id="rodando-análises-iniciais" class="section level3 unnumbered">
<h3>Rodando análises iniciais<a class="anchor" aria-label="anchor" href="#rodando-an%C3%A1lises-iniciais"><i class="fas fa-link"></i></a>
</h3>
<p>Iniciamos então a nossa análise utilizando a função <code>survfit()</code> para produzir um <em>objeto survfit</em>, que se ajusta aos cálculos padrões de estimativas da curva de sobrevivência global (marginal) <strong><em>Kaplan Meier</em></strong> (KM) , que são na verdade uma função com saltos em tempos de eventos observados. O objeto final <em>survfit</em> contém uma ou mais curvas de sobrevivência e são criadas usando o objeto <em>Surv</em> como uma resposta variável na fórmula do modelo.</p>
<p><span style="color: black;"><strong><em>NOTA:</em></strong> A estimativa de Kaplan-Meier é uma estimativa não paramétrica da máxima probabilidade (MLE na sigla em inglês) da função de sobrevivência. . (ver recursos para mais informações)</span></p>
<p>O resumo deste <em>objeto survfit</em> dará o que se chama uma <em>tabela de vida</em>. Para cada passo do seguimento (<code>tempo</code>) em que um evento aconteceu (em ordem ascendente):</p>
<ul>
<li>o número de pessoas que estavam em risco de desenvolver o evento (pessoas que ainda não tinham o evento nem foram censuradas: <code>n.risk</code>)</li>
<li>aqueles que desenvolveram o evento (<code>n.event</code>)</li>
<li>e do acima exposto: a probabilidade de <em>não</em> desenvolver o evento (probabilidade de não morrer, ou de sobreviver depois desse tempo específico)</li>
<li>finalmente, o erro padrão e o intervalo de confiança para essa probabilidade são derivados e exibidos</li>
</ul>
<p>Encaixamos as estimativas KM usando a fórmula em que o objeto anteriormente Surv “survobj” é a variável de resposta. “~ 1” precisa que executamos o modelo para a sobrevivência global.</p>
<div class="sourceCode" id="cb1297"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># encaixa nas estimativas KM usando uma fórmula onde o objeto Surv "sobrevivente" é a variável de resposta.</span></span>
<span><span class="co"># "~ 1" significa que executamos o modelo para a sobrevivência global   </span></span>
<span><span class="va">linelistsurv_fit</span> <span class="op">&lt;-</span>  <span class="fu">survival</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit.html">survfit</a></span><span class="op">(</span><span class="va">survobj</span> <span class="op">~</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># imprime o resumo para mais detalhes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">linelistsurv_fit</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Call: survfit(formula = survobj ~ 1)
## 
##  time n.risk n.event survival std.err lower 95% CI upper 95% CI
##     1   4539      30    0.993 0.00120        0.991        0.996
##     2   4500      69    0.978 0.00217        0.974        0.982
##     3   4394     149    0.945 0.00340        0.938        0.952
##     4   4176     194    0.901 0.00447        0.892        0.910
##     5   3899     214    0.852 0.00535        0.841        0.862
##     6   3592     210    0.802 0.00604        0.790        0.814
##     7   3223     179    0.757 0.00656        0.745        0.770
##     8   2899     167    0.714 0.00700        0.700        0.728
##     9   2593     145    0.674 0.00735        0.660        0.688
##    10   2311     109    0.642 0.00761        0.627        0.657
##    11   2081     119    0.605 0.00788        0.590        0.621
##    12   1843      89    0.576 0.00809        0.560        0.592
##    13   1608      55    0.556 0.00823        0.540        0.573
##    14   1448      43    0.540 0.00837        0.524        0.556
##    15   1296      31    0.527 0.00848        0.511        0.544
##    16   1152      48    0.505 0.00870        0.488        0.522
##    17   1002      29    0.490 0.00886        0.473        0.508
##    18    898      21    0.479 0.00900        0.462        0.497
##    19    798       7    0.475 0.00906        0.457        0.493
##    20    705       4    0.472 0.00911        0.454        0.490
##    21    626      13    0.462 0.00932        0.444        0.481
##    22    546       8    0.455 0.00948        0.437        0.474
##    23    481       5    0.451 0.00962        0.432        0.470
##    24    436       4    0.447 0.00975        0.428        0.466
##    25    378       4    0.442 0.00993        0.423        0.462
##    26    336       3    0.438 0.01010        0.419        0.458
##    27    297       1    0.436 0.01017        0.417        0.457
##    29    235       1    0.435 0.01030        0.415        0.455
##    38     73       1    0.429 0.01175        0.406        0.452</code></pre>
<p>Enquanto usamos <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> podemos adicionar a opção <code>times</code> e especificar certos tempos em que queremos ver informações de sobrevivência.</p>
<div class="sourceCode" id="cb1299"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#imprime o resumo de tempos específicos</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">linelistsurv_fit</span>, times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">10</span>,<span class="fl">20</span>,<span class="fl">30</span>,<span class="fl">60</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Call: survfit(formula = survobj ~ 1)
## 
##  time n.risk n.event survival std.err lower 95% CI upper 95% CI
##     5   3899     656    0.852 0.00535        0.841        0.862
##    10   2311     810    0.642 0.00761        0.627        0.657
##    20    705     446    0.472 0.00911        0.454        0.490
##    30    210      39    0.435 0.01030        0.415        0.455
##    60      2       1    0.429 0.01175        0.406        0.452</code></pre>
<p>Podemos também utilizar a função <code><a href="https://rdrr.io/r/base/print.html">print()</a></code>. O argumento <code>print.rmean = TRUE</code> é utilizado para obter o tempo médio de sobrevivência e o seu erro padrão (SE na sigla em inglês).</p>
<p><span style="color: black;"><strong>NOTA:</strong> O tempo médio de sobrevivência restrito (RMST na sigla em inglês) é uma medida de sobrevivência específica cada vez mais utilizada na análise de sobrevivência ao câncer e que é frequentemente definida como a área sob a curva de sobrevivência, dado que observamos pacientes até ao tempo restrito T (mais detalhes na seção Recursos).</span></p>
<div class="sourceCode" id="cb1301"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># imprimir objeto linelistsurv_fit com tempo médio de sobrevivência e sua SE.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">linelistsurv_fit</span>, print.rmean <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Call: survfit(formula = survobj ~ 1)
## 
##         n events rmean* se(rmean) median 0.95LCL 0.95UCL
## [1,] 4539   1952   33.1     0.539     17      16      18
##     * restricted mean with upper limit =  64</code></pre>
<p><span style="color: darkgreen;"><strong>DICA:</strong> Podemos criar o objeto <em>surv</em> diretamente na função <code>survfit()</code> e economizar uma linha de código. Ficará então: <code>linelistsurv_quick &lt;-  survfit(Surv(futime, event) ~ 1, data=linelist_surv)</code>.</span></p>
</div>
<div id="risco-acumulado" class="section level3 unnumbered">
<h3>Risco acumulado<a class="anchor" aria-label="anchor" href="#risco-acumulado"><i class="fas fa-link"></i></a>
</h3>
<p>Além da função <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code>, também podemos utilizar a função <code><a href="https://rdrr.io/r/utils/str.html">str()</a></code> que dá mais detalhes sobre a estrutura do objeto <code>survfit()</code>. É uma lista de 16 elementos.</p>
<p>Entre estes elementos é um importante: <code>cumhaz</code>, que é um vetor numérico. Este pode ser traçado para permitir mostrar o <strong>risco cumulativo</strong>, sendo o <strong>risco</strong> o <strong>índice instantâneo de ocorrência de eventos</strong> (ver referências).</p>
<div class="sourceCode" id="cb1303"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">linelistsurv_fit</span><span class="op">)</span></span></code></pre></div>
<pre><code>## List of 16
##  $ n        : int 4539
##  $ time     : num [1:59] 1 2 3 4 5 6 7 8 9 10 ...
##  $ n.risk   : num [1:59] 4539 4500 4394 4176 3899 ...
##  $ n.event  : num [1:59] 30 69 149 194 214 210 179 167 145 109 ...
##  $ n.censor : num [1:59] 9 37 69 83 93 159 145 139 137 121 ...
##  $ surv     : num [1:59] 0.993 0.978 0.945 0.901 0.852 ...
##  $ std.err  : num [1:59] 0.00121 0.00222 0.00359 0.00496 0.00628 ...
##  $ cumhaz   : num [1:59] 0.00661 0.02194 0.05585 0.10231 0.15719 ...
##  $ std.chaz : num [1:59] 0.00121 0.00221 0.00355 0.00487 0.00615 ...
##  $ type     : chr "right"
##  $ logse    : logi TRUE
##  $ conf.int : num 0.95
##  $ conf.type: chr "log"
##  $ lower    : num [1:59] 0.991 0.974 0.938 0.892 0.841 ...
##  $ upper    : num [1:59] 0.996 0.982 0.952 0.91 0.862 ...
##  $ call     : language survfit(formula = survobj ~ 1)
##  - attr(*, "class")= chr "survfit"</code></pre>
<!-- ======================================================= -->
</div>
<div id="traçando-curvas-kaplan-meir" class="section level3 unnumbered">
<h3>Traçando curvas Kaplan-Meir<a class="anchor" aria-label="anchor" href="#tra%C3%A7ando-curvas-kaplan-meir"><i class="fas fa-link"></i></a>
</h3>
<p>Uma vez encaixadas as estimativas KM, podemos visualizar a probabilidade de estarmos vivos durante um determinado tempo utilizando a função básica <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> que desenha a “curva Kaplan-Meier”. Em outras palavras, a curva abaixo é uma ilustração convencional da experiência de sobrevivência em todo o grupo de pacientes.</p>
<p>Podemos verificar rapidamente o tempo de seguimento mínimo e máximo na curva.</p>
<p>Uma maneira fácil de interpretar é dizer que no tempo zero, todos os participantes ainda estão vivos e a probabilidade de sobrevivência é então de 100%. Esta probabilidade diminui com o tempo, à medida que os pacientes morrem. A proporção de participantes que sobrevivem nos últimos 60 dias de seguimento é de cerca de 40%.</p>
<div class="sourceCode" id="cb1305"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">linelistsurv_fit</span>, </span>
<span>     xlab <span class="op">=</span> <span class="st">"Days of follow-up"</span>,    <span class="co"># nome eixo X</span></span>
<span>     ylab<span class="op">=</span><span class="st">"Survival Probability"</span>,   <span class="co"># nome eixo Y</span></span>
<span>     main<span class="op">=</span> <span class="st">"Overall survival curve"</span> <span class="co"># título da figura</span></span>
<span>     <span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-916-1.png" width="672"></div>
<p>O intervalo de confiança das estimativas de sobrevivência do KM também são traçados por padrão e podem ser descartados adicionando a opção <code>conf.int = FALSE</code> ao comando <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code>.</p>
<p>Uma vez que o evento de interesse é “óbito”, desenhar uma curva descrevendo os complementos das proporções de sobrevivência levará a desenhar as proporções de mortalidade acumulada. Isto pode ser feito com <code><a href="https://rdrr.io/r/graphics/lines.html">lines()</a></code>, o que acrescenta informação a uma parcela existente.</p>
<div class="sourceCode" id="cb1306"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># gráfico original</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">linelistsurv_fit</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Dias de seguimento"</span>,       </span>
<span>  ylab <span class="op">=</span> <span class="st">"Probabilidade de Sobrevivência"</span>,       </span>
<span>  mark.time <span class="op">=</span> <span class="cn">TRUE</span>,               <span class="co"># marcar eventos na curva: um "+" é impresso em cada evento</span></span>
<span>  conf.int <span class="op">=</span> <span class="cn">FALSE</span>,              <span class="co"># não traçar o intervalo de confiança</span></span>
<span>  main <span class="op">=</span> <span class="st">"Curva geral de sobrevivência e mortalidade acumulada"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># desenhar uma curva adicional ao gráfico anterior</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span></span>
<span>  <span class="va">linelistsurv_fit</span>,</span>
<span>  lty <span class="op">=</span> <span class="fl">3</span>,             <span class="co"># usar tipo de linha diferente para maior clareza</span></span>
<span>  fun <span class="op">=</span> <span class="st">"event"</span>,       <span class="co"># desenhar os eventos cumulativos em vez da sobrevivência</span></span>
<span>  mark.time <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  conf.int <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># adiciona legenda ao gráfico</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span></span>
<span>  <span class="st">"topright"</span>,                                       <span class="co"># posição da legenda</span></span>
<span>  legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Sobrevivência"</span>, <span class="st">"Mortalidade Acum."</span><span class="op">)</span>, <span class="co"># texto da legenda</span></span>
<span>  lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>,                                    <span class="co"># tipos de linha a serem usados na legenda</span></span>
<span>  cex <span class="op">=</span> <span class="fl">.85</span>,                                        <span class="co"># parâmetros que definem o tamanho do texto da legenda</span></span>
<span>  bty <span class="op">=</span> <span class="st">"n"</span>                                         <span class="co"># nenhum tipo de caixa a ser desenhada para a legenda</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-917-1.png" width="672"></div>
<!-- ======================================================= -->
</div>
</div>
<div id="comparação-de-curvas-de-sobrevivência" class="section level2" number="27.4">
<h2>
<span class="header-section-number">27.4</span> Comparação de curvas de sobrevivência<a class="anchor" aria-label="anchor" href="#compara%C3%A7%C3%A3o-de-curvas-de-sobreviv%C3%AAncia"><i class="fas fa-link"></i></a>
</h2>
<p>Para comparar a sobrevivência dentro de diferentes grupos dos nossos participantes ou pacientes observados, podemos ter de olhar primeiro para as suas respectivas curvas de sobrevivência e depois fazer testes para avaliar a diferença entre grupos independentes. Esta comparação pode dizer respeito a grupos baseados no sexo, idade, tratamento, comorbidade…</p>
<div id="teste-de-classificação-de-registo" class="section level3 unnumbered">
<h3>Teste de classificação de registo<a class="anchor" aria-label="anchor" href="#teste-de-classifica%C3%A7%C3%A3o-de-registo"><i class="fas fa-link"></i></a>
</h3>
<p>O teste de log-rank é um teste popular que compara toda a experiência de sobrevivência entre dois ou mais grupos <em>independentes</em> e pode ser pensado como um teste para verificar se as curvas de sobrevivência são idênticas (sobreposição) ou não (hipótese nula de não haver diferença na sobrevivência entre os grupos). A função <code>survdiff()</code> do pacote <strong>survival</strong> permite executar o teste de log-rank quando especificamos <code>rho = 0</code> (que é o padrão). Os resultados do teste dão uma estatística de qui-quadrado juntamente com um p-valor, uma vez que a estatística de classificação logarítmica é distribuída aproximadamente como uma estatística de teste de qui-quadrado.</p>
<p>Tentamos primeiro comparar as curvas de sobrevivência por grupo de gênero. Para tal, tentamos primeiro visualizá-la (verificar se as duas curvas de sobrevivência estão sobrepostas). Um novo objeto <em>survfit</em> será criado com uma fórmula ligeiramente diferente. Depois será criado o objeto <em>survdiff</em>.</p>
<p>Ao fornecer <code>~ gender</code> como o lado direito da fórmula, deixamos de traçar a sobrevivência global e passamos a fazê-lo por gênero.</p>
<div class="sourceCode" id="cb1307"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># criar um novo objeto do tipo survfit baseado no gênero</span></span>
<span><span class="va">linelistsurv_fit_sex</span> <span class="op">&lt;-</span>  <span class="fu">survfit</span><span class="op">(</span><span class="fu">Surv</span><span class="op">(</span><span class="va">futime</span>, <span class="va">event</span><span class="op">)</span> <span class="op">~</span> <span class="va">gender</span>, data <span class="op">=</span> <span class="va">linelist_surv</span><span class="op">)</span></span></code></pre></div>
<p>Agora podemos traçar as curvas de sobrevivência por gênero. Veja a <em>ordem</em> dos níveis de estratos na coluna do gênero antes de definir as suas cores e legendas.</p>
<div class="sourceCode" id="cb1308"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># padrão de cor</span></span>
<span><span class="va">col_sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lightgreen"</span>, <span class="st">"darkgreen"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># cria a impressão</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">linelistsurv_fit_sex</span>,</span>
<span>  col <span class="op">=</span> <span class="va">col_sex</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Days of follow-up"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"Survival Probability"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># adiciona legenda</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span></span>
<span>  <span class="st">"topright"</span>,</span>
<span>  legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Feminino"</span>,<span class="st">"Masculino"</span><span class="op">)</span>,</span>
<span>  col <span class="op">=</span> <span class="va">col_sex</span>,</span>
<span>  lty <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  cex <span class="op">=</span> <span class="fl">.9</span>,</span>
<span>  bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-918-1.png" width="672"></div>
<p>E agora podemos calcular o teste da diferença entre as curvas de sobrevivência usando <code>survdiff ()</code></p>
<div class="sourceCode" id="cb1309"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calcula o teste da diferença entre as curvas de sobrevivência</span></span>
<span><span class="fu">survival</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/survdiff.html">survdiff</a></span><span class="op">(</span></span>
<span>  <span class="fu">Surv</span><span class="op">(</span><span class="va">futime</span>, <span class="va">event</span><span class="op">)</span> <span class="op">~</span> <span class="va">gender</span>, </span>
<span>  data <span class="op">=</span> <span class="va">linelist_surv</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code>## Call:
## survival::survdiff(formula = Surv(futime, event) ~ gender, data = linelist_surv)
## 
## n=4321, 218 observations deleted due to missingness.
## 
##             N Observed Expected (O-E)^2/E (O-E)^2/V
## gender=f 2156      924      909     0.255     0.524
## gender=m 2165      929      944     0.245     0.524
## 
##  Chisq= 0.5  on 1 degrees of freedom, p= 0.5</code></pre>
<p>Vemos que a curva de sobrevivência das mulheres e a dos homens se sobrepõem e o teste do log-rank não dá provas de uma diferença de sobrevivência entre mulheres e homens.</p>
<p>Alguns outros pacotes de R permitem ilustrar curvas de sobrevivência para diferentes grupos e testar a diferença de uma só vez. Utilizando a função <code>ggsurvplot()</code> do pacote <strong>survminer</strong>, podemos também incluir na nossa curva as tabelas de risco impressas para cada grupo, bem como o valor p do teste de log-rank.</p>
<p>[<strong>CUIDADO:</strong> funções <strong>survminer</strong> requerem que se especifique o objeto de sobrevivência <em>e</em> novamente os dados utilizados para encaixar o objeto de sobrevivência. Lembre-se de fazer isto para evitar mensagens de erro não específicas].{style=“color: orange;”}</p>
<div class="sourceCode" id="cb1311"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">survminer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survminer/man/ggsurvplot.html">ggsurvplot</a></span><span class="op">(</span></span>
<span>    <span class="va">linelistsurv_fit_sex</span>, </span>
<span>    data <span class="op">=</span> <span class="va">linelist_surv</span>,          <span class="co"># novamente especificar o dado usado para encaixar linelistsurv_fit_sex </span></span>
<span>    conf.int <span class="op">=</span> <span class="cn">FALSE</span>,              <span class="co"># não mostrar o intervalo de confiança da estimativa KM</span></span>
<span>    surv.scale <span class="op">=</span> <span class="st">"percent"</span>,        <span class="co"># apresentar probabilidades no eixo Y em %</span></span>
<span>    break.time.by <span class="op">=</span> <span class="fl">10</span>,            <span class="co"># apresentar o eixo de tempo com um incremento de 10 dias</span></span>
<span>    xlab <span class="op">=</span> <span class="st">"Follow-up days"</span>,</span>
<span>    ylab <span class="op">=</span> <span class="st">"Survival Probability"</span>,</span>
<span>    pval <span class="op">=</span> <span class="cn">T</span>,                      <span class="co"># adicionar o p-valor do teste Log-rank </span></span>
<span>    pval.coord <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">40</span>,<span class="fl">.91</span><span class="op">)</span>,        <span class="co"># adicionar o p-valor às coordenadas especificadas</span></span>
<span>    risk.table <span class="op">=</span> <span class="cn">T</span>,                <span class="co"># imprimir a tabela de risco no fundo  </span></span>
<span>    legend.title <span class="op">=</span> <span class="st">"Gender"</span>,       <span class="co"># características da legenda</span></span>
<span>    legend.labs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Female"</span>,<span class="st">"Male"</span><span class="op">)</span>,</span>
<span>    font.legend <span class="op">=</span> <span class="fl">10</span>, </span>
<span>    palette <span class="op">=</span> <span class="st">"Dark2"</span>,             <span class="co"># especificar paleta de cores </span></span>
<span>    surv.median.line <span class="op">=</span> <span class="st">"hv"</span>,       <span class="co"># desenhar linhas horizontais e verticais para a mediana de sobrevivência</span></span>
<span>    ggtheme <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_light</a></span><span class="op">(</span><span class="op">)</span>        <span class="co"># simplificar o plano de fundo da impressão</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-920-1.png" width="672"></div>
<p>Também podemos querer testar diferenças na sobrevivência pela fonte de infecção (fonte de contaminação).</p>
<p>Neste caso, o teste de Log rank dá provas suficientes de uma diferença nas probabilidades de sobrevivência em <code>alpha= 0,005</code>. As probabilidades de sobrevivência de pacientes que foram infectados em funerais são superiores às probabilidades de sobrevivência de pacientes que foram infectados em outros locais, sugerindo um benefício de sobrevivência.</p>
<div class="sourceCode" id="cb1312"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelistsurv_fit_source</span> <span class="op">&lt;-</span>  <span class="fu">survfit</span><span class="op">(</span></span>
<span>  <span class="fu">Surv</span><span class="op">(</span><span class="va">futime</span>, <span class="va">event</span><span class="op">)</span> <span class="op">~</span> <span class="va">source</span>,</span>
<span>  data <span class="op">=</span> <span class="va">linelist_surv</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># impressão</span></span>
<span><span class="fu">ggsurvplot</span><span class="op">(</span> </span>
<span>  <span class="va">linelistsurv_fit_source</span>,</span>
<span>  data <span class="op">=</span> <span class="va">linelist_surv</span>,</span>
<span>  size <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="st">"strata"</span>,   <span class="co"># tipos de linhas</span></span>
<span>  conf.int <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  surv.scale <span class="op">=</span> <span class="st">"percent"</span>,  </span>
<span>  break.time.by <span class="op">=</span> <span class="fl">10</span>, </span>
<span>  xlab <span class="op">=</span> <span class="st">"Follow-up days"</span>,</span>
<span>  ylab<span class="op">=</span> <span class="st">"Survival Probability"</span>,</span>
<span>  pval <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  pval.coord <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">40</span>,<span class="fl">.91</span><span class="op">)</span>,</span>
<span>  risk.table <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  legend.title <span class="op">=</span> <span class="st">"Source of \ninfection"</span>,</span>
<span>  legend.labs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Funeral"</span>, <span class="st">"Other"</span><span class="op">)</span>,</span>
<span>  font.legend <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#E7B800"</span>,<span class="st">"#3E606F"</span><span class="op">)</span>,</span>
<span>  surv.median.line <span class="op">=</span> <span class="st">"hv"</span>, </span>
<span>  ggtheme <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_light</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-921-1.png" width="672"></div>
<!-- ======================================================= -->
</div>
</div>
<div id="análise-de-regressão-de-cox" class="section level2" number="27.5">
<h2>
<span class="header-section-number">27.5</span> Análise de regressão de Cox<a class="anchor" aria-label="anchor" href="#an%C3%A1lise-de-regress%C3%A3o-de-cox"><i class="fas fa-link"></i></a>
</h2>
<p>O modelo de riscos proporcionais de Cox é uma das técnicas de regressão mais populares para a análise de sobrevivência. Outros modelos também podem ser utilizados, uma vez que o modelo Cox requer <em>importantes pressupostos</em> que precisam ser verificados para uma utilização adequada, tal como o pressuposto dos riscos proporcionais: ver referências.</p>
<p>Num modelo de riscos proporcionais de Cox, a medida do efeito é a <strong>taxa de risco ou razão de riscos</strong>(HR na sigla <em>Hazard Ratio</em> em inglês), que é o risco de fracasso (ou o risco de morte no nosso exemplo), dado que o participante sobreviveu até um tempo específico. Normalmente, estamos interessados em comparar <em>grupos independentes</em> com respeito aos seus perigos, e utilizamos uma taxa de risco, que é análoga a uma taxa de probabilidade no estabelecimento de uma análise de regressão logística múltipla. A função <code>cox.ph()</code> do pacote <strong>survival</strong> é utilizada para se adequar ao modelo. A função <code>cox.zph()</code> do pacote <strong>survival</strong> pode ser utilizada para testar a hipótese de riscos proporcionais para um ajuste do modelo de regressão Cox.</p>
<p><span style="color: black;"><strong>NOTA:</strong> A probabilidade deve estar no intervalo de 0 a 1. No entanto, o perigo representa o número esperado de eventos por uma unidade de tempo.</span></p>
<ul>
<li>Se a razão de perigo para um preditor for próxima de 1, então esse preditor não afeta a sobrevivência,</li>
<li>se o HR for inferior a 1, então o preditor é protetor (ou seja, associado a uma melhor sobrevivência),</li>
<li>e se a FC for superior a 1, então o preditor está associado ao aumento do risco (ou diminuição da sobrevivência).</li>
</ul>
<div id="ajuste-de-um-modelo-cox" class="section level3 unnumbered">
<h3>Ajuste de um modelo Cox<a class="anchor" aria-label="anchor" href="#ajuste-de-um-modelo-cox"><i class="fas fa-link"></i></a>
</h3>
<p>Podemos primeiro ajustar um modelo para avaliar o efeito da idade e do gênero na sobrevivência. Ao imprimir apenas o modelo, temos a informação sobre:</p>
<ul>
<li>os coeficientes de regressão estimados “coef” que quantificam a associação entre os preditores e o resultado,</li>
<li>a sua exponencial (para interpretabilidade, <code>exp(coef)</code>) que produz a <em>razão de riscos HR</em>,</li>
<li>o seu erro padrão <code>se(coef)</code>,</li>
<li>o z-score: quantos erros padrão é o coeficiente estimado a partir de 0,</li>
<li>e o p-valor: a probabilidade de o coeficiente estimado poder ser 0.</li>
</ul>
<p>A função <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> aplicada ao objeto modelo Cox dá mais informações, tais como o intervalo de confiança do HR estimado e os diferentes resultados do teste.</p>
<p>O efeito da primeira covariável “gênero” é apresentado na primeira linha. O <code>genderm</code> (masculino) é mostrado indicando que o primeiro nível de estratos (“f”), ou seja, o grupo feminino, é o grupo de referência para as comparações dentro do gênero. Assim, a interpretação do parâmetro de teste é a dos homens em comparação com a das mulheres. O p-valor indica que não havia evidências suficientes de um efeito do gênero sobre o risco esperado ou de uma associação entre o gênero e a mortalidade por todas as causas.</p>
<p>A mesma falta de evidências é notada no que diz respeito ao grupo etário.</p>
<div class="sourceCode" id="cb1313"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ajustando o modelo cox</span></span>
<span><span class="va">linelistsurv_cox_sexage</span> <span class="op">&lt;-</span>  <span class="fu">survival</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/coxph.html">coxph</a></span><span class="op">(</span></span>
<span>              <span class="fu">Surv</span><span class="op">(</span><span class="va">futime</span>, <span class="va">event</span><span class="op">)</span> <span class="op">~</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">age_cat_small</span>, </span>
<span>              data <span class="op">=</span> <span class="va">linelist_surv</span></span>
<span>              <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">#imprimindo o modelo ajustado</span></span>
<span><span class="va">linelistsurv_cox_sexage</span></span></code></pre></div>
<pre><code>## Call:
## survival::coxph(formula = Surv(futime, event) ~ gender + age_cat_small, 
##     data = linelist_surv)
## 
##                       coef exp(coef) se(coef)      z     p
## genderm           -0.03149   0.96900  0.04767 -0.661 0.509
## age_cat_small5-19  0.09400   1.09856  0.06454  1.456 0.145
## age_cat_small20+   0.05032   1.05161  0.06953  0.724 0.469
## 
## Likelihood ratio test=2.8  on 3 df, p=0.4243
## n= 4321, number of events= 1853 
##    (218 observations deleted due to missingness)</code></pre>
<div class="sourceCode" id="cb1315"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#resumo do modelo</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">linelistsurv_cox_sexage</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Call:
## survival::coxph(formula = Surv(futime, event) ~ gender + age_cat_small, 
##     data = linelist_surv)
## 
##   n= 4321, number of events= 1853 
##    (218 observations deleted due to missingness)
## 
##                       coef exp(coef) se(coef)      z Pr(&gt;|z|)
## genderm           -0.03149   0.96900  0.04767 -0.661    0.509
## age_cat_small5-19  0.09400   1.09856  0.06454  1.456    0.145
## age_cat_small20+   0.05032   1.05161  0.06953  0.724    0.469
## 
##                   exp(coef) exp(-coef) lower .95 upper .95
## genderm               0.969     1.0320    0.8826     1.064
## age_cat_small5-19     1.099     0.9103    0.9680     1.247
## age_cat_small20+      1.052     0.9509    0.9176     1.205
## 
## Concordance= 0.514  (se = 0.007 )
## Likelihood ratio test= 2.8  on 3 df,   p=0.4
## Wald test            = 2.78  on 3 df,   p=0.4
## Score (logrank) test = 2.78  on 3 df,   p=0.4</code></pre>
<p>Foi interessante executar o modelo e olhar para os resultados, mas um primeiro olhar para verificar se os pressupostos de riscos proporcionais são respeitados poderia ajudar a poupar tempo.</p>
<div class="sourceCode" id="cb1317"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_ph_sexage</span> <span class="op">&lt;-</span> <span class="fu">survival</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/cox.zph.html">cox.zph</a></span><span class="op">(</span><span class="va">linelistsurv_cox_sexage</span><span class="op">)</span></span>
<span><span class="va">test_ph_sexage</span></span></code></pre></div>
<pre><code>##               chisq df    p
## gender        0.454  1 0.50
## age_cat_small 0.838  2 0.66
## GLOBAL        1.399  3 0.71</code></pre>
<p><span style="color: black;"><strong>NOTA:</strong> Um segundo argumento da função chamado <em>method</em> pode ser especificado ao calcular o modelo cox, que determina como os empates são tratados. O <em>padrão</em> é “efron”, e as outras opções são “breslow” e “exact”.</span></p>
<p>Num outro modelo, adicionamos mais fatores de risco, tais como a fonte da infecção e o número de dias entre a data de início e a admissão. Desta vez, verificamos primeiro a hipótese de riscos proporcionais antes de avançarmos.</p>
<p>Neste modelo, incluímos um preditor contínuo (<code>days_onset_hosp</code>). Neste caso, interpretamos as estimativas dos parâmetros como o aumento do registo esperado do risco relativo para cada aumento de uma unidade no preditor, mantendo constantes outros preditores. Primeiro verificamos a suposição de perigos proporcionais.</p>
<div class="sourceCode" id="cb1319"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#cria o modelo</span></span>
<span><span class="va">linelistsurv_cox</span> <span class="op">&lt;-</span>  <span class="fu">coxph</span><span class="op">(</span></span>
<span>                        <span class="fu">Surv</span><span class="op">(</span><span class="va">futime</span>, <span class="va">event</span><span class="op">)</span> <span class="op">~</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">age_years</span><span class="op">+</span> <span class="va">source</span> <span class="op">+</span> <span class="va">days_onset_hosp</span>,</span>
<span>                        data <span class="op">=</span> <span class="va">linelist_surv</span></span>
<span>                        <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">#testa o modelo de risco proporcional</span></span>
<span><span class="va">linelistsurv_ph_test</span> <span class="op">&lt;-</span> <span class="fu">cox.zph</span><span class="op">(</span><span class="va">linelistsurv_cox</span><span class="op">)</span></span>
<span><span class="va">linelistsurv_ph_test</span></span></code></pre></div>
<pre><code>##                    chisq df       p
## gender           0.45062  1    0.50
## age_years        0.00199  1    0.96
## source           1.79622  1    0.18
## days_onset_hosp 31.66167  1 1.8e-08
## GLOBAL          34.08502  4 7.2e-07</code></pre>
<p>A verificação gráfica desta hipótese pode ser realizada com a função <code>ggcoxzph()</code> do pacote <strong>survminer</strong>.</p>
<div class="sourceCode" id="cb1321"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">survminer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survminer/man/ggcoxzph.html">ggcoxzph</a></span><span class="op">(</span><span class="va">linelistsurv_ph_test</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-922-1.png" width="672"></div>
<p>Os resultados do modelo indicam a existência de uma associação negativa entre o início da duração da admissão e a mortalidade por todas as causas. O risco esperado é 0,9 vezes menor numa pessoa que é admitida um dia mais tarde do que outra, mantendo constante o gênero. Ou, numa explicação mais direta, um aumento de uma unidade na duração do início da admissão está associado a uma diminuição de 10,7% (<code>coef *100</code>) no risco de morte.</p>
<p>Os resultados mostram também uma associação positiva entre a fonte da infecção e a mortalidade por todas as causas. Ou seja, há um aumento do risco de morte (1,21x) para os pacientes que têm outra fonte de infecção.</p>
<div class="sourceCode" id="cb1322"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#resumo do modelo</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">linelistsurv_cox</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(futime, event) ~ gender + age_years + source + 
##     days_onset_hosp, data = linelist_surv)
## 
##   n= 2772, number of events= 1180 
##    (1767 observations deleted due to missingness)
## 
##                      coef exp(coef)  se(coef)      z Pr(&gt;|z|)    
## genderm          0.004710  1.004721  0.060827  0.077   0.9383    
## age_years       -0.002249  0.997753  0.002421 -0.929   0.3528    
## sourceother      0.178393  1.195295  0.084291  2.116   0.0343 *  
## days_onset_hosp -0.104063  0.901169  0.014245 -7.305 2.77e-13 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
##                 exp(coef) exp(-coef) lower .95 upper .95
## genderm            1.0047     0.9953    0.8918    1.1319
## age_years          0.9978     1.0023    0.9930    1.0025
## sourceother        1.1953     0.8366    1.0133    1.4100
## days_onset_hosp    0.9012     1.1097    0.8764    0.9267
## 
## Concordance= 0.566  (se = 0.009 )
## Likelihood ratio test= 71.31  on 4 df,   p=1e-14
## Wald test            = 59.22  on 4 df,   p=4e-12
## Score (logrank) test = 59.54  on 4 df,   p=4e-12</code></pre>
<p>Podemos verificar essa relação com a tabela:</p>
<div class="sourceCode" id="cb1324"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist_case_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">tabyl</span><span class="op">(</span><span class="va">days_onset_hosp</span>, <span class="va">outcome</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">adorn_percentages</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>  </span>
<span>  <span class="fu">adorn_pct_formatting</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>##  days_onset_hosp Death Recover   NA_
##                0 44.3%   31.4% 24.3%
##                1 46.6%   32.2% 21.2%
##                2 43.0%   32.8% 24.2%
##                3 45.0%   32.3% 22.7%
##                4 41.5%   38.3% 20.2%
##                5 40.0%   36.2% 23.8%
##                6 32.2%   48.7% 19.1%
##                7 31.8%   38.6% 29.5%
##                8 29.8%   38.6% 31.6%
##                9 30.3%   51.5% 18.2%
##               10 16.7%   58.3% 25.0%
##               11 36.4%   45.5% 18.2%
##               12 18.8%   62.5% 18.8%
##               13 10.0%   60.0% 30.0%
##               14 10.0%   50.0% 40.0%
##               15 28.6%   42.9% 28.6%
##               16 20.0%   80.0%  0.0%
##               17  0.0%  100.0%  0.0%
##               18  0.0%  100.0%  0.0%
##               22  0.0%  100.0%  0.0%
##               NA 52.7%   31.2% 16.0%</code></pre>
<p>Teríamos de considerar e investigar porque é que esta associação existe nos dados. Uma explicação possível poderia ser que os pacientes que vivem o tempo suficiente para serem admitidos mais tarde, tem uma doença menos grave. Outra explicação talvez mais provável é que, uma vez que utilizámos um conjunto de dados falso simulado, este padrão não reflete a realidade!</p>
<!-- ======================================================= -->
</div>
<div id="gráficos-em-floresta-forest-plots" class="section level3 unnumbered">
<h3>Gráficos em floresta (Forest plots)<a class="anchor" aria-label="anchor" href="#gr%C3%A1ficos-em-floresta-forest-plots"><i class="fas fa-link"></i></a>
</h3>
<p>Podemos visualizar os resultados do modelo Cox usando “forest plots” com a função <code>ggforest()</code> do pacote <strong>survminer</strong>.</p>
<div class="sourceCode" id="cb1326"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggforest</span><span class="op">(</span><span class="va">linelistsurv_cox</span>, data <span class="op">=</span> <span class="va">linelist_surv</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/forestp-1.png" width="672"></div>
<!-- ======================================================= -->
</div>
</div>
<div id="covariáveis-dependentes-do-tempo-em-modelos-de-sobrevivência" class="section level2" number="27.6">
<h2>
<span class="header-section-number">27.6</span> Covariáveis dependentes do tempo em modelos de sobrevivência<a class="anchor" aria-label="anchor" href="#covari%C3%A1veis-dependentes-do-tempo-em-modelos-de-sobreviv%C3%AAncia"><i class="fas fa-link"></i></a>
</h2>
<p>Algumas das seções seguintes foram adaptadas com permissão de uma excelente <a href="https://www.emilyzabor.com/tutorials/survival_analysis_in_r_tutorial.html">introdução à análise de sobrevivência em R</a> pela <a href="https://www.emilyzabor.com/">Dra. Emily Zabor</a></p>
<p>Na última seção usamos a regressão Cox para examinar associações entre covariáveis de interesse e resultados de sobrevivência. Mas estas análises dependem da covariância ser medida na linha de base, ou seja, antes do tempo de seguimento do evento começar.</p>
<p>O que acontece se estiver interessado em uma covariável que é medida <strong>após</strong> o início do tempo de seguimento? Ou, e se uma dessas covariáveis possa mudar ao longo do tempo?</p>
<p>Por exemplo, talvez esteja trabalhando com dados clínicos onde repetiu medidas de valores laboratoriais hospitalares que podem mudar ao longo do tempo. Este é um exemplo de uma <strong>Covariável Dependente do Tempo</strong>. Para resolver este problema é necessário uma configuração especial, mas felizmente o modelo cox é muito flexível e este tipo de dados também pode ser modelado com ferramentas do pacote <strong>survival</strong>.</p>
<div id="configuração-de-covariável-dependente-do-tempo" class="section level3 unnumbered">
<h3>Configuração de covariável dependente do tempo<a class="anchor" aria-label="anchor" href="#configura%C3%A7%C3%A3o-de-covari%C3%A1vel-dependente-do-tempo"><i class="fas fa-link"></i></a>
</h3>
<p>A análise de covariáveis dependentes do tempo em R requer a configuração de um conjunto de dados especial. Se estiver interessado, ver o artigo mais detalhado sobre este assunto do autor do pacote <strong>survival</strong> <a href="https://cran.r-project.org/web/packages/survival/vignettes/timedep.pdf">Using Time Dependent Covariates and Time Dependent Coefficients in the Cox Model</a>.</p>
<p>Para tal, utilizaremos um novo conjunto de dados do pacote <code>SemiCompRisks' chamado</code>BMT’, que inclui dados sobre 137 pacientes de transplante de medula óssea. As variáveis em que nos vamos concentrar são:</p>
<ul>
<li><p><code>T1</code> - tempo (em dias) até à morte ou último seguimento<br></p></li>
<li><p><code>delta1</code> - indicador de óbito; 1-Óbito, 0-Vivos<br></p></li>
<li><p><code>TA</code> - tempo (em dias) até à doença aguda de enxerto-versus-hospedeiro<br></p></li>
<li>
<p><code>deltaA</code> - indicador de doença aguda de enxerto-versus-hospedeiro;</p>
<ul>
<li>1 - desenvolveu a doença aguda de enxerto-versus-hospedeiro<br>
</li>
<li>0 - Nunca desenvolveu doença aguda de enxerto-versus-hospedeiro</li>
</ul>
</li>
</ul>
<p>Vamos carregar este conjunto de dados a partir do pacote <strong>survival</strong> utilizando o comando do R <strong>base</strong> <code><a href="https://rdrr.io/r/utils/data.html">data()</a></code>, que pode ser utilizado para carregar dados que já estão incluídos num pacote R que é carregado. A moldura de dados <code>BMT</code> irá aparecer no seu ambiente R.</p>
<div class="sourceCode" id="cb1327"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">BMT</span>, package <span class="op">=</span> <span class="st">"SemiCompRisks"</span><span class="op">)</span></span></code></pre></div>
<div id="adicionar-identificador-único-de-doente" class="section level4 unnumbered">
<h4>Adicionar identificador único de doente<a class="anchor" aria-label="anchor" href="#adicionar-identificador-%C3%BAnico-de-doente"><i class="fas fa-link"></i></a>
</h4>
<p>Não existe uma coluna de ID única nos dados <code>BMT</code>, que é necessária para criar o tipo de conjunto de dados que desejamos. Assim, utilizamos a função <code><a href="https://tibble.tidyverse.org/reference/rownames.html">rowid_to_column()</a></code> do pacote <strong>tidyverse</strong> para criar uma nova coluna de id chamada <code>my_id</code> (adiciona coluna no início do Data Frame com ids sequenciais de linha, começando em 1). Nomeamos o data frame como <code>bmt</code>.</p>
<div class="sourceCode" id="cb1328"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bmt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rowid_to_column</a></span><span class="op">(</span><span class="va">BMT</span>, <span class="st">"my_id"</span><span class="op">)</span></span></code></pre></div>
<p>O conjunto de dados tem agora este aspecto:</p>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-bce73d6e9dbe9e1c4ac5" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-bce73d6e9dbe9e1c4ac5">{"x":{"filter":"none","vertical":false,"data":[[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],[2081,1602,1496,1462,1433,1377,1330,996,226,1199,1111,530,1182,1167,418,417,276,156,781,172,487,716,194,371,526,122,1279,110,243,86,466,262,162,262,1,107,269,350,2569,2506,2409,2218,1857,1829,1562,1470,1363,1030,860,1258,2246,1870,1799,1709,1674,1568,1527,1324,957,932,847,848,1850,1843,1535,1447,1384,414,2204,1063,481,105,641,390,288,522,79,1156,583,48,431,1074,393,10,53,80,35,1499,704,653,222,1356,2640,2430,2252,2140,2133,1238,1631,2024,1345,1136,845,491,162,1298,121,2,62,265,547,341,318,195,469,93,515,183,105,128,164,129,122,80,677,73,168,74,16,248,732,105,392,63,97,153,363],[2081,1602,1496,1462,1433,1377,1330,996,226,1199,1111,530,1182,1167,418,383,276,104,609,172,487,662,194,230,526,122,129,74,122,86,466,192,109,55,1,107,110,332,2569,2506,2409,2218,1857,1829,1562,1470,1363,1030,860,1258,2246,1870,1799,1709,1674,1568,1527,1324,957,932,847,848,1850,1843,1535,1447,1384,414,2204,1063,481,105,641,390,288,421,79,748,486,48,272,1074,381,10,53,80,35,248,704,211,219,606,2640,2430,2252,2140,2133,1238,1631,2024,1345,1136,845,422,162,84,100,2,47,242,456,268,318,32,467,47,390,183,105,115,164,93,120,80,677,64,168,74,16,157,625,48,273,63,76,113,363],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,0,0,1,0,1,0,0,1,1,1,0,0,1,1,1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,0,1,0,1,0,0,0,0,1,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,0,1,1,1,1,0,1,1,1,1,0,0,1,0,1,1,0,0,1,0,0,0,1,1,1,1,0,1,1,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[67,1602,1496,70,1433,1377,1330,72,226,1199,1111,38,1182,39,418,417,276,28,781,22,487,716,194,371,526,88,1279,110,243,86,466,10,162,262,1,107,269,350,2569,2506,2409,2218,1857,1829,1562,1470,1363,1030,860,1258,52,1870,1799,20,1674,1568,1527,25,957,29,847,848,1850,1843,1535,1447,1384,414,2204,1063,30,21,641,390,18,25,16,1156,583,48,431,1074,393,10,53,10,35,1499,36,653,222,1356,2640,2430,2252,2140,2133,1238,1631,2024,32,1136,845,491,162,1298,28,2,62,265,547,21,318,195,469,93,515,183,105,128,164,129,122,21,677,73,168,29,16,248,732,105,392,38,97,153,363],[1,0,0,1,0,0,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,1,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,1,0,0,0],[121,139,307,95,236,123,96,121,226,91,1111,84,112,487,220,417,81,156,781,172,76,716,94,184,121,122,1279,110,243,86,119,84,162,262,1,107,120,350,2569,2506,2409,2218,260,1829,1562,180,200,210,860,120,380,230,140,348,1674,1568,1527,1324,957,932,847,155,1850,1843,1535,220,200,414,2204,240,120,105,641,390,100,140,79,180,583,48,431,120,100,10,53,80,35,1499,155,653,123,1356,2640,2430,150,220,250,250,150,180,360,140,845,180,162,1298,121,2,62,210,130,100,140,195,90,93,515,130,105,128,164,129,122,80,150,73,200,74,16,100,732,105,122,63,97,153,363],[1,1,1,1,1,1,1,1,0,1,0,1,1,1,1,0,1,0,0,0,1,0,1,1,1,0,0,0,0,0,1,1,0,0,0,0,1,0,0,0,0,0,1,0,0,1,1,1,0,1,1,1,1,1,0,0,0,0,0,0,0,1,0,0,0,1,1,0,0,1,1,0,0,0,1,1,0,1,0,0,0,1,1,0,0,0,0,0,1,0,1,0,0,0,1,1,1,1,1,1,1,1,0,1,0,0,0,0,0,1,1,1,1,0,1,0,0,1,0,0,0,0,0,0,1,0,1,0,0,1,0,0,1,0,0,0,0],[13,18,12,13,12,12,17,12,10,29,22,34,22,1167,21,16,21,20,26,37,22,17,25,9,11,13,22,49,23,86,100,59,40,24,1,107,27,33,21,17,16,11,15,19,18,14,12,14,15,66,15,16,12,19,24,14,13,15,69,7,16,16,9,19,21,24,19,27,12,16,24,15,11,11,288,20,79,18,11,14,12,19,16,10,53,80,35,9,18,23,52,14,22,14,17,18,17,18,40,16,14,15,20,491,13,1298,65,2,11,14,24,17,12,16,20,28,31,21,105,12,164,51,12,0,8,38,48,24,16,52,18,30,24,16,97,59,19],[1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,1,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,0,1,0,1,1,1,1,1,1,1,0,1,1,1,1,1,0,1,1],[26,21,26,17,32,22,20,22,18,24,19,17,24,27,18,15,18,20,27,40,22,28,26,39,15,20,17,28,37,17,15,29,36,23,42,30,29,22,19,31,35,16,29,19,26,27,13,25,25,30,45,33,32,23,37,15,22,46,18,27,28,23,37,34,35,33,21,21,25,50,35,37,26,50,45,28,43,14,17,32,30,30,33,34,33,30,23,35,29,23,28,33,18,29,35,27,36,24,27,35,50,47,40,22,22,8,39,20,27,32,31,20,35,36,35,7,23,11,14,37,19,37,25,35,15,45,32,41,27,33,39,17,43,44,48,31,52],[33,37,35,21,36,31,17,24,21,40,28,28,23,22,14,20,5,33,27,37,20,32,32,31,20,26,20,25,38,26,18,32,43,16,48,19,20,20,13,34,31,16,35,18,30,34,24,29,31,16,39,30,23,28,34,19,12,31,17,30,29,26,36,32,32,28,18,15,19,38,36,34,24,48,43,30,43,19,14,33,23,32,28,54,41,35,25,18,21,16,30,22,23,26,31,17,39,28,21,41,36,27,39,21,23,2,48,19,25,32,28,23,40,39,33,2,25,7,18,35,32,34,29,28,14,42,43,29,36,39,43,14,50,37,56,25,48],[1,1,1,0,1,1,1,1,0,1,1,1,0,0,1,1,0,1,1,0,1,1,0,0,1,1,0,1,0,1,1,1,1,0,1,1,0,1,1,1,1,1,0,1,1,1,1,0,0,0,0,0,1,0,1,1,0,1,1,0,1,1,0,0,0,0,0,1,0,1,1,1,1,1,1,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,1,1,1,1,1,1,0,1,1,0,1,1,0,0,1,0,1,1,1,1,1,0,0,1,0,1,1,0,1,0,0,0,0,1,1,0,0,0,0,0,0,0,1,1,1,0,1],[0,1,1,1,1,1,0,0,1,1,1,1,0,1,1,1,0,1,0,0,1,1,1,1,1,0,0,0,1,0,1,1,1,1,1,1,1,0,1,1,1,1,0,1,1,1,1,0,1,1,0,0,0,1,1,0,1,1,1,0,1,1,0,0,1,1,0,1,0,0,0,0,1,1,1,1,0,0,1,1,1,1,0,0,1,0,1,1,1,0,1,1,1,1,0,1,1,0,0,1,1,0,0,0,0,0,1,1,1,0,0,1,1,1,0,1,1,1,0,0,0,1,1,0,1,1,1,1,0,0,1,1,1,1,1,1,1],[1,0,1,0,1,1,1,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,1,1,1,0,1,1,1,0,1,1,0,1,0,1,1,1,1,1,0,1,0,0,1,0,1,0,1,0,0,0,1,0,0,0,0,0,1,0,1,0,0,0,1,1,1,0,0,1,0,0,0,0,1,1,1,0,1,1,0,1,0,1,0,1,1,0,0,0,1,0,1,1,0,1,1,1,0,0,1,1,0,0,0,1,1,1,0,1,0,1,0,0,1,0,1,1,0,1,1,1,1,1,1,1,0,1,0,1,1,1],[1,0,0,0,1,1,1,0,0,1,1,0,1,1,0,0,0,1,1,1,0,0,0,1,0,1,0,0,1,0,0,0,0,1,0,1,1,0,0,0,1,0,0,0,1,1,0,0,1,0,0,1,0,0,0,0,1,1,0,0,0,0,1,1,0,1,0,1,1,0,1,1,0,0,1,1,0,0,0,0,0,0,0,1,1,1,1,1,0,0,1,0,0,1,0,1,0,1,0,0,1,0,1,0,1,0,1,0,0,0,1,1,1,0,0,0,0,0,0,1,1,0,1,0,0,0,1,1,0,1,1,0,0,0,1,1,0],[98,1720,127,168,93,2187,1006,1319,208,174,236,151,203,191,110,824,146,85,187,129,128,84,329,147,943,2616,937,303,170,239,508,74,393,331,196,178,361,834,270,60,120,60,90,210,90,240,90,210,180,180,105,225,120,90,60,90,450,75,90,60,75,180,180,270,180,150,120,120,60,270,90,120,90,120,90,90,90,60,120,150,120,150,120,240,180,150,150,30,105,90,120,210,750,24,120,210,240,240,690,105,120,900,210,210,300,105,210,75,90,180,630,180,300,90,120,135,210,120,150,270,285,240,510,780,150,180,150,750,180,180,150,210,240,360,330,240,180],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,1,0,1,0,0,1,0,0,0,0,1,0,0,1,0,1,1,0,0,0,0,1,0,0,0,1,1,1,1,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,1,1,0,0,1,1,0,1,1,1,1,1,1,1,0,1,0,1,1,1,1,0,1,1,1,1,1,1,1,0,0,1,1,1,0,1,0,0,0],[1,1,1,1,1,1,1,1,1,3,3,3,2,2,1,1,1,1,1,1,1,1,1,1,1,1,3,3,3,3,3,3,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,2,4,4,4,4,4,4,4,4,4,4,4,4,3,3,3,3,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,4,4,4,3,3,1,1,1,1,1,1,2,4,4,3,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,4,4,4,4,3,3,3,3,3],[0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,1,1,0,0,0,0,0,0,1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,1,1,1,1,1]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>my_id<\/th>\n      <th>g<\/th>\n      <th>T1<\/th>\n      <th>T2<\/th>\n      <th>delta1<\/th>\n      <th>delta2<\/th>\n      <th>delta3<\/th>\n      <th>TA<\/th>\n      <th>deltaA<\/th>\n      <th>TC<\/th>\n      <th>deltaC<\/th>\n      <th>TP<\/th>\n      <th>deltaP<\/th>\n      <th>Z1<\/th>\n      <th>Z2<\/th>\n      <th>Z3<\/th>\n      <th>Z4<\/th>\n      <th>Z5<\/th>\n      <th>Z6<\/th>\n      <th>Z7<\/th>\n      <th>Z8<\/th>\n      <th>Z9<\/th>\n      <th>Z10<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22]}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="expandir-as-linhas-de-pacientes" class="section level4 unnumbered">
<h4>Expandir as linhas de pacientes<a class="anchor" aria-label="anchor" href="#expandir-as-linhas-de-pacientes"><i class="fas fa-link"></i></a>
</h4>
<p>A seguir, utilizaremos a função <code>tmerge()</code> com as funções auxiliares <code>event()</code> e <code>tdc()</code> helper para criar o conjunto de dados reestruturado. Neste caso, cada paciente pode ter no máximo duas linhas, dependendo se desenvolveu doença aguda de enxerto-versus-hospedeiro durante o período de coleta de dados. Vamos chamar o nosso novo indicador para o desenvolvimento da doença aguda de enxerto-versus-hospedeiro <code>agvhd</code>.</p>
<ul>
<li>
<code>tmerge()</code> cria um longo conjunto de dados com múltiplos intervalos de tempo para os diferentes valores covariados para cada paciente</li>
<li>
<code>event()</code> cria o novo indicador de evento para combinar com os intervalos de tempo recém-criados</li>
<li>
<code>tdc()</code> cria a coluna covariada dependente do tempo, <code>agvhd</code>, para combinar com os intervalos de tempo recém-criados</li>
</ul>
<div class="sourceCode" id="cb1329"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">td_dat</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">tmerge</span><span class="op">(</span></span>
<span>    data1 <span class="op">=</span> <span class="va">bmt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">my_id</span>, <span class="va">T1</span>, <span class="va">delta1</span><span class="op">)</span>, </span>
<span>    data2 <span class="op">=</span> <span class="va">bmt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">my_id</span>, <span class="va">T1</span>, <span class="va">delta1</span>, <span class="va">TA</span>, <span class="va">deltaA</span><span class="op">)</span>, </span>
<span>    id <span class="op">=</span> <span class="va">my_id</span>, </span>
<span>    death <span class="op">=</span> <span class="fu">event</span><span class="op">(</span><span class="va">T1</span>, <span class="va">delta1</span><span class="op">)</span>,</span>
<span>    agvhd <span class="op">=</span> <span class="fu">tdc</span><span class="op">(</span><span class="va">TA</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<p>Para ver o que foi feito, vamos olhar os dados dos primeiros 5 pacientes.</p>
<p>As variáveis de interesse do dado original terão essa aparência:</p>
<div class="sourceCode" id="cb1330"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bmt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">my_id</span>, <span class="va">T1</span>, <span class="va">delta1</span>, <span class="va">TA</span>, <span class="va">deltaA</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">my_id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>##   my_id   T1 delta1   TA deltaA
## 1     1 2081      0   67      1
## 2     2 1602      0 1602      0
## 3     3 1496      0 1496      0
## 4     4 1462      0   70      1
## 5     5 1433      0 1433      0</code></pre>
<p>O novo conjunto de dados para esses pacientes terá essa aparência:</p>
<div class="sourceCode" id="cb1332"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">td_dat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">my_id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>##   my_id   T1 delta1 tstart tstop death agvhd
## 1     1 2081      0      0    67     0     0
## 2     1 2081      0     67  2081     0     1
## 3     2 1602      0      0  1602     0     0
## 4     3 1496      0      0  1496     0     0
## 5     4 1462      0      0    70     0     0
## 6     4 1462      0     70  1462     0     1
## 7     5 1433      0      0  1433     0     0</code></pre>
<p>Agora alguns dos nossos pacientes têm duas linhas no conjunto de dados correspondentes a intervalos em que têm um valor diferente da nossa nova variável, <code>agvhd</code>. Por exemplo, o Paciente 1 tem agora duas linhas com um valor <code>agvhd</code> de zero do tempo 0 ao tempo 67, e um valor de 1 do tempo 67 ao tempo 2081.</p>
</div>
</div>
<div id="regressão-cox-com-covariáveis-dependentes-do-tempo" class="section level3 unnumbered">
<h3>Regressão Cox com covariáveis dependentes do tempo<a class="anchor" aria-label="anchor" href="#regress%C3%A3o-cox-com-covari%C3%A1veis-dependentes-do-tempo"><i class="fas fa-link"></i></a>
</h3>
<p>Agora que remodelamos os nossos dados e acrescentamos a nova variável dependente do tempo <code>aghvd</code> , vamos encaixar um modelo simples de regressão de uma única variável cox. Podemos utilizar a mesma função <code>coxph()</code> como antes, só precisamos alterar a nossa função <code>Surv()</code> para especificar tanto o tempo de início como o tempo de paragem para cada intervalo utilizando os argumentos <code>time1 =</code> e <code>time2 =</code>.</p>
<div class="sourceCode" id="cb1334"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bmt_td_model</span> <span class="op">=</span> <span class="fu">coxph</span><span class="op">(</span></span>
<span>  <span class="fu">Surv</span><span class="op">(</span>time <span class="op">=</span> <span class="va">tstart</span>, time2 <span class="op">=</span> <span class="va">tstop</span>, event <span class="op">=</span> <span class="va">death</span><span class="op">)</span> <span class="op">~</span> <span class="va">agvhd</span>, </span>
<span>  data <span class="op">=</span> <span class="va">td_dat</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">bmt_td_model</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(time = tstart, time2 = tstop, event = death) ~ 
##     agvhd, data = td_dat)
## 
##   n= 163, number of events= 80 
## 
##         coef exp(coef) se(coef)    z Pr(&gt;|z|)
## agvhd 0.3351    1.3980   0.2815 1.19    0.234
## 
##       exp(coef) exp(-coef) lower .95 upper .95
## agvhd     1.398     0.7153    0.8052     2.427
## 
## Concordance= 0.535  (se = 0.024 )
## Likelihood ratio test= 1.33  on 1 df,   p=0.2
## Wald test            = 1.42  on 1 df,   p=0.2
## Score (logrank) test = 1.43  on 1 df,   p=0.2</code></pre>
<p>Novamente vamos visualizar o resultado do nosso modelo cox usando a função <code>ggforest()</code> do pacote <strong>survminer</strong>.:</p>
<div class="sourceCode" id="cb1336"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggforest</span><span class="op">(</span><span class="va">bmt_td_model</span>, data <span class="op">=</span> <span class="va">td_dat</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-931-1.png" width="672"></div>
<p>Como se pode ver pela “forest plot”, intervalo de confiança e p-valor, não parece haver forte associação entre ocorrência de óbito e a doença aguda do enxerto-versus-hospedeiro no contexto do nosso modelo simples.</p>
<!-- ======================================================= -->
</div>
</div>
<div id="referências" class="section level2" number="27.7">
<h2>
<span class="header-section-number">27.7</span> Referências<a class="anchor" aria-label="anchor" href="#refer%C3%AAncias"><i class="fas fa-link"></i></a>
</h2>
<p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2394262/">Survival Analysis Part I: Basic concepts and first analyses</a></p>
<p><a href="https://www.emilyzabor.com/tutorials/survival_analysis_in_r_tutorial.html">Análise de sobrevivência no R</a></p>
<p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2954271/">Survival analysis in infectious disease research: Describing events in time</a></p>
<p><a href="https://data.princeton.edu/wws509/notes/c7.pdf">Chapter on advanced survival models Princeton</a></p>
<p><a href="https://cran.r-project.org/web/packages/survival/vignettes/timedep.pdf">Using Time Dependent Covariates and Time Dependent Coefficients in the Cox Model</a></p>
<p><a href="https://publicifsv.sund.ku.dk/~ts/survival/survival-cheat.pdf">Cheatsheet (cola) de análise de sobrevivência</a></p>
<p><a href="https://paulvanderlaken.files.wordpress.com/2017/08/survminer_cheatsheet.pdf">Cheatsheet (cole) do Survminer</a></p>
<p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6322561/">Paper on different survival measures for cancer registry data with Rcode provided as supplementary materials</a></p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="survey-analysis.html"><span class="header-section-number">26</span> Analises de pesquisa de questionários (survey)</a></div>
<div class="next"><a href="gis.html"><span class="header-section-number">28</span> Introdução ao GIS</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#survival-analysis"><span class="header-section-number">27</span> Análise de sobrevivência</a></li>
<li><a class="nav-link" href="#vis%C3%A3o-geral-3"><span class="header-section-number">27.1</span> Visão Geral</a></li>
<li>
<a class="nav-link" href="#prepara%C3%A7%C3%A3o-17"><span class="header-section-number">27.2</span> Preparação</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#carregar-pacotes-5">Carregar Pacotes</a></li>
<li><a class="nav-link" href="#gest%C3%A3o-e-transforma%C3%A7%C3%A3o-de-dados">Gestão e transformação de dados</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#no%C3%A7%C3%B5es-b%C3%A1sicas-de-an%C3%A1lise-de-sobreviv%C3%AAncia"><span class="header-section-number">27.3</span> Noções básicas de análise de sobrevivência</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#construir-um-objeto-do-tipo-sobrevivente">Construir um objeto do tipo sobrevivente</a></li>
<li><a class="nav-link" href="#rodando-an%C3%A1lises-iniciais">Rodando análises iniciais</a></li>
<li><a class="nav-link" href="#risco-acumulado">Risco acumulado</a></li>
<li><a class="nav-link" href="#tra%C3%A7ando-curvas-kaplan-meir">Traçando curvas Kaplan-Meir</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#compara%C3%A7%C3%A3o-de-curvas-de-sobreviv%C3%AAncia"><span class="header-section-number">27.4</span> Comparação de curvas de sobrevivência</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#teste-de-classifica%C3%A7%C3%A3o-de-registo">Teste de classificação de registo</a></li></ul>
</li>
<li>
<a class="nav-link" href="#an%C3%A1lise-de-regress%C3%A3o-de-cox"><span class="header-section-number">27.5</span> Análise de regressão de Cox</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#ajuste-de-um-modelo-cox">Ajuste de um modelo Cox</a></li>
<li><a class="nav-link" href="#gr%C3%A1ficos-em-floresta-forest-plots">Gráficos em floresta (Forest plots)</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#covari%C3%A1veis-dependentes-do-tempo-em-modelos-de-sobreviv%C3%AAncia"><span class="header-section-number">27.6</span> Covariáveis dependentes do tempo em modelos de sobrevivência</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#configura%C3%A7%C3%A3o-de-covari%C3%A1vel-dependente-do-tempo">Configuração de covariável dependente do tempo</a></li>
<li><a class="nav-link" href="#regress%C3%A3o-cox-com-covari%C3%A1veis-dependentes-do-tempo">Regressão Cox com covariáveis dependentes do tempo</a></li>
</ul>
</li>
<li><a class="nav-link" href="#refer%C3%AAncias"><span class="header-section-number">27.7</span> Referências</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Manual de R para Epidemiologistas</strong>" was written by the handbook team. It was last built on 2023-10-24.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
